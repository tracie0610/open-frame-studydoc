<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<meta name="description" content="BeachBoy的沙滩,,三、程序举例1．首先是连接SMTP服务器，JAVAMAIL1.2不能实现SMTP服务的功能，但可以连接已有的SMTP服务器。//创建一个属性对象Propertiesprops=System.getProperties();//创建系统属性对象props.setProperty(&#039;mail.transport.protocol&#039;,&#039;smtp&#039;);//设置使用smtp协议props.setProperty(&#039;mail.smtp.host&#039;,server);//设置SMTP服务器地址props.setProperty(&#039;mail.smtp.port&#039;,&#039;&#039;+port);//设置SMTP端口号props.setProperty(&#039;mail.smtp.aut" />
<meta name="keywords" content="BeachBoy的沙滩,,it" />
<title>JAVA群发邮件(2)_王鹏_新浪博客</title>
<script>
var scope = {
	$uid : "1506085232",
	$PRODUCT_NAME : "blog",
	$pageid : "article",
	$key :  "80d7f0739c9ca78f616060b3a2429bcf",
	$sort_id : "113",
    $loadconf : true,
	$flag2008 : "0",
	$articleid : "59c509700100ca5u" ,
	$isCommentAllow : "1"
};
var	$encrypt_code = "6d94fc42f611b2f43258daa95a696974";
var config = {"common":{"t":"7_1","r":0,"head":[],"bg":[],"pageset":0,"invitationset":0},"private":{"cms":0,"blogsize":0,"ad":0,"sms":0,"adver":0,"tj":0},"component":{"c1":[901,12,17,1,2,3],"c2":[],"x":2},"product":{"c":24,"j":18}};
var fav = {"59c509700100ca5u":"beeee59b56e0fc3f80b3af4f71beefca"} ;
</script>

<style>.MASS8b42ae56b78e{display:none}</style>
<script type="text/javascript" src="http://sjs.sinajs.cn/common/js/boot.js"></script>
<script type="text/javascript">loadCss();</script>
<script src="http://sjs.sinajs.cn/common/js/platform_tray.compressed.js"></script>

<link href="http://sjs.sinajs.cn/common/css/im.css" type="text/css" rel="stylesheet" />

<!--# block name="blk737369" --><!--# endblock -->
<!--#include file="/hits?act=4&aid=${aid}" stub="blk737369" --> 
</head>
<body>
<div id="sinatopbar">
<script type="text/javascript">
<!--
	document.write(SinaSysTray.getHTML());
//-->
</script>
</div>
<script type="text/javascript">
<!--
	SinaSysTray.base_init({
		"type" : scope.$PRODUCT_NAME || "",
		"uid" : $UID || "0"
	});
//-->
</script>
<div class="wrapper">
  <div class="headpic100" id="headpic100">
<div class="headpic950" id="headPic950">
<div class="toppicflash" id="toppicflash" >
</div >
  <div class="ntoptitle" id="ntoptitle"> 
  <div class="ntopns" id="blogTitle">
  <div class="ntitname" id="blogname"><a href="http://blog.sina.com.cn/beachboywp">BeachBoy的沙滩</a>
   </div>
   <div class="ntitsite">http://blog.sina.com.cn/beachboywp<a id="SubscribeNewRss" href="#" class="CP_a_fuc" onclick="return false;">[<cite>订阅</cite>]</a></div> 
  </div>
  </div>

</div>
<div class="termenubg"></div>
  <div class="termenu">
  <div class="termenuc" id="clone_template" >
    <div class="termenutag">
     <div class="user">
     <div class="userhead"><a  href="http://blog.sina.com.cn/beachboywp"><img src="http://portrait1.sinaimg.cn/1506085232/blog/50" /></a></div><div class="username"><a  style="cursor:hand;" href="http://blog.sina.com.cn/beachboywp"><span id="nav_name"></span></a></div>
     </div>
	 
     <div class="promenu">
     <li class="on"><span id="nav_blog"><a href="http://blog.sina.com.cn/beachboywp">博客</a></span></li>     
     <li><span id="nav_photo"><a href="http://photo.blog.sina.com.cn/beachboywp">相册</a></span></li>
     <li><span id="nav_music"><a href="http://music.sina.com.cn/m/1506085232">音乐</a></span></li>
     <li><span id="nav_vblog"><a href="http://you.video.sina.com.cn/beachboywp"  >播客</a></span></li>
	 <li><span id="nav_tiezi"><a href="http://profile.blog.sina.com.cn/beachboywp">个人中心</a></span></li>
	 <!--   <li><span id="nav_quanzi"><a href="http://q.sina.com.cn/m/beachboywp">圈子</a></span></li>-->
     </div>
    </div>
    <div class="termenutxt">
    <div class="tmtcen">
        <div class="floatLeft">
        <span><a href="http://blog.sina.com.cn/beachboywp">首页</a></span><span class="linesp"></span><span><a href="http://blog.sina.com.cn/s/articlelist_1506085232_0_1.html">博文</a></span><span class="linesp"></span><span><a href="http://blog.sina.com.cn/s/favourites_1506085232_1.html">收藏</a></span><span class="linesp"></span><span><a href="http://profile.blog.sina.com.cn/circle.php?uid=1506085232&page=1&type=3">博客圈</a></span><!--<span >  <a href="http://blog.sina.com.cn/lm/rank/index.html" target="_blank">排行榜</a></span>--></div>
        <div class="floatRight">
        
        </div>
    </div>
    </div>
  </div>
  </div>
</div>
  <div class="contentLayout">
    
      <div class="column_2 floatLeft">
<div id="advertise_top" class="components730 SinaAd_hide"></div>
<div class="components730">
        <div class="component">
          <div class="componentBar">
                <span class="floatRight articleFontSize" id="articleFontManage">字体大小：<a onclick="changeFontSize(2);return false;" href="">大</a><b>中</b><a onclick="changeFontSize(0);return false;" href="">小</a></span>
                <span class="title">正文</span>
                
            </div>
<div class="componentContent article"><div class="comconblog"> 
<div class="articleTitle">
<div style="display: inline;">
<b id="t_59c509700100ca5u">JAVA群发邮件(2)</b><span class="time">(2009-02-26 23:19:48)</span></div></div>
<div class="articleTag">
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<tbody><tr>
<td>
<script>
var $tag='it';
var $tag_code='fecb47b98978334112973065af27f8b1';
</script>
标签：<a href="http://uni.sina.com.cn/c.php?t=blog&k=it&ts=bpost&stype=tag" class="tag" target="_blank">it</a><wbr/>&nbsp;
</td>
<td width="250" align="right" valign="top"></td>
</tr></tbody>
</table>
</div>
<div class="articleContent" id="articleBody">
<p>三、程序举例</P>
<p>1．首先是连接SMTP服务器，JAVAMAIL1.2不能实现SMTP服务的功能，但可以连接已有的SMTP服务器。</P>
<p>//创建一个属性对象</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
Properties props=System.getProperties();&nbsp;<wbr>
//创建系统属性对象</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
props.setProperty("mail.transport.protocol","smtp");&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//设置使用smtp协议</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
props.setProperty("mail.smtp.host",server);&nbsp;<wbr>
//设置SMTP服务器地址</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
props.setProperty("mail.smtp.port",""+port); //设置SMTP端口号</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
props.setProperty("mail.smtp.auth","true");&nbsp;<wbr>&nbsp;<wbr>
//SMTP服务用户认证</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//创建一个过程对象</P>
<p>javax.mail.Session sess =
javax.mail.Session.getDefaultInstance(props, null);</P>
<p>2．创建一封新邮件，一般定义该MimeMessage创建一个邮件对象。</P>
<p>MimeMessage msg=new
MimeMessage(sess);&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//创建邮件对象</P>
<p>
msg.setSubject(“邮件群发”)；&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//设置邮件主题</P>
<p>msg.setSentDate(new
Date());&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//设置发信日期</P>
<p>msg.setFrom(Address
address)；&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//设置发信人</P>
<p>
邮件地址只要符合带有“@”符号并且使用“.”分成三段的字符串都会被SMTP服务器接受，发送广告邮件的商家一般都会在这里修改发信人地址，所以我们的收件箱中看见的广告邮件显示中发信人内容一些的根本不存在邮件地址。如果想查看真正地发信人，应该查看邮件头中Received的内容。</P>
<p>//设置主收件人</P>
<p>msg.setRecipients(Message.RecipientType.TO,Address
toaddress);</P>
<p>//设置抄送收件人</P>
<p>msg.addRecipients(Message.RecipientType.CC,Address
coaddress);</P>
<p>//设置暗抄送人</P>
<p>msg.addRecipients(Message.RecipientType.BCC,Address
bcoaddress);</P>
<p>
SMTP允许一封邮件有多个接受者，我们可以利用这个特点，在这三个收件人中填写多个收件人地址来提高大规模发邮件效率。另外Bcc这个字段可以隐藏收件人的地址，你有时可能发现邮件的收件人不是自己却收到了这封邮件，就是利用了暗抄这个属性。</P>
<p>
3．邮件体一般分为邮件正文本部分和附件部分。正文部分需要设置文本的格式，包括text文本类型，messafe报文类型，image图象类型,video视频类型,audio声音类型,application应用程序类型,multipart混合类型等。如下例，</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
String
m_body;&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//为需要添加文本内容</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
MimeMultipart content=new
MimeMultipart();&nbsp;<wbr>&nbsp;<wbr> //创建邮件体对象</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
if(content==null) return false;</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
MimeBodyPart part=new
MimeBodyPart();&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//创建文本部分对象</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr> String
type="text/plain";&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//文本类型默认为text/plain</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
if(m_body.startsWith("&lt;html&gt;") ||
m_body.startsWith("&lt;HTML&gt;"))</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
type="text/html";&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//如果是网页形式的内容，则改变类型为text/html</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
part.setText(m_body);</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
part.setHeader("Content-Type",type);</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
content.addBodyPart(part);</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
msg.setContent(content);&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//添加文本至邮件中</P>
<p>
msg.saveChanges();&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//保存修改</P>
<p>
4．如何向的邮件中添加附件，利用多用途互联网邮件扩展（MIME）协议可以直接二进制数据添加到标准的RFC822邮件中。在JAVAMAIL中实现方法如下，</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr> String
filename;&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//用于存储文件名称与存放路径</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
if(filename!=null || filename.length()&gt;0){</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
MimeBodyPart part=new MimeBodyPart();//创建MIME对象</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
DataSource fds = new FileDataSource(filename); //创建文件流对象</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
part.setDataHandler(new DataHandler(fds));</P>
<p>&nbsp;<wbr>&nbsp;<wbr>
part.setFileName(MimeUtility.encodeText(fds.getName()));</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
content.addBodyPart(part);&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//添加二进制编码至邮件体中</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
}</P>
<p>&nbsp;<wbr>&nbsp;<wbr>
msg.setContent(content);&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//添加文本至邮件中</P>
<p>
msg.saveChanges();&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//保存修改</P>
<p>5．邮件的基本内容设置完毕，发送SMTP电子邮件。</P>
<p>&nbsp;<wbr>&nbsp;<wbr> Transport
trans=sess.getTransport();&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//创建发送对象</P>
<p>&nbsp;<wbr>&nbsp;<wbr> trans.send
(msg);&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//发送</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
6.如何群发邮件，首先我们要有一个邮件地址列表，邮件地址列表可以向从公共网站获得，也可以根据某单位名称按字典法生成，或者购买用户表。邮件地址列表应该按行存放每个邮件地址。</P>
<p>
发信的速度和SMTP的响应速度有密切的关系，所以因该充分利用一封邮件可以有多个接受地址的条件，将邮件地址按组读入进行发送，才能提高邮件群发地效率。下面的例子是每一封信发给10个邮件地址。</P>
<p>import java.io.*;</P>
<p>import java.net.*;</P>
<p>import java.util.*;</P>
<p>import javax.mail.*;</P>
<p>import javax.activation.*;</P>
<p>import javax.mail.internet.*;</P>
<p>class massmail(){</P>
<p>try{</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
FileReader fis = new FileReader(“邮件列表文件”);</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
BufferedReader dis = new BufferedReader(fis);</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr> int
i=0;</P>
<p>while((fileline = dis.readLine())!=null){</P>
<p>&nbsp;<wbr> if((i%10)==0)</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
MimeMessage msg=new MimeMessage(sess);</P>
<p>……</P>
<p>&nbsp;<wbr>
if((i%10)!=0){&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//多个邮件地址之间要加“，”</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
maillist = maillist + “,” + fileline;</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
}else{</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
maillist = fileline;</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
}</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
i++;</P>
<p>
&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
if((i%10)==0){&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//一封邮件在暗抄地址处加10个收件人</P>
<p>msg.addRecipients(Message.RecipientType.BCC, maillist);</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
……&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//设置邮件内容</P>
<p>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr> Transport
trans=sess.getTransport();&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//创建发送对象</P>
<p>&nbsp;<wbr> trans.send
(msg);&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>&nbsp;<wbr>
//发送</P>
<p>}</P>
<p>}</P>
<p>fis.close();</P>
<p>}catch(Exception error){</P>
<p>System.out.println("Exception:" + error);</P>
<p>}<br /></P>
 </div>
<!--   -->
<div class="articleInfo floatLeft">						
已投稿到：

<!--（<a href="http://my2008.sina.com.cn/blog/rule.html" target="_blank">规则</a>）<span class="space12"></span>（<a href="#" onclick="return false;"><span onclick="showMyRecord();">积分</span></a>）
<span class="space12"></span>//-->
<span class="sort"><a href="http://blog.sina.com.cn/lm/114/113/day.html" target="_blank">排行榜</a></span>

<span class="group"><a href="http://q.sina.com.cn/blog_groups.php?fid=59c509700100ca5u" target="_blank">圈子</a></span>
                 
</div>
<div class="articleUtil floatRight"> 
<a>阅读</a><span id="r_59c509700100ca5u" class="sub"></span><span class="space">|</span><a href="#comment">评论</a><span id="c_59c509700100ca5u" class="sub"></span><span class="space">|</span><a id="f_59c509700100ca5u" href="#" onclick="$articleManage('59c509700100ca5u',5);return false;">收藏</a><span id="fn_59c509700100ca5u" class="sub"></span><span class="space">|</span><a HREF="http://blog.sina.com.cn/main_v5/ria/print.html?blog_id=blog_59c509700100ca5u" target="_blank">打印</a><span class="space">|</span><a id="q_59c509700100ca5u" onclick="$jubao('59c509700100ca5u')" href="javascript:;">举报</a>
</div>
<div class="CP_j_linedot"></div>
<div class="articleContext">前一篇：<span class="space6"></span><a href="http://blog.sina.com.cn/s/blog_59c509700100ca5r.html~type=v5_one&label=rela_prevarticle" >JAVA群发邮件(1)</a><br />后一篇：<span class="space6"></span><a href="http://blog.sina.com.cn/s/blog_59c509700100ccpf.html~type=v5_one&label=rela_nextarticle" >Java设计模式之迭代器模式</a></div>
<div id="advertise_bottom" class="sinaPlan SinaAd_hide"></div>
<!-- 内容开始 -->
		             <div class="CP_cmtpost" id="CP_cmtpost_cms">
	<div class="CP_cmtt_d"><span class="floatLeft"><strong>评论</strong>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://blog.sina.com.cn/lm/8/2009/0325/105340.html"  target="_blank">重要提示：警惕虚假中奖信息，点击查看详情</a><em><span class="my2008" id="COMMENT_FIRST_HOT"></span></em><a name="comment"></a></span><span class="manage floatRight"><a href="#post" class="CP_a_fuc">[<cite>发评论</cite>]</a></span>
                </div>
	
	<ul id="article_comment_list" class="CP_lis">
	<!-- 循环始 -->
	<li class="CP_litem">评论加载中，请稍候...</li>
	<!-- 循环终  -->
	</ul> 
	<div id="commentPaging" class="CP_page"  style="display:none;" >
			<ul class="CP_pages">
			</ul>
	</div>
	<a name="post"></a>	
	<div class="CP_cmtt_d marginTop_d1"> 
  <span class="floatLeft"><strong>发评论</strong>&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://widget.sina.com.cn/minisite/g3.html"  target="_blank">玩疯狂白领赢G3笔记本</a></span>
    <span class="manage floatRight"></span>
	</div>
<div class="CP_cmt_main">
<div class="CP_cmt_line1"><ul class="CP_cmt_info floatLeft" id="comment_wel" style="display:none;" ><li class="CP_cmt_nm_d" id="comment_wel2" style="display:none;">用户昵称:</li></ul>
<ul class="CP_cmt_int_d floatRight">
<li class="CP_cmt_int_img"><a class="" href="#" onclick="return false;"><img align="absmiddle" title="" alt="" src="http://simg.sinajs.cn/common/images/CP_i.gif"class="CP_i CP_i_ins_smi"/><cite id="article_comment_insertSmile">插入表情</cite></a></li>
</ul></div>
<p class="CP_cmtxt_d"><textarea id="commentArea" class="commentArea"></textarea></p>
<ul class="CP_cmtpf">
	<li class="CP_cmtnm">登录名：<input type="text" id="login_name"/></li>
	<li class="CP_cmtpw">密码：<input type="password" id="login_pass"/></li>
	<li><a href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a></li>
    <li><a href="http://login.sina.com.cn/hd/reg.php?entry=shequ" target="_blank">注册</a></li>
	<li class="CP_cmtnm"  style="display:none;" id="comment_anon">昵&nbsp;&nbsp;&nbsp;称：<input type="text" id="comment_anonyous"/></li>
	<li class="CP_cmt_any"><label><input type="checkbox" id="anonymity"/>匿名评论</label></li>
</ul>
<p class="CP_cmtvc"><em>验证码：</em><input type="text" maxlength="4" class="checkwd" id="login_check"/><img id="comment_check_img" border="0" align="absmiddle" alt="看不清楚数字吗？点击这里再试试。" src="http://vlogin.blog.sina.com.cn/myblog/checkwd_image.php" /><span id="audioCheckCont"><a id="comment_get_vcode" href="#" onclick="return false;">收听验证码</a></span></p>
<p class="CP_cmtsub"><a class="CP_a_btn CP_a_btn14 CP_a_btnsub" href="#" onclick="return false;"><cite id="comment_post_btn">发评论</cite><input type="submit" value="" /></a></p>
<p class="CP_cmtresv CP_txtc">以上网友发言只代表其个人观点，不代表新浪网的观点或立场。</p>
</div></div>
<!-- 内容结束 -->
          </div></div>
          <div class="componentBottom"></div>
        </div>
</div>
</div>

    
    <div class="gap floatLeft"></div>
    <div class="column_1 floatLeft">
    
      <div class="components210" id="column_1">
      <div   id="adps000001"></div>
              <div class="component" id="module_903" load_style="1">
          <div class="componentBar">
          <span class="title">相关博文</span>
          </div>
          <div class="componentContent">
			<!-- 内容开始 -->
			<div class="nodata2">读取中...</div>
			<!-- 内容结束 -->
          </div>
          <div class="componentBottom"></div>
        </div>	 
		        <div class="component" id="module_904" load_style="1">
          <div class="componentBar">
          <span class="title">推荐博文</span>
          </div>
          <div class="componentContent">
			<!-- 内容开始 -->
			<div class="nodata2">读取中...</div>
			<!-- 内容结束 -->
          </div>
          <div class="componentBottom"></div>
        </div>	         <div class="component" id="module_47" load_style="1" style="display:none">
          <div class="componentBar">
          <span class="title floatLeft">谁看过这篇博文</span>
          </div>
          <div class="componentContent">
			<!-- 内容开始 -->
			<div class="nodata2">读取中...</div>
			<!-- 内容结束 -->
          </div>
          <div class="componentBottom"></div>
        </div>	 
      </div>
      
    </div>
    <div class="clear"></div>
</div>
<script type="text/javascript"  charset="utf-8" src="http://sjs.sinajs.cn/common/js/sina_blog_foot.js"></script>
</div>
<span name='pvcounter' pid='1' key='59c509700100ca5u' url='http://blog.sina.com.cn/s/blog_59c509700100ca5u.html' expara='' style='display:none'></span>
	   <script id='PVCOUNTER_FORIE' type='text/javascript'></script>
	    


<iframe id="webIM_Conn_Iframe" style="width:1px;height:1px;position:absolute;left:1px;top:1px;filter:alpha(opacity=0);-moz-opacity:0;"></iframe>
<div id="webIM_Conn_Connect">
</div>

</body>
<script>var __sayon_webim_msg_pop__ = false;</script> 
<script src="http://sjs.sinajs.cn/common/js/webim.compressed.js"></script>
<script type="text/javascript">loadResource();</script>
<script type="text/javascript">renderPage();</script>
<script type="text/javascript">
<!--
	SinaSysTray.pro_init();
//-->
</script>
<script type="text/javascript">
// 登陆后输出登陆者的UID
if($UID != null){
	webIM($UID);
}
</script>

<script type="text/javascript">
if($UID != null && $UID != scope.$uid){
	dwScript({url:"http://footprint.cws.api.sina.com.cn/add.php?pid=1&uid=" + scope.$uid + (typeof scope.$articleid != "undefined" ? "&subid=" + scope.$articleid : "") + "&varname=addNewVisitor"}); } 
</script>
<script type='text/javascript' src='http://news.sina.com.cn/pvcounter/pvcounter.js'></script>
<script type="text/javascript" src="http://blog.sina.com.cn/lm/html/2006-10-09/680.js"></script>
 
<!-- SUDA_CODE_START -->
<script type="text/javascript" src="http://www.sinaimg.cn/unipro/pub/suda_s_v851c.js"></script>
<script type="text/javascript" >
//<!--
try{
var config_pic = config?(config.common?((config.common.head || config.common.head)?((config.common.head.usepic || config.common.bg.usepic)?((config.common.head.usepic=='1')||(config.common.bg.usepic=='1')?1:0):0):0):0):0;
_S_pSt(_S_PID_,config.common.t,config.common.r+","+config_pic);
}catch(e){}
//-->
</script>
<!-- SUDA_CODE_END -->
  
  
<!-- START WRating v1.0 -->
<script type="text/javascript" src="http://sina.wrating.com/a1.js"></script>
<script type="text/javascript">
try{
var vjAcc="860010-0328010000"; 
var wrUrl="http://sina.wrating.com/";
vjTrack("");
}catch(e){};
</script>
<noscript><img src="http://sina.wrating.com/a.gif?a=&amp;c=860010-0328010000" width="1" height="1" style="display: none;"/></noscript>
<!-- END WRating v1.0 -->

<!-- SSO_CODE_START -->
<SCRIPT LANGUAGE="JavaScript">
<!--
 if($UID != null){
  document.write("<scr" + "ipt charset='utf-8' src='http://image2.sina.com.cn/unipro/js/ssologin.js'></scr" + "ipt>"); 
 }
//-->
</SCRIPT>
<!-- SSO_CODE_END -->

</html>
