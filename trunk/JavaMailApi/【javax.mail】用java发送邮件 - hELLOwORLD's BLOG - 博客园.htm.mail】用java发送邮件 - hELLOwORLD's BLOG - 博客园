<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>【javax.mail】用java发送邮件 - hELLOwORLD's BLOG - 博客园</title>
<meta name="keywords" content="javax.mail,用java发送邮件,hELLOwORLD's,BLOG,hELLOwOLRD,hw,02.Java" />
<meta name="description" content="用到的三个jar文件：点击这里下载源文件：/***邮件发送组件类*该类需要三个jar文件:mail.jar,activation.jar,htmlparser.jar*&#64;authorWinterLau(winter.lau&#64;163.com)*&#64;ve..." />
<link type="text/css" rel="stylesheet" href="http://www.cnblogs.com/css/common.css" />
<link type="text/css" rel="stylesheet" href="http://www.cnblogs.com/Skins/arrow/style.css"/>
<link type="text/css" rel="stylesheet" href="http://www.cnblogs.com/css/common2.css" />
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/hw/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/hw/rsd.xml"/> 
<script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script src="http://www.cnblogs.com/script/common.js" type="text/javascript"></script>
<script src="http://common.cnblogs.com/script/jquery.json-1.3.min.js" type="text/javascript"></script>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/css/shCore.css"/>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/css/shThemeDefault.css"/>
</head>
<body>
    <form name="Form1" method="post" action="81283.html" id="Form1">
<div>
<input type="hidden" name="__VIEWSTATE" id="
__VIEWSTATE" value="" />
</div>

        
<!--done-->
<div id="header">
	
<!--done-->
<div class="header">
	<div class="headerText">
		<a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/hw/">hELLOwORLD's BLOG</a><br>
		  百分制中，自我评价总是58
	</div>
</div>

</div>
<div id="mylinks">
<!--done-->
<a id="MyLinks1_HomeLink" class="menu" href="http://www.cnblogs.com/">博客园</a>&nbsp;&nbsp;&nbsp;
<a id="MyLinks1_MyHomeLink" class="menu" href="http://www.cnblogs.com/hw/">首页</a>&nbsp;&nbsp;&nbsp;
<a id="MyLinks1_NewPostLink" class="menu" href="http://www.cnblogs.com/hw/admin/EditPosts.aspx?opt=1">新随笔</a>&nbsp;&nbsp;&nbsp;
<a id="MyLinks1_ContactLink" accesskey="9" class="menu" href="http://www.cnblogs.com/hw/contact.aspx?id=1">联系</a>&nbsp;&nbsp;&nbsp;
<a id="MyLinks1_Syndication" class="menu" href="http://www.cnblogs.com/hw/rss">订阅</a><a id="MyLinks1_XMLLink" href="http://www.cnblogs.com/hw/rss"><img src="http://www.cnblogs.com/images/xml.gif" alt="订阅" style="border-width:0px;" /></a>&nbsp;&nbsp;&nbsp;
<a id="MyLinks1_Admin" class="menu" href="http://www.cnblogs.com/hw/admin/EditPosts.aspx">管理</a>
</div>
<div id="mytopmenu">
	
		
<div class="blogStats">随笔 - 16&nbsp;
文章 - 41&nbsp;评论 - 34&nbsp;trackbacks - 0
</div>
	
</div>
<div id="leftcontent">
	
		<DIV id="leftcontentcontainer">
			<br>
			
<!--done-->
<div class="newsItem">
	<script src="http://www.clocklink.com/embed.js"></script><script type="text/javascript" language="JavaScript">obj = new Object;obj.clockfile = "5006-blue.swf";obj.TimeZone = "GMT0800";obj.width = 200;obj.height = 120;obj.wmode = "transparent";showClock(obj);</script>
</div>

			
<div class="catListInteraction">
<h3 class="catListTitle">与我联系</h3>
<ul>
 <li>
     <a id="SingleColumn1_ctl00_lnkSendMsg" class="sendMsg" href="http://space.cnblogs.com/msg/send/hELLOwOLRD">发短消息</a>
 </li>
</ul>
</div>
<script type="text/javascript">
function zzk_go()
{
	var blogapp = 'hw';
	var keystr = encodeURIComponent("blog:"+blogapp+" "+document.getElementById('q').value);
    window.location = "http://zzk.cnblogs.com/s?w="+keystr;
}
function zzk_go_enter(event)
{
	if(event.keyCode == 13)
	{
	    zzk_go();
	    return false;
	}
}
</script>
<div class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div class="div_my_zzk"><input  type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk"/>&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"/></div>
</div>
<h3>常用链接</h3>
<ul>

		<li><a id="SingleColumn1_ctl02_rptMainLinks_ctl00_lnkLinkItem" href="http://www.cnblogs.com/hw/MyPosts.html">我的随笔</a></li>
	
		<li><a id="SingleColumn1_ctl02_rptMainLinks_ctl01_lnkLinkItem" href="http://space.cnblogs.com/hw">我的空间</a></li>
	
		<li><a id="SingleColumn1_ctl02_rptMainLinks_ctl02_lnkLinkItem" href="http://space.cnblogs.com/msg/recent">我的短信</a></li>
	
		<li><a id="SingleColumn1_ctl02_rptMainLinks_ctl03_lnkLinkItem" href="http://www.cnblogs.com/hw/MyComments.html">我的评论</a></li>
	
<li><a id="itemListLink" onclick="this.blur();WarpClass('itemListLink', 'itemListLin_con');return false;" href="#">更多链接</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>
		<li><a id="SingleColumn1_ctl02_repeaterLinks_ctl01_lnkLinkItem" title="我发表过评论的随笔" href="http://www.cnblogs.com/hw/OtherPosts.html">我的参与</a></li>
	
		<li><a id="SingleColumn1_ctl02_repeaterLinks_ctl02_lnkLinkItem" href="http://www.cnblogs.com/hw/MyNews.html">我的新闻</a></li>
	
		<li><a id="SingleColumn1_ctl02_repeaterLinks_ctl03_lnkLinkItem" href="http://www.cnblogs.com/hw/RecentComments.html">最新评论</a></li>
	
		<li><a id="SingleColumn1_ctl02_repeaterLinks_ctl04_lnkLinkItem" href="http://www.cnblogs.com/hw/tag/">我的标签</a></li>
	</ul>
</div>
<h3 class="catListTitle">留言簿</h3>
<ul>
	<li><a id="SingleColumn1_ctl03_lnkMessages" href="http://www.cnblogs.com/hw/Contact.aspx?id=1">给我留言</a></li>
	<!--<li><a id="SingleColumn1_ctl03_lnkPublicMsgView" href="http://www.cnblogs.com/hw/default.aspx?opt=msg">查看公开留言</a></li>-->
	<li><a id="SingleColumn1_ctl03_lnkPrivateMsgView" href="http://www.cnblogs.com/hw/admin/MyMessages.aspx">查看留言</a></li>
</ul>


<!--done-->

		<h1 class = "catListTitle">随笔档案</h1>
		
				<ul class = "catList">
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl01_Link" class="listitem" href="http://www.cnblogs.com/hw/archive/2008/12.html">2008年12月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl02_Link" class="listitem" href="http://www.cnblogs.com/hw/archive/2005/10.html">2005年10月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl03_Link" class="listitem" href="http://www.cnblogs.com/hw/archive/2005/04.html">2005年4月 (2)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl04_Link" class="listitem" href="http://www.cnblogs.com/hw/archive/2005/03.html">2005年3月 (2)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl05_Link" class="listitem" href="http://www.cnblogs.com/hw/archive/2005/01.html">2005年1月 (4)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl06_Link" class="listitem" href="http://www.cnblogs.com/hw/archive/2004/12.html">2004年12月 (5)</a></li>
			
				</ul>
			
	
		<h1 class = "catListTitle">文章分类</h1>
		
				<ul class = "catList">
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl01_Link" class="listitem" href="http://www.cnblogs.com/hw/category/75546.html">01.Design</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl01_RssLink" title="Subscribe to 01.Design" class="listitem" href="http://www.cnblogs.com/hw/category/75546.html/rss"><img title="Subscribe to 01.Design" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl02_Link" class="listitem" href="http://www.cnblogs.com/hw/category/22013.html">02.Java(3)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl02_RssLink" title="Subscribe to 02.Java(3)" class="listitem" href="http://www.cnblogs.com/hw/category/22013.html/rss"><img title="Subscribe to 02.Java(3)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl03_Link" class="listitem" href="http://www.cnblogs.com/hw/category/15754.html">03.DataBase(1)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl03_RssLink" title="Subscribe to 03.DataBase(1)" class="listitem" href="http://www.cnblogs.com/hw/category/15754.html/rss"><img title="Subscribe to 03.DataBase(1)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl04_Link" class="listitem" href="http://www.cnblogs.com/hw/category/15396.html">04.AOP</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl04_RssLink" title="Subscribe to 04.AOP" class="listitem" href="http://www.cnblogs.com/hw/category/15396.html/rss"><img title="Subscribe to 04.AOP" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl05_Link" class="listitem" href="http://www.cnblogs.com/hw/category/15075.html">05.MVC(8)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl05_RssLink" title="Subscribe to 05.MVC(8)" class="listitem" href="http://www.cnblogs.com/hw/category/15075.html/rss"><img title="Subscribe to 05.MVC(8)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl06_Link" class="listitem" href="http://www.cnblogs.com/hw/category/13888.html">06.O/R Mapping(8)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl06_RssLink" title="Subscribe to 06.O/R Mapping(8)" class="listitem" href="http://www.cnblogs.com/hw/category/13888.html/rss"><img title="Subscribe to 06.O/R Mapping(8)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl07_Link" class="listitem" href="http://www.cnblogs.com/hw/category/36528.html">07.Eclipse/SWT/JFace(3)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl07_RssLink" title="Subscribe to 07.Eclipse/SWT/JFace(3)" class="listitem" href="http://www.cnblogs.com/hw/category/36528.html/rss"><img title="Subscribe to 07.Eclipse/SWT/JFace(3)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl08_Link" class="listitem" href="http://www.cnblogs.com/hw/category/67880.html">08.Other framework(11)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl08_RssLink" title="Subscribe to 08.Other framework(11)" class="listitem" href="http://www.cnblogs.com/hw/category/67880.html/rss"><img title="Subscribe to 08.Other framework(11)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl09_Link" class="listitem" href="http://www.cnblogs.com/hw/category/23890.html">09.JS/HTML/CSS(2)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl09_RssLink" title="Subscribe to 09.JS/HTML/CSS(2)" class="listitem" href="http://www.cnblogs.com/hw/category/23890.html/rss"><img title="Subscribe to 09.JS/HTML/CSS(2)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl10_Link" class="listitem" href="http://www.cnblogs.com/hw/category/15343.html">10.Application server(2)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl10_RssLink" title="Subscribe to 10.Application server(2)" class="listitem" href="http://www.cnblogs.com/hw/category/15343.html/rss"><img title="Subscribe to 10.Application server(2)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl11_Link" class="listitem" href="http://www.cnblogs.com/hw/category/33818.html">11.System(1)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl11_RssLink" title="Subscribe to 11.System(1)" class="listitem" href="http://www.cnblogs.com/hw/category/33818.html/rss"><img title="Subscribe to 11.System(1)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl12_Link" class="listitem" href="http://www.cnblogs.com/hw/category/75545.html">12.Other(2)</a><a id="SingleColumn1_Categories_CatList_ctl01_LinkList_ctl12_RssLink" title="Subscribe to 12.Other(2)" class="listitem" href="http://www.cnblogs.com/hw/category/75545.html/rss"><img title="Subscribe to 12.Other(2)" src="/Images/xml.gif" style="border-width:0px;" /></a></li>
			
				</ul>
			
	
		<h1 class = "catListTitle">文章档案</h1>
		
				<ul class = "catList">
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl01_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2008/11.html">2008年11月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl02_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2007/05.html">2007年5月 (2)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl03_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2006/11.html">2006年11月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl04_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2006/10.html">2006年10月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl05_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2006/08.html">2006年8月 (2)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl06_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2006/07.html">2006年7月 (4)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl07_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2006/02.html">2006年2月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl08_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2005/10.html">2005年10月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl09_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2005/09.html">2005年9月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl10_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2005/08.html">2005年8月 (1)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl11_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2005/04.html">2005年4月 (7)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl12_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2005/03.html">2005年3月 (3)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl13_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2004/12.html">2004年12月 (11)</a></li>
			
				<li class = "catListItem"> <a id="SingleColumn1_Categories_CatList_ctl02_LinkList_ctl14_Link" class="listitem" href="http://www.cnblogs.com/hw/archives/2004/11.html">2004年11月 (5)</a></li>
			
				</ul>
			
	


<h3 class="catListTitle">最新评论
	<a id="SingleColumn1__f90df4_RSSHyperlink1" href="http://www.cnblogs.com/hw/CommentsRSS.aspx"><img src="/images/xml.gif" style="border-width:0px;" /></a></h3>
<div class="RecentComment" id="RecentComments">
	
			<ul>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__f90df4_CommentList_ctl01_Hyperlink1" href="http://www.cnblogs.com/hw/articles/447878.html#1461284">1. re: 【POI】用POI读写Excel【未完】</a>
			</li>
			<li style="word-break:break-all">
				     POI写图片是指什么？是指从其他地方读到图片后插入到Excel里面吗？如果我的理解没错的话，POI是可以插入图片的!
			</li>
			<li style="text-align:right;margin-right:4px">
				--询问者</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__f90df4_CommentList_ctl02_Hyperlink1" href="http://www.cnblogs.com/hw/articles/68242.html#1422536">2. re: 【hibernate】Middlegen-Hibernate的配制和使用(jtds连接sqlserver数据库)</a>
			</li>
			<li style="word-break:break-all">
				博主似乎很了解JTDS，不知道是不是也很精通Java，我手里有兼职项目外包，博主如果有兴趣而且身在北京，联系我。
			</li>
			<li style="text-align:right;margin-right:4px">
				--engineer_alex</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__f90df4_CommentList_ctl03_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/04/05/132258.html#1278966">3. re: 惨绝人寰的时尚，每件皮草都残酷（真实录像）</a>
			</li>
			<li style="word-break:break-all">
				@hELLOwOLRD<br/>请给我发一个，我要给亲戚朋友上一课
			</li>
			<li style="text-align:right;margin-right:4px">
				--FIONA</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__f90df4_CommentList_ctl04_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/10/26/262506.html#1199075">4. re: 最牛最色的网络签名大全！（超级搞笑）</a>
			</li>
			<li style="word-break:break-all">
				.........
			</li>
			<li style="text-align:right;margin-right:4px">
				--QQ签名</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__f90df4_CommentList_ctl05_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2004/12/18/78699.html#1198812">5. re: 经典签名</a>
			</li>
			<li style="word-break:break-all">
				西伯利亚南走，你还有命没有
			</li>
			<li style="text-align:right;margin-right:4px">
				--QQ签名</li>
		
			</ul>
		
</div>

<h3 class="catListTitle">阅读排行榜</h3>
<div class="RecentComment" id="TopViewPosts"> 
	
			<ul style="word-break:break-all">
		
			<li>
				<a id="SingleColumn1_ctl08_TopList_ctl01_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/04/05/132258.html">1. 惨绝人寰的时尚，每件皮草都残酷（真实录像）(1842)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl08_TopList_ctl02_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2004/12/27/82541.html">2. Hello World 的n多种计算机语言写法(710)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl08_TopList_ctl03_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2004/12/13/76459.html">3. OFFICE的秘密(708)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl08_TopList_ctl04_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2004/12/31/84575.html">4. HELLO WORLD 版的程序员的进化 (549)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl08_TopList_ctl05_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/01/24/96574.html">5. 到年底了，大家好像都很闲(543)</a>
			</li>
		
			</ul>
		
</div>

<h3 class="catListTitle">评论排行榜</h3>
<div class="RecentComment" id="TopCommentsPosts">
	
			<ul style="word-break:break-all">
		
			<li>
				<a id="SingleColumn1_ctl09_TopList_ctl01_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/04/05/132258.html">1. 惨绝人寰的时尚，每件皮草都残酷（真实录像）(10)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl09_TopList_ctl02_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2004/12/27/82541.html">2. Hello World 的n多种计算机语言写法(2)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl09_TopList_ctl03_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/10/26/262506.html">3. 最牛最色的网络签名大全！（超级搞笑）(1)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl09_TopList_ctl04_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2004/12/18/78699.html">4. 经典签名(1)</a>
			</li>
		
			<li>
				<a id="SingleColumn1_ctl09_TopList_ctl05_Hyperlink1" href="http://www.cnblogs.com/hw/archive/2005/01/24/96574.html">5. 到年底了，大家好像都很闲(1)</a>
			</li>
		
			</ul>
		
</div></DIV>		
	
</div>
<div id="centercontent">
	
					<a name="#top"/>
<!--done-->
<div class = "post">
	<div class = "postTitle">
		<a id="ctl04_TitleUrl" class="postTitle2" href="http://www.cnblogs.com/hw/articles/81283.html">【javax.mail】用java发送邮件</a>
	</div>
	<p>用到的三个jar文件：<a href="http://files.cnblogs.com/hw/发送mail用到的3个jar文件.rar">点击这里下载 <br></a>源文件： <br>/** <br>&nbsp;* 邮件发送组件类 <br>&nbsp;* 该类需要三个jar文件: mail.jar,activation.jar,htmlparser.jar <br>&nbsp;* &#64;author Winter Lau (<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#119;&#105;&#110;&#116;&#101;&#114;&#46;&#108;&#97;&#117;&#64;&#49;&#54;&#51;&#46;&#99;&#111;&#109;">winter.lau&#64;163.com</a>) <br>&nbsp;* &#64;version 1.0 <br>&nbsp;*/ <br>package helloword.test.sendmail; </p>
<p>import java.io.File; <br>import java.io.UnsupportedEncodingException; <br>import java.util.ArrayList; <br>import java.util.Date; <br>import java.util.Properties; </p>
<p>import javax.activation.DataHandler; <br>import javax.activation.DataSource; <br>import javax.activation.FileDataSource; <br>import javax.mail.Authenticator; <br>import javax.mail.BodyPart; <br>import javax.mail.Message; <br>import javax.mail.MessagingException; <br>import javax.mail.Multipart; <br>import javax.mail.PasswordAuthentication; <br>import javax.mail.SendFailedException; <br>import javax.mail.Session; <br>import javax.mail.Transport; <br>import javax.mail.internet.InternetAddress; <br>import javax.mail.internet.MimeBodyPart; <br>import javax.mail.internet.MimeMessage; <br>import javax.mail.internet.MimeMultipart; </p>
<p>import org.htmlparser.Node; <br>import org.htmlparser.Parser; <br>import org.htmlparser.tags.ImageTag; <br>import org.htmlparser.util.ParserException; </p>
<p>/** <br>&nbsp;* 邮件发送组件,具体的使用方法参照该类的main方法 <br>&nbsp;* &#64;author Liudong <br>&nbsp;*/ <br>public abstract class MailSender extends Authenticator{ </p>
<p>&nbsp;&nbsp;&nbsp; private String username = null;&nbsp;&nbsp;//邮件发送帐号用户名 <br>&nbsp;&nbsp;&nbsp; private String userpasswd = null;&nbsp;//邮件发送帐号用户口令 <br>&nbsp;&nbsp;&nbsp; protected BodyPart messageBodyPart = null; <br>&nbsp;&nbsp;&nbsp; protected Multipart multipart = new MimeMultipart("related"); <br>&nbsp;&nbsp;&nbsp; protected MimeMessage mailMessage = null; <br>&nbsp;&nbsp;&nbsp; protected Session mailSession = null; <br>&nbsp;&nbsp;&nbsp; protected Properties mailProperties = System.getProperties(); <br>&nbsp;&nbsp;&nbsp; protected InternetAddress mailFromAddress = null; <br>&nbsp;&nbsp;&nbsp; protected InternetAddress mailToAddress = null; <br>&nbsp;&nbsp;&nbsp; protected Authenticator authenticator = null; <br>&nbsp;&nbsp;&nbsp; protected String mailSubject = ""; <br>&nbsp;&nbsp;&nbsp; protected Date mailSendDate = null; </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 构造函数 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param smtpHost <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param username <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param password <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; protected MailSender(String smtpHost, String username, String password) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.username = username; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.userpasswd = password; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailProperties.put("mail.smtp.host", smtpHost); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailProperties.put("mail.smtp.auth", "true"); //设置smtp认证，很关键的一句 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailSession = Session.getDefaultInstance(mailProperties, this); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage = new MimeMessage(mailSession); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart = new MimeBodyPart(); <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 构造一个纯文本邮件发送实例 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param smtpHost <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param username <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param password <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;return <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public static MailSender getTextMailSender(String smtpHost, String username, String password) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new MailSender(smtpHost,username,password) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void setMailContent(String mailContent) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setText(mailContent); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multipart.addBodyPart(messageBodyPart); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }; <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 构造一个超文本邮件发送实例 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param smtpHost <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param username <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param password <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;return <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public static MailSender getHtmlMailSender(String smtpHost, String username, String password) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new MailSender(smtpHost,username,password) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private ArrayList arrayList1 = new ArrayList(); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private ArrayList arrayList2 = new ArrayList(); </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public void setMailContent(String mailContent) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String htmlContent = getContent("&lt;img src=", mailContent); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setContent(htmlContent, "text/html;charset=GB2312"); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multipart.addBodyPart(messageBodyPart); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //调用处理html文件中的图片方法 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; processHtmlImage(mailContent); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //处理html页面上的图片方法如下： <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private void processHtmlImage(String mailContent) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; arrayList1.size(); i++) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart = new MimeBodyPart(); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataSource source = new FileDataSource((String) arrayList1.get(i)); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setDataHandler(new DataHandler(source)); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String contentId = "&lt;" + (String) arrayList2.get(i) + "&gt;"; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setHeader("Content-ID", contentId); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setFileName((String) arrayList1.get(i)); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multipart.addBodyPart(messageBodyPart); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //处理要发送的html文件，主要是针对html文件中的图片 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private String getContent(String searchString, String mailContent) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Parser parser = Parser.createParser(new String(mailContent.getBytes(), ISO8859_1)); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Node[] images = parser.extractAllNodesThatAre(ImageTag.class); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0;i&lt;images.length;i++) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ImageTag imgTag = (ImageTag) images[i]; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(!imgTag.getImageURL().toLowerCase().startsWith("http://")) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arrayList1.add(imgTag.getImageURL()); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (UnsupportedEncodingException e1) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (ParserException e) {} <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String afterReplaceStr = mailContent; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //在html文件中用"cid:"+Content-ID来替换原来的图片链接 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int m = 0; m &lt; arrayList1.size(); m++) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; arrayList2.add(createRandomStr()); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String addString = "cid:" + (String) arrayList2.get(m); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; afterReplaceStr = mailContent.replaceAll( <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (String) arrayList1.get(m), addString); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return afterReplaceStr; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //产生一个随机字符串，为了给图片设定Content-ID值 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private String createRandomStr() { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; char[] randomChar = new char[8]; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; 8; i++) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; randomChar[i] = (char) (Math.random() * 26 + 'a'); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String replaceStr = new String(randomChar); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return replaceStr; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; private final static String ISO8859_1 = "8859_1"; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }; <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 用于实现邮件发送用户验证 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;see javax.mail.Authenticator#getPasswordAuthentication <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; protected PasswordAuthentication getPasswordAuthentication() { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return new PasswordAuthentication(username, userpasswd); <br>&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 设置邮件标题 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param mailSubject <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws MessagingException <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public void setSubject(String mailSubject) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.mailSubject = mailSubject; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.setSubject(mailSubject); <br>&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 所有子类都需要实现的抽象方法，为了支持不同的邮件类型 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param mailContent <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws MessagingException <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; protected abstract void setMailContent(String mailContent) throws MessagingException; </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 设置邮件发送日期 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param sendDate <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws MessagingException <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public void setSendDate(Date sendDate) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; this.mailSendDate = sendDate; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.setSentDate(sendDate); <br>&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 设置邮件发送附件 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param attachmentName <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws MessagingException <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public void setAttachments(String attachmentName) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart = new MimeBodyPart(); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DataSource source = new FileDataSource(attachmentName); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setDataHandler(new DataHandler(source)); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int index = attachmentName.lastIndexOf(File.separator); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String attachmentRealName = attachmentName.substring(index + 1); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; messageBodyPart.setFileName(attachmentRealName); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; multipart.addBodyPart(messageBodyPart); <br>&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 设置发件人地址 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param mailFrom <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws MessagingException <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public void setMailFrom(String mailFrom) throws MessagingException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailFromAddress = new InternetAddress(mailFrom); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.setFrom(mailFromAddress); <br>&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 设置收件人地址，收件人类型为to,cc,bcc(大小写不限) <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param mailTo&nbsp;&nbsp; 邮件接收者地址 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param mailType 值为to,cc,bcc <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;author Liudong <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public void setMailTo(String[] mailTo, String mailType) throws Exception { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for (int i = 0; i &lt; mailTo.length; i++) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailToAddress = new InternetAddress(mailTo[i]); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (mailType.equalsIgnoreCase("to")) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.addRecipient(Message.RecipientType.TO,mailToAddress); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (mailType.equalsIgnoreCase("cc")) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.addRecipient(Message.RecipientType.CC,mailToAddress); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else if (mailType.equalsIgnoreCase("bcc")) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.addRecipient(Message.RecipientType.BCC,mailToAddress); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } else { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new Exception("Unknown mailType: " + mailType + "!"); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 开始发送邮件 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws MessagingException <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;throws SendFailedException <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public void sendMail() throws MessagingException, SendFailedException { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if (mailToAddress == null) <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; throw new MessagingException("请你必须你填写收件人地址！"); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mailMessage.setContent(multipart); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Transport.send(mailMessage); <br>&nbsp;&nbsp;&nbsp; } </p>
<p>&nbsp;&nbsp;&nbsp; /** <br>&nbsp;&nbsp;&nbsp;&nbsp; * 邮件发送测试 <br>&nbsp;&nbsp;&nbsp;&nbsp; * &#64;param args <br>&nbsp;&nbsp;&nbsp;&nbsp; */ <br>&nbsp;&nbsp;&nbsp; public static void main(String args[]) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String mailHost = "smtp.163.com";&nbsp;//发送邮件服务器地址 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String mailUser = "hELLOwORD";&nbsp;&nbsp;&nbsp;//发送邮件服务器的用户帐号 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String mailPassword = "******";&nbsp; &nbsp;//发送邮件服务器的用户密码 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String[] toAddress = {"<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#116;&#116;&#111;&#99;&#64;&#49;&#54;&#51;&#46;&#99;&#111;&#109;">ttoc&#64;163.com</a>"}; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //使用超文本格式发送邮件 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MailSender sendmail = MailSender.getHtmlMailSender(mailHost, mailUser,mailPassword); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //使用纯文本格式发送邮件 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //MailSender sendmail = MailSender.getTextMailSender(mailHost, mailUser,mailPassword); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.setSubject("要发送的标题？"); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.setSendDate(new Date()); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String content = "&lt;H1&gt;hELLOwORD's Test&lt;/H1&gt;&lt;img src=\"<a href="http://www.javayou.com/images/logo.gif/">http://www.javayou.com/images/logo.gif\</a>"&gt;"; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //请注意如果是本地图片比如使用斜杠作为目录分隔符,如下所示,不支持中文？？？！！！ <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; content+="&lt;img src=\"C:/Documents and Settings/Administrator/My Documents/My Pictures/aaa.jpg\"/&gt;"; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.setMailContent(content); // <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.setAttachments("E:\\ConList.exe");//文章附件 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.setMailFrom("<a href='&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#116;&#116;&#111;&#99;&#64;&#49;&#54;&#51;&#46;&#99;&#111;&#109;&#34;&#41;&#59;&#47;&#47;' href_cetemp='mailto:ttoc&#64;163.com");//'>ttoc&#64;163.com");//</a>显示谁发送的 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.setMailTo(toAddress, "to");//cc抄送，bcc 暗送 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //sendmail.setMailTo(toAddress, "cc");//设置抄送给... <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //开始发送邮件 <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("正在发送邮件，请稍候......."); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sendmail.sendMail(); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println("恭喜你，邮件已经成功发送!"); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (Exception ex) { <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ex.printStackTrace(); <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>&nbsp;&nbsp;&nbsp; } </p>
<p><br>} <br></p>

<div id="div_digg">										
	<div class="diggit" onclick="DiggIt(81283,7864,1)"> 
		<span class="diggnum" id="digg_count_81283">0</span>
	</div>
	<div class="buryit" onclick="DiggIt(81283,7864,2)"> 
		<span class="burynum" id="bury_count_81283">0</span>
	</div>
	<div class="clear"></div>
	<span style="display:none" id="span_isdigged_81283">0</span>	
	<div class="diggword" id="digg_word_81283">(请您对文章做出评价)</div>	
</div>
<div class="clear"></div>



	<div class = "postDesc">posted on 2004-12-24 09:02 <a href='http://www.cnblogs.com/hw/'>hELLOwOLRD</a> 阅读(1565) <a href='#Post'>评论(0)</a> &nbsp;<a href="http://www.cnblogs.com/hw/admin/EditArticles.aspx?postid=81283">编辑</a> <a href="http://www.cnblogs.com/hw/AddToFavorite.aspx?id=81283">收藏</a> <a href="#" onclick="PutInWz();return false;">网摘</a>  所属分类: <a href='http://www.cnblogs.com/hw/category/22013.html'>02.Java</a></div>
</div>
<img src ="http://www.cnblogs.com/hw/aggbug/81283.html?type=2&webview=1" width = "1" height = "1" />

<!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
xmlns:dc="http://purl.org/dc/elements/1.1/"
xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
rdf:about="http://www.cnblogs.com/hw/articles/81283.html"
dc:identifier="http://www.cnblogs.com/hw/articles/81283.html"
dc:title=""
trackback:ping="http://www.cnblogs.com/hw/services/trackbacks/81283.aspx" />
</rdf:RDF>
-->
<span style='display:none'>Body:375,BeforeCate:0,46.875</span>


<script type="text/javascript">
    var commentAuthorHasChecked = false;
    var commentAuthorIsValid = false;
    var commentUrlIsValid = true;
    var commentEmailIsValid = true;
    var authenCodeHasChecked = false;
    var authenCodeIsValid = true;
    
    function PostComment() {    
        
        var isValid = true;
        
        if($("#wrapAuthenCode").css("display")=="none"){
            ShowAuthenCode();
            $("#tip_AuthenCode").css("color","red");
            $("#tip_AuthenCode").html("请输入验证码！");
            isValid = false;
        }
        
        if(!commentAuthorHasChecked){
            CheckAuthor();        
        }                
        if(!commentAuthorIsValid){
            isValid = false;
        }
                       
        if(!authenCodeHasChecked){
            CheckAuthenCode();            
        }
        if(!authenCodeIsValid){
            isValid = false;
        }
        
        if(!commentUrlIsValid){            
            isValid = false;
        }        
        if(!commentEmailIsValid){            
            isValid = false;
        }        
        if(!CheckCommentContent()){
            isValid = false;
        }    
        if(!isValid){
            return;
        }

        var content = $("#tbCommentBody").val();
        if(content.length>2000){
            alert("评论内容过长！不允许发布！");
            return;
        }        
        
       if ($("#span_comment_posted").html()!='' && $("#span_comment_posted").html()==content){
            alert("该评论已发表过!");
            return;
        }
        
        $("#tip_comment").html("评论提交中...");
        $("#span_comment_posted").html(content);
        //content = content.replace("'", "\\'");
        var email = $("#tbCommentEmail").val();
        var authenNum = $("#tbAuthenCode").val();
        var authenId = $("#span_comment_test").html();
        var comment = {};
        comment.authenNum = authenNum;
        comment.authenId= authenId;
        comment.parentId = 81283;
        comment.blogId = 7864;
        comment.sourceUrl = 'http://www.cnblogs.com/hw/articles/81283.html';
        comment.author = $("#tbCommentAuthor").val();
        comment.url = $("#tbCommentAuthorUrl").val();
        comment.authenCode = $("#tbAuthenCode").val();
        comment.email = email;
        comment.title = '【javax.mail】用java发送邮件';
        comment.content = content;
        comment.parentCommentId = $("#span_parentcomment_id").html();
        $.ajax({
            url: '/ws/CommentService.asmx/AddAnonymousComment',
            data: $.toJSON(comment),
            type: "post",
            dataType: "json",
            contentType: "application/json; charset=utf8",
            success: function(data) {
               if (data.d["IsSuccess"]) {
                    ShowCommentMsg("感谢您的回复:)");
                    //RereshComments2(comment.parentId);
                    $("#tbCommentBody").val('');
                    //$("#divCommentShow").html(data.d["ReturnData"]+content.replace(/\n/g,"<br/>")+"<br/><br/>");
                    $("#divCommentShow").html($("#divCommentShow").html()+data.d["ReturnData"]); 
                    $("#tip_AuthenCode").html('');
                    RefreshAuthenCode();
                    $("#tbAuthenCode").val("");                    
                    CommentNotify(data.d["CommentID"]);
                }
                else {
                    ShowCommentMsg(data.d["ReturnData"]);//"抱歉！评论提交失败！请与管理员联系。");
                    $("#span_comment_posted").html(''); 
                }
            },
            error: function(xhr) {
                ShowCommentMsg("抱歉！评论提交失败！请与管理员联系。");
                $("#span_comment_posted").html('');  
                //alert(xhr.responseText);
            }
        }
        );
    }
    
    function RefreshAuthenCode(){
        AjaxPost("/ws/CommentService.asmx/RefreshAuthenCode","{}",RefreshImg); 
        $("#lnkRereshAuthenCode").html("<span style='color:red'>刷新中...</span>");
        return false;
    }
    
    function RefreshImg(response){
       $("#imgAuthenCode").attr("src","/Modules/CaptchaImage/ValidCodeImage.aspx?id="+encodeURIComponent(response));
       $("#span_comment_test").html(response);
       $("#lnkRereshAuthenCode").html("看不清，换一个");
    }
    
    function ShowAuthenCode(){
        //if($("#wrapAuthenCode").css("display")=="none"){    
        //    AjaxPost("/ws/CommentService.asmx/RefreshAuthenCode","{}",ShowAuthenCodeOk);
        //}
        $("#wrapAuthenCode").show();      
    }
    
    function ShowAuthenCodeOk(response){
         UpdateAuthenCode();
         $("#tbAuthenCode").val("");
         $("#wrapAuthenCode").show();
         $("#tip_AuthenCode").html('');
    }  
 
    
    function CheckAuthor(isOnblur){
        commentAuthorHasChecked = true;
        var maxLength = 30;
        if($("#tbCommentAuthor").val().length == 0){
            $("#tip_author").html("请输入您的昵称！");
            commentAuthorIsValid = false;
            return false;
        }     
        else if($("#tbCommentAuthor").val().length > maxLength){
            $("#tip_author").html("昵称不允许超过" + maxLength + "个字符！");
            commentAuthorIsValid = false;
            return false;
        }
        else{
            //if(isOnblur){
                AjaxPost("/ws/CommentService.asmx/IsAuthorExist","{author:'"+$("#tbCommentAuthor").val()+"'}" ,OnCheckAuthorExist);
            //}
            //else{
            //    $("#tip_author").html("");
            //    commentAuthorIsValid = true;
            //}
            return true;
        }
   }
   
    function OnCheckAuthorExist(response){        
        if(!response){
            $("#tip_author").html("");
            commentAuthorIsValid = true;
        }
        else{
            $("#tip_author").html("该昵称已被使用，请更换昵称");
            commentAuthorIsValid = false;
        }
   }
   
    function CheckUrl(){
        var maxLength = 50;
        var url = $("#tbCommentAuthorUrl").val();
        
        if(url.length == 0){
            commentUrlIsValid = true;
            return true;
        }
        else if(url.length > maxLength){
            $("#tip_url").html("主页地址不允许超过" + maxLength + "个字符！");
            commentUrlIsValid = false;
            return false;
        }
        else if(url.indexOf("http://")!=0 || url.indexOf(".") < 0){
            $("#tip_url").html("主页地址要以“http://”开头");
            commentUrlIsValid = false;
            return false;
        }
        else{
            $("#tip_url").html("");
            commentUrlIsValid = true;
            return true;
        }
   }
   
   function CheckEmail(){
        var email = $("#tbCommentEmail").val();
        if(email.length>0){
            var regExp = new RegExp("\\w+@((\\w|\-)+\\.)+[a-z]{2,3}");
            if(!regExp.test(email)){
                $("#tip_email").html("请输入正确的邮件地址!");
                commentEmailIsValid = false;
            }
            else{
                commentEmailIsValid = true;
                 $("#tip_email").html("");
            }
        }
        else{
            commentEmailIsValid = true;
            $("#tip_email").html("");  
        }
   }
   
   function CheckAuthenCode(){
        authenCodeHasChecked = true;
        var num = $("#tbAuthenCode").val();
        var id = $("#span_comment_test").html();
        $("#tip_AuthenCode").css("color","red");
        if(num.length==0){
             authenCodeIsValid = false;
             $("#tip_AuthenCode").html("请输入验证码！");
             return;
        }
        else if(num.length!=4){
            authenCodeIsValid = false;
            $("#tip_AuthenCode").html("请输入四位数字！");
             return;
        }
        else if(new RegExp("(\d+)").test(num)){
            authenCodeIsValid = false;
            $("#tip_AuthenCode").html("请输入四位数字！");
             return;
        }
        else{
            AjaxPost("/ws/CommentService.asmx/CheckAuthenCode","{number:"+num+",id:'"+id+"'}", OnCheckAuthenCode);
        }
   }
   
   function OnCheckAuthenCode(response){
        if(response){
            $("#tip_AuthenCode").css("color","green");
            $("#tip_AuthenCode").html("验证码输入正确！");
            authenCodeIsValid = true;            
        }
        else{
            $("#tip_AuthenCode").css("color","red");
            $("#tip_AuthenCode").html("验证码输错啦！");
            RefreshAuthenCode();
            authenCodeIsValid = false;           
        }
   }
   
   function CheckCommentContent(){
    if($("#tbCommentBody").val().length==0){
        alert("请输入评论内容！");
        return false;
    }
    return true;
   }
    
</script>
<script type="text/javascript" src="http://partner.googleadservices.com/gampad/google_service.js">
</script>
<script type="text/javascript">
    try {
        GS_googleAddAdSenseService("ca-pub-4210569241504288");
        GS_googleEnableAllServices();
    }
    catch (e) { }
</script>
<script type="text/javascript">
    try {
        GA_googleAddSlot("ca-pub-4210569241504288", "cnblogs_commentbox_up");
        GA_googleAddSlot("ca-pub-4210569241504288", "cnblogs_blogpost_bottom");
    }
    catch (e) { }
</script>
<script type="text/javascript">
    try {
        GA_googleFetchAds();
    } catch (e) { }
</script>
<div id="ctl05_comment_form" class="commentform">

<br/>
<script type="text/javascript">
    try {
        GA_googleFillSlot("cnblogs_commentbox_up");
    }
    catch (e) { }
</script>
<br/>
<br/>



<div id="ctl05_divCommentPannel">
<div id="divCommentShow"></div>
<div id="comment_nav" style="text-align:right"><span id="span_refresh_tips"></span><a href="###" onclick="return RefreshCommentList(81283);" name="commentform" id="lnk_RefreshComments">刷新评论列表</a>&nbsp; <a href="###" onclick="return RefreshPage();">刷新页面</a>&nbsp; <a href="#top">返回页首</a></div>
<div id="commentform_title">发表评论</div>
<span id="tip_comment" style="color:Red"></span>
<p>
昵称：<input id="tbCommentAuthor" type="text" class="author" onfocus="ShowAuthenCode()" onblur="CheckAuthor()"/> <span id="tip_author" style="color:red"></span><a href="http://passport.cnblogs.com/login.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fhw%2farticles%2f81283.html%3flogin%3d1%23commentform">[登录]</a>
<a href="http://passport.cnblogs.com/register.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fhw%2farticles%2f81283.html%23Top">[注册]</a>
</p>
<p>
主页：<input id="tbCommentAuthorUrl" type="text" class="url" onfocus="ShowAuthenCode()" onblur="CheckUrl()"/> <span id="tip_url" style="color:red"></span>
</p>
<p>
邮箱：<input id="tbCommentEmail" type="text" class="email" onfocus="ShowAuthenCode()" onblur="CheckEmail()"/>(仅博主可见) <span id="tip_email" style="color:red"></span>
</p>
<p id="wrapAuthenCode" style="display:none">
验证码：<input id="tbAuthenCode" type="text" onblur="CheckAuthenCode()"/> <span id="tip_AuthenCode"></span><img id="imgAuthenCode" src="/Modules/CaptchaImage/ValidCodeImage.aspx?id=aAsrHUxzOkk=" alt="验证码" align="absmiddle"/> <a href="###" onclick="return RefreshAuthenCode();" id="lnkRereshAuthenCode">看不清，换一个</a>
</p>
<p>
评论内容：<span id="tip_comment_content" style="color:Red"></span><br />
<textarea id="tbCommentBody" class="comment_textarea" onkeydown="return clt_enter(event)" onfocus="ShowAuthenCode()">
</textarea>
<!--
<br /><input id="cbRememberMe" type="checkbox" />记住我的昵称和主页
-->
</p>
<p>
<input id="btn_comment_submit" type="button" class="comment_btn" value="提交" onclick="PostComment();return false;"/>
&nbsp;&nbsp;<a href="http://passport.cnblogs.com/login.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fhw%2farticles%2f81283.html%3flogin%3d1%23commentform">登录</a>&nbsp;&nbsp;<a href="http://passport.cnblogs.com/register.aspx?ReturnUrl=http%3a%2f%2fwww.cnblogs.com%2fhw%2farticles%2f81283.html%23Bottom">注册</a>
</p>
<p>
[使用Ctrl+Enter键快速提交评论]
</p>
<div style="display:none">
<span id="comment_edit_id"></span><span id="span_parentcomment_id">0</span>
<span id="span_parent_id">81283</span>
<span id="span_comment_replyto"></span>
<span id="span_comment_posted"></span>
<span id="span_comment_test">aAsrHUxzOkk=</span>
</div>
</div>


<div id="div_commentbox_nav">
链接：<a href="/hw/articles/81283.html?switchskin=1#skinlist">切换模板</a><br />
导航：<a href="http://www.cnblogs.com/" target="_blank">网站首页</a> <a href="http://space.cnblogs.com/" target="_blank">社区</a>  <a href="http://news.cnblogs.com/" target="_blank">新闻</a> 
        <a href="http://space.cnblogs.com/q/" target="_blank">博问</a> <a href="http://space.cnblogs.com/ing/" target="_blank">闪存</a> <a href="http://wz.cnblogs.com/" target="_blank">网摘</a> <a href="http://job.cnblogs.com/" target="_blank">招聘</a>
        <a href="http://zzk.cnblogs.com/" target="_blank">找找看</a> <a href="http://www.cnblogs.com/search.aspx" target="_blank">Google搜索</a>  
</div>

<br />
<script type="text/javascript">
    try {
        GA_googleFillSlot("cnblogs_blogpost_bottom");
    }
    catch (e) { }
</script>
<br />
<div id="div_ad2">
<a href="http://a4.yeshj.com/rd/30179/" target="_blank"><img src="http://a4.yeshj.com/upload/200907/YU-D-S1P-30179_85.gif" border="0px;"/></a>                   
<br />
<a href="http://www.china-pub.com/itbook/" target="_blank">China-pub 计算机图书网上专卖店！6.5万品种
    2-8折！</a><br />
<a href="http://www.china-pub.com/static07/0901/zh_jueba_090121.asp"
    target="_blank">China-Pub 计算机绝版图书按需印刷服务</a><br />
</div>

<br /><div id="relative_posts"><b>相关文章:</b><br/><script language="javascript" type="text/javascript" charset="utf-8"src="http://zzk.cnblogs.com:8080/RCS?tp=0&tt=%e3%80%90javax.mail%e3%80%91%e7%94%a8java%e5%8f%91%e9%80%81%e9%82%ae%e4%bb%b6&tg=&ct=02.Java&url=http%3a%2f%2fwww.cnblogs.com%2fhw%2farticles%2f81283.html"></script><br/><br/><b>相关搜索:</b><br/> <a href="http://zzk.cnblogs.com/s?w=" target="_blank"></a> <a href="http://zzk.cnblogs.com/s?w=02.Java" target="_blank">02.Java</a> </div>


<div class="itnews" id="itnews">
<br /><b>最新IT新闻:</b><br />

            <a href="http://news.cnblogs.com/n/48116/" target="_blank">Windows 7“很幸运” 赶上美国企业PC升级潮</a><br />
	
            <a href="http://news.cnblogs.com/n/48115/" target="_blank">谷歌PC系统细节披露：不用担心中病毒</a><br />
	
            <a href="http://news.cnblogs.com/n/48114/" target="_blank">微软：Silverlight明年将占据互联网设备半壁江山</a><br />
	
            <a href="http://news.cnblogs.com/n/48113/" target="_blank">Google：Chrome与Android系统各有分工</a><br />
	
            <a href="http://news.cnblogs.com/n/48112/" target="_blank">关于 Google Chrome 操作系统的 5 个问题</a><br />
	
</div>
<br />
<div id="div_a4_ads">    
    <b>相关链接:</b>
    <script type="text/javascript">
        var title = document.title;
        document.write("<div id=\"a4_ads_output\">");
        document.write("<script type='text/javascript' src='http://a4.yeshj.com/adwords/EN017?num=7&title=" + encodeURIComponent(title) + "&tag=" + encodeURIComponent(GetMeta("keywords")) + "'></scri" + "pt>");
        document.write("</div>");
    </script>
</div>

<br />
<iframe marginheight="0" marginwidth="0" frameborder="0" width="468" height="0" scrolling="no" src="/ad.htm" style="border:0px solid #666" allowTransparency="true"></iframe>




</div>


				
	
<!--done-->
<div class="footer">
	
	Copyright &copy;2009 hELLOwOLRD Powered by: <a href="http://www.cnblogs.com" class=footerlink>博客园</a> 模板提供：<a href="http://blog.hjenglish.com" class=footerlink>沪江博客</a><br>
</div>
</div>



    </form>
	<script type="text/javascript" src="http://common.cnblogs.com/script/shCore.js"></script>
	<script type="text/javascript" src="http://common.cnblogs.com/script/shLanguage.js"></script>
    <script type="text/javascript">
        try {
            SyntaxHighlighter.all();
        } catch (e) { }
    </script>  
    <script type="text/javascript" src="/script/ShowHidden.js"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-476124-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
