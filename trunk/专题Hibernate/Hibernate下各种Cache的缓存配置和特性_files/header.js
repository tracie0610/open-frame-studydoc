/* Copyright (C) 2008 Microsoft Corporation */new function(){var y=window,x=document,d=y.ActiveXObject?1:0,o=x.body,U=o.parentNode,v=[],w="rtl"===(o.currentStyle?o.currentStyle.direction:document.defaultView.getComputedStyle(o,"").getPropertyValue("direction"))?"right":"left",e=d?x.getElementById:function(a){return x.getElementById(a)},V=e("uxp_hdr_isSafari")?1:0;function c(c,a,b){d?c.attachEvent("on"+a,b):c.addEventListener(a,b,false);v.push({target:c,eventType:a,listener:b})}function M(){var a,b=v.length;while(b--){a=v[b];d?a.target.detachEvent("on"+a.eventType,a.listener):a.target.removeEventListener(a.eventType,a.listener,false)}}function a(p,q,m){var b=this,g=e(p),h=e(q),d=e(m),f=0;if(!g||!h||!d)return;I.call(b,d);b.afterOpen=b.afterClose=function(){};c(g,"mouseup",l);c(g,"click",function(a){var c=P(a),b=c.href;if(k(d,c)&&(!b||R(b,"#"))){l(a);u(a)}else i()});c(h,"click",j);c(d,"mousedown",l);c(h,"blur",function(b){if(N(b)||b&&b.explicitOriginalTarget&&(!k(g,b.explicitOriginalTarget)||b.explicitOriginalTarget===b.target))a.hideIf()});b.hide=function(){if(f){a.hideSubmenuIf();f=z(d);a.openMenu=null;b.afterClose()}};b.show=function(){if(!f){a.hideIf();f=z(d);a.openMenu=b;if(!V)d.parentNode.style.top=T(n)+n.offsetHeight-1+"px";if(b.firstSubmenu)b.firstSubmenu.showSubmenuIfExists();b.afterOpen()}};function j(a){i();l(a);u(a)}function i(){f?b.hide():b.show()}function o(){var a=d.getElementsByTagName("A"),c=-1,e=a.length;while(++c<e)new S(a[c],b)}o()}a.hideIf=function(b){if(!b||!O(b))if(a.openMenu)a.openMenu.hide()};a.hideSubmenuIf=function(){if(h)h.hide()};function R(b,a){return a===b.slice(-a.length)}function T(a){var b=a.offsetTop;while(a=a.offsetParent)b+=a.offsetTop;return b}function z(b){var a=b.style;return "none"===a.display?(a.display="",1):(a.display="none",0)}function L(a,b){return a.className&&-1<a.className.indexOf(b)}function F(a,b){a.className+=" "+b}function B(a,b){a.className=b===a.className?"":a.className.replace(" "+b,"")}function k(b,a){if(d)return b.contains(a);try{while(a&&a!==b)a=a.parentNode;return a===b}catch(c){}}function l(a){d?(event.cancelBubble=true):a.stopPropagation()}function u(a){d?(event.returnValue=false):a.preventDefault()}function O(a){return d?1===event.button?0:2===event.button?2:1:a.button}function Q(a){return d?event.keyCode:a.which}function P(a){return d?event.srcElement:a.target}function N(a){return d?event.shiftKey:a.shiftKey}var h=null;function S(e,j){var f=this,b=e.firstChild,i=b&&L(b,"uxp_hdr_rightArrow"),g=0;if(i){f.meMenuItemParent=e.parentNode;b=e.nextSibling;I.call(f,b);if(!j.firstSubmenu)j.firstSubmenu=f;c(e,"mouseup",function(a){g=1;l(a)});c(e,"click",function(){f===h?g?(g=0):f.hide():f.showSubmenuIfExists()})}f.showSubmenuIfExists=function(){if(!window.event||!window.event.srcElement||"IFRAME"!==window.event.srcElement.nodeName&&(!h||!k(h.meMenuItemParent,e))){a.hideSubmenuIf();if(i)m()}};function m(){var g=e.parentNode.parentNode,d=g.offsetHeight-11,c;b.style[w]=g.offsetWidth-3+"px";b.style.visibility="hidden";b.style.display="block";b.style.height="auto";c=b.offsetHeight;if(c<d)b.style.height=d+"px";b.style.visibility="visible";if(b.nextSibling&&"IFRAME"===b.nextSibling.nodeName){var a=b.nextSibling;a.style[w]=b.style[w];a.style.height=b.offsetHeight+"px";a.style.width=b.offsetWidth+"px"}h=f;F(e,"uxp_hdr_menu_open")}f.hide=function(){B(e,"uxp_hdr_menu_open");b.style.display="none";h=null};c(e.parentNode,d?"mouseenter":"mouseover",f.showSubmenuIfExists)}function I(e){var d=this,b=e.getElementsByTagName("a");function g(){var a=b.length;while(a--)c(b[a],"blur",f)}function f(c){c=c||event;if(c.explicitOriginalTarget){if(!k(e,c.explicitOriginalTarget))d.hide();else if(c.target.firstChild&&"uxp_hdr_rightArrow"===c.target.firstChild.className&&!k(c.target.nextSibling,c.explicitOriginalTarget))a.hideSubmenuIf()}else if(c.shiftKey){if(c.srcElement===b[0])d.hide();else if(c.srcElement.firstChild&&"uxp_hdr_rightArrow"===c.srcElement.firstChild.className)a.hideSubmenuIf()}else if(c.srcElement===b[b.length-1]&&"shiftKey" in c)d.hide()}g()}c(U,"mouseup",a.hideIf);var s=0,p=1,n=e("uxp_hdr"),K=n.offsetParent,f=e("uxp_hdr_tabs"),j=e("uxp_hdr_search"),r=e("uxp_hdr_jewelParent"),G=e("uxp_hdr_meParent"),b=e("uxp_hdr_meLink"),E=b&&b.firstChild?b.firstChild.nodeValue:"",D=b&&b.previousSibling&&b.previousSibling.firstChild?b.previousSibling.firstChild.nodeValue:"",m=32+(r?r.offsetWidth:0)+(f?f.offsetWidth:0)+(j&&j.parentNode?j.parentNode.offsetWidth:0),q=G.offsetWidth,i=q,g;if(b&&b.firstChild){b.firstChild.nodeValue=D;g=G.offsetWidth;b.firstChild.nodeValue=E;if(i-g<20)g=i}else g=i;function t(){if(b){b.firstChild.nodeValue=E;q=i;p=1}}function A(){if(b){b.firstChild.nodeValue=D;q=g;p=0}}function C(){var e,b=K.offsetWidth,a=f.parentNode,c=a.nextSibling;if(0===s){if(b<m+q)if(p&&m+g<=b)A();else{c.style.display="none";a.style.paddingTop=d?"8px":"10px";if(d){f.style.marginTop="3px";a.style.paddingBottom="5px"}a.style.textAlign="center";f.style.marginLeft=f.style.marginRight="auto";a.insertBefore(j,f);e=s=1;t()}else if(!p&&m+i<=b)t()}else if(1===s&&m+g<=b){t();c.style.display=a.style.paddingTop=a.style.textAlign=f.style.marginLeft=f.style.marginRight="";c.appendChild(j);e=1;s=0;if(b<m+i)A()}if(e&&d){n.style.display="none";n.style.display=""}}c(o,"keyup",J);function J(c){var d=Q(c),b=27;if(b===d)a.hideIf()}if(e("uxp_hdr_productSearchButton"))c(e("uxp_hdr_productSearchButton"),"click",u);var H=new a("uxp_hdr_jewelParent","uxp_hdr_jewelLink","uxp_hdr_jewelMenu");H.afterOpen=function(){F(r,"uxp_hdr_jewelSpanOpen")};H.afterClose=function(){B(r,"uxp_hdr_jewelSpanOpen")};if(e("uxp_hdr_meLink"))new a("uxp_hdr_meParent","uxp_hdr_meLink","uxp_hdr_meMenu");if(f&&j){c(y,"resize",C);C()}c(y,"unload",M)}