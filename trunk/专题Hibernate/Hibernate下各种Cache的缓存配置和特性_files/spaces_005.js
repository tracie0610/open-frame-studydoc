registerNamespace("Spaces.Common");Spaces.Common.Strings=new function(){this.global_ok="\u786e\u5b9a";this.global_delete="\u5220\u9664";this.global_cancel="\u53d6\u6d88";this.global_cannotbeundone="\u6b64\u64cd\u4f5c\u65e0\u6cd5\u64a4\u6d88\u3002";this.global_save="\u4fdd\u5b58";this.PhotoAlbum_loadingEllipsis="\u6b63\u5728\u52a0\u8f7d..."};registerNamespace("$Spaces");function OpenFriendWindow(a){window.open(a,"_blank","height=572,width=766,resizable=no,menubar=no,toolbar=no,status=yes,scrollbars=yes")}function ValidateNonEmptyString(a){a=a.trim();if(a.length==0)return false;else return true}function ValidateEmail(b){var a=/^([a-zA-Z0-9_\-\.\+]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;return a.test(b)}function ValidateEmailEx(b){var a=/^[\w\.\+\-]+@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;return a.test(b)}function ValidateAlphaNumeric(b){var a=/[^a-zA-Z0-9]/g;return !a.test(b)}function encodeURI(b){var a;a=escape(b);a=a.replace(/\+/g,"%2B");return a}function decodeURI(a){return unescape(a)}function GetXmlHttpObject(){var a;if(!window.XMLHttpRequest){try{a=new ActiveXObject("Msxml2.XMLHTTP.4.0");return a}catch(b){}try{a=new ActiveXObject("MSXML2.XMLHTTP");return a}catch(b){}try{a=new ActiveXObject("Microsoft.XMLHTTP");return a}catch(b){}return null}else{try{a=new XMLHttpRequest;return a}catch(b){}return null}}function XMLHttp(a,c,b){var d=XMLHttpEx(a,c,b);return d.ResponseText}function XMLHttpEx(b,e,d){var a=[];a["Exception"]=false;a["ResponseText"]="";var c=typeof d!="undefined"&&d==true?"GET":"POST";xmlhttp=GetXmlHttpObject();try{if(xmlhttp!=null){if(c=="POST")b+="&"+C_CANARY_COOKIE_NAME+"="+encodeURI(GetCookieValue(C_CANARY_COOKIE_NAME));xmlhttp.open(c,e,false);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.send(b);a["ResponseText"]=xmlhttp.responseText;a["Status"]=xmlhttp.status}}catch(f){a["Exception"]=true}return a}var g_spudPopOver;function LoadPhotoUploadcontrol(b,a){var c=565;g_spudPopOver=new Spaces.Controls.Popover;g_spudPopOver.width=705;g_spudPopOver.header='<span id="photoUploadTitle">'+Spaces.Utility.GetString(Spaces.Common.Strings,"PhotoAlbum_loadingEllipsis")+"</span>";g_spudPopOver.body='<div id="_spuddiv" style="height:565px">';g_spudPopOver.bodyPadding=false;g_spudPopOver.showFooter=false;g_spudPopOver.showCloseBox=true;g_spudPopOver.show(onPhotoUploadDismiss,a);document.getElementById("_spuddiv").innerHTML='<iframe src ="'+b+'" id="__photoUploadFrame" style="height:'+c+'px; width:705px" frameborder="0"> </iframe>';return null}function onPhotoUploadDismiss(){g_spudPopOver=null;var a=[],c=__photoUploadFrame.window.document.getElementById("MyComputer");a.push(c);while(a.length>0){var b=a.pop();if(b.children)addChildToArray(a,b)}return true}function addChildToArray(d,a){for(var b=a.children.length-1;b>=0;b--){var c=a.children[b];d.push(c);a.removeChild(c)}}function RecopyRTE(a){if(a&&a.webBindings&&a.webBindings.length>0)for(var b=0;b<a.webBindings.length;b++)if(a.webBindings[b].getType()=="$UI.Editor"){a.value=a.webBindings[b].getValue();return}if($Debug&&$Debug.ASSERT);}function BlogIt(c){var g=document.getElementById("subj"+c),h=document.getElementById("msg"+c);if(g!=null&&h!=null){url=BlogJSBlogEntryUrl;var a=document.createElement("form");a.action=url;a.method="post";a.id="doTrackback";a.style.display="none";var b=document.createElement("textarea");b.name="Title";b.value=g.innerText;a.appendChild(b);var f=document.createElement("textarea");f.name="Description";f.value=h.innerHTML;a.appendChild(f);var b=document.createElement("textarea");b.name="SourceURL";b.value=BlogJSPersonalSpaceurl+"blog/"+c+".entry";a.appendChild(b);var d=document.createElement("textarea");d.name="Trackback";d.value=BlogJSPersonalSpaceurl+"blog/"+c+".trak";a.appendChild(d);var e=document.createElement("textarea");e.name="BlogIt";e.value="true";a.appendChild(e);if(document.getElementById("doTrackback"))document.getElementById("doTrackback").outerHTML="";var i=document.body.appendChild(a);i.submit()}}function ScaleImageContactImage(a){window.setTimeout(function(){ScaleImageContactImageCb(a)},1)}function ScaleImageContactImageCb(a){if(null!=a){var b=new Image;b.src=a.src;if(null==b.width||0==b.width||null==b.height||0==b.height||0==a.width||0==a.height)return;var g=Math.min(a.width/b.width,a.height/b.height),f=g*b.width,e=g*b.height,h=(a.width-f)/2,i=(a.height-e)/2;try{a.style.width=f+"px";a.style.height=e+"px";var d=a.parentNode,c;if(null!=d){c=parseInt(d.style.paddingTop);d.style.paddingTop=(isNaN(c)?0:c)+i+"px";c=parseInt(d.style.paddingLeft);d.style.paddingLeft=(isNaN(c)?0:c)+h+"px"}}catch(j){}}}SpacesUrlBuilder=new function(){this.GotoUrl=function(a){window.location.href=a};this.ConstructFrontdoorUrl=function(b,a){if(a!=null){var c="http://{0}{1}?{2}";return c.format(C_FRONTDOOR_HOSTNAME,b,a)}else{var c="http://{0}{1}";return c.format(C_FRONTDOOR_HOSTNAME,b)}};this.ConstructUserUrl=function(e,c,b){var a=C_WEB_HOSTNAME.format(e);if(b!=null){var d="http://{0}{1}?{2}";return d.format(a,c,b)}else{var d="http://{0}{1}";return d.format(a,c)}};this.ConstructDashboardUrl=function(b,a){if(a!=null){var c="http://{0}{1}?{2}";return c.format(C_DASHBOARD_HOSTNAME,b,a)}else{var c="http://{0}{1}";return c.format(C_DASHBOARD_HOSTNAME,b)}};this.GetDomainSetterProxyUrl=function(){var a=document.location.href,b=a.indexOf(document.domain);if(b>0)a=a.substring(0,b+document.domain.length);a=a+"/setdomain.htm";return a};this.ConstructUserUrlFromCid=function(e,d,c){var b="cid-{0}",a=function(c){var d="0123456789ABCDEF",h=0;if(c.charAt(0)=="-"){h=1;c=c.substr(1,c.length-1)}var a="";while(c!=""){var e="",f=0;for(var b=0;b<c.length;b+=1){var j=d.indexOf(c.charAt(b))+10*f,k=Math.floor(j/16);f=j%16;if(k!=0||e.length>0)e+=d.charAt(k)}c=e;a=d.charAt(f)+a}while(a.length<16)a="0"+a;if(h!=0){for(var b=a.length-1;b>=0;b--)a=a.substr(0,b)+d.charAt(15-d.indexOf(a.charAt(b)))+a.substr(b+1,a.length-b-1);var i=1;for(var b=a.length-1;b>=0;b--){var g=d.indexOf(a.charAt(b))+i;if(g>15)g-=16;else i=0;a=a.substr(0,b)+d.charAt(g)+a.substr(b+1,a.length-b-1)}}return a};return SpacesUrlBuilder.ConstructUserUrl(b.format(a(e)),d,c)}};GetCookieValue=function(c){var d="",b=document.cookie.indexOf(c+"=");if(b!=-1){var a=document.cookie.indexOf(";",b);if(a==-1)a=document.cookie.length;d=document.cookie.substring(b+c.length+1,a)}return d};$Spaces.registerAllBaseMethods=function(c,a){for(var b in a)if("function"==typeof a[b])c.registerBaseMethod(a,b)};$Spaces.bindIfNotBound=function(a,d,e,f){var b=null;if(a.webBindings)for(var c=0;c<a.webBindings.length;c++)if(a.webBindings[c].getType()==d){b=a.webBindings[c];break}if(!b)b=Web.Bindings.attachElementBindingSync(a,d,null,e?e:{},f);return b};$Spaces.MessengerNavigate=function(a){if(typeof __IdCtrlNs!=undefined&&__IdCtrlNs.Utility&&__IdCtrlNs.Utility.OpenWindow)__IdCtrlNs.Utility.OpenWindow(a)};PathUtility=new function(){this.MapPathType={};this.MapPathType.Image="image";this.MapPathType.Css="css";this.MapPathType.Script="script";this.MapPathType.XML="xml";this.MapPathServerType={};this.MapPathServerType.SpacesWeb="SpacesWeb";var c=false,d=true,a=null,b=null;function f(){try{var f=" ".charCodeAt(0)}catch(g){d=false}a=[];for(var e=0;e<C_STATIC_CONTENT_SERVER_COUNT;e++)a[e]=C_STATIC_CONTENT_URL_FORMAT.replace("{0}",e+1);if(C_STATIC_IMAGES_URL_FORMAT&&C_STATIC_IMAGES_URL_FORMAT.length>0){b=[];for(var e=0;e<C_STATIC_CONTENT_SERVER_COUNT;e++)b[e]=C_STATIC_IMAGES_URL_FORMAT.replace("{0}",e+1)}else b=a;c=true}this.MapPath=function(g,i,d,h){if(!c)f();var b=null;if(h!=null)b=h.toLowerCase();var a=e(g,b);switch(i.toString()){case this.MapPathServerType.SpacesWeb.toString():a+="Web";break;default:alert("Unexpected MapPathServerType")}if(d!=null){if(d!=""||d[0]!="/")a+="/";a+=d}if(a[a.length-1]!="/")a+="/";switch(g.toString()){case this.MapPathType.Image.toString():a+="images";if(Spaces.IsRTL())a+="/rtl";break;case this.MapPathType.Css.toString():a+="css";break;case this.MapPathType.Script.toString():a+="script";break;case this.MapPathType.XML.toString():a+="xml"}if(b==null||b.length==0||b[0]!="/")a+="/";if(b!=null)a+=b;return a};function e(h,e){var c=h.toString()==PathUtility.MapPathType.Image.toString()?b:a,f=c[C_STATIC_CONTENT_DEFAULT_INDEX];if(e!=null&&d==true){var i=Math.abs(g(e))%C_STATIC_CONTENT_SERVER_COUNT;f=c[i]}return f}function g(b){if(b==null)return 0;var d=b.length,a=0;for(var c=0;c<d;c++)a=a^b.charCodeAt(c);return a}this.GetFetchUrlService=function(c,b){var a=C_FETCH_URL_SERVICE.format(b,c.encodeURI());if($Request.extractHost(C_FETCH_URL_SERVICE).indexOf(document.location.host)==0)return a+"&nocache="+Math.random();else return this.GetProxyUrlService(a)+"&nocache="+Math.random()};this.GetProxyUrlService=function(a){return $Request.extractHost(document.location,true)+"/pr.aspx?url="+a.encodeURI()}};Live_Spaces_Ads=function(e,a){Live_Spaces_Ads.initializeBase(this,arguments);a=this.getParameters();var b=this,g=0,c;this.id=e.id;this.initialize=function(){Live_Spaces_Ads.callBaseMethod(this,"initialize",arguments);if(a.refreshperiod){m_iRefreshPeriod=a.refreshperiod;if(a.refreshstart&&a.refreshstart==1)b.startTimedRefresh()}$Network.registerBaseDomain();if(typeof dapMgr!="undefined"){dapMgr.enableACB(e.id,false);dapMgr.renderAd(e.id,a.callstring,a.width,a.height)}};this.dispose=function(){b=null;Live_Spaces_Ads.callBaseMethod(this,"dispose",arguments)};this.refresh=function(){b.stopTimedRefresh();d();b.startTimedRefresh()};this.refreshOnce=function(){b.stopTimedRefresh();d()};this.setRefreshPeriod=function(a){if(a!=m_iRefreshPeriod){m_iRefreshPeriod=a;b.startTimedRefresh()}};this.stopTimedRefresh=function(){if(c){clearTimeout(c);c=null}};this.startTimedRefresh=function(){if(m_iRefreshPeriod>0)c=setTimeout(f,m_iRefreshPeriod*1000);else b.stopTimedRefresh()};this.isHeaderBanner=function(){if(b.id=="dap_header")return true;else return false};var f=function(){d();c=setTimeout(f,m_iRefreshPeriod*1000)},d=function(){if(!($Browser.isIE()&&window.navigator.appVersion.toLowerCase().indexOf("msie 6")>=0))if(typeof dapMgr!="undefined")dapMgr.trackEvent(eventType.click)}};Live_Spaces_Ads.Params=new $Enum("callstring","width","height","refreshperiod","refreshstart");Live_Spaces_Ads.registerClass("Live_Spaces_Ads","$Binding");Live_Spaces_Ads.skipClass=true;if(typeof Web!="undefined"&&Web&&Web.Bindings){registerNamespace("Spaces.Utility");Spaces.Utility.GetString=function(a,b){if(a)if(a[b])return a[b];return ""};Spaces.Utility.GetLtrString=function(a){return "\u202d"+a+"\u202c"};Spaces.Utility.JScriptStringEscape=function(b){var a=b;a=a.replace(/\\/g,"\\\\");a=a.replace(new RegExp("/","g"),"\\/");a=a.replace(/</g,"\\x3C");a=a.replace(/>/g,"\\x3E");a=a.replace(/'/g,"\\x27");a=a.replace(/\"/g,"\\x22");a=a.replace(/\r/g,"\\r");a=a.replace(/\n/g,"\\n");a=a.replace(/\t/g,"\\t");return a}}if(typeof Web!="undefined"&&Web&&Web.Bindings){registerNamespace("Spaces.Lists");registerNamespace("Spaces.PopOvers");var g_currSimplePopover;function ComplexDialogData(e,c,b,g,f,d,a){if(a==null)a=false;this.LabelArray=e;this.DefaultsArray=c;this.DialogItemDetails=b;this.BtnOk=g;this.BtnCancel=f;this.LimitsArray=d;this.LabelsHtmlSafe=a}function SimpleDialogData(f,c,d,b,a,g,e){return new ComplexDialogData([f,d],[c,b],a,g,e)}Spaces.PopOvers.SimplePopOver=function(b,f,e,a,g,d,c){Spaces.PopOvers.SimplePopOverWithCancelCB(b,f,e,a,g,null,d,c)};Spaces.PopOvers.SimplePopOverWithCancelCB=function(c,o,a,p,n,g,e,f){if(typeof Spaces=="undefined"||typeof Spaces.Controls=="undefined"||typeof Spaces.Controls.Popover=="undefined")return;var b=new Spaces.Controls.Popover,d=document.getElementById("SpacesPopOversSimplePopOver");if(d==null){d=document.createElement("div");d.id="SpacesPopOversSimplePopOver";g_currSimplePopover=b;document.body.appendChild(d)}var q=[];function l(){if(e){var i=e,g=e;for(var l=0;l<10;l++){if(g.tagName.toLowerCase()=="a"){i=g;break}if(g.parentElement)g=g.parentElement}}k();if(f)b.width=f;else b.width=400;b.header=o;b.body=d;g_currSimplePopover=b;var p=a.BtnOk?a.BtnOk:Spaces.Utility.GetString(Spaces.Common.Strings,"global_ok"),n=a.BtnCancel?a.BtnCancel:Spaces.Utility.GetString(Spaces.Common.Strings,"global_cancel");if(a.BtnOk!=false)b.addButton("ok",p,true,false);if(a.BtnCancel!=false)b.addButton("cancel",n,false,true);j();b.show(m,i);h();if(c=="TitleTaglineCustomization")tnt_GetPreview(a.DefaultsArray)}function k(){var e="";if(a.DialogItemDetails)e='<div style="margin-bottom:10px">'+a.DialogItemDetails+"</div>";var b="";if(c=="Confirmation")b='<div id="pvrLabel1"></div>';else if(c=="Message")b='<b><div id="pvrLabel1"></div></b>';else if(c=="ChangeAd"){b='<label id="pvrLabel1" for="pvrValue1"></label>'+'<div class="InputWrapper" style="border-style:solid"><input id="pvrValue1" name="checkbox" type="text" onkeyup="Spaces.PopOvers.SimplePopOver.ValidateTextboxInput()" /></div>'+'<label id="pvrLabel2" for="pvrValue2"></label>'+'<div class="InputWrapper" style="border-style:solid"><input id="pvrValue2" name="checkbox" type="text" onkeyup="Spaces.PopOvers.SimplePopOver.ValidateTextboxInput()"/></div>';if(a.DefaultsArray[2]=="true")b+='<input id="pvrValue3" type="checkbox" checked="CHECKED" /><label for="pvrValue3" id="pvrLabel3"></label>';else b+='<input id="pvrValue3" type="checkbox" /><label for="pvrValue3" id="pvrLabel3"></label>'}else if(c=="AddOrEditList")var b='<label id="pvrLabel1" for="pvrValue1"></label>'+'<div class="InputWrapper" style="border-style:solid; margin-bottom:4px"><input id="pvrValue1" name="checkbox" type="text" onkeyup="Spaces.PopOvers.SimplePopOver.ValidateTextboxInput()" /></div>'+'<label id="pvrLabel2" for="pvrValue2"></label>'+'<div class="InputWrapper" style="border-style:solid"><input id="pvrValue2" name="textbox" type="text" /></div>';else if(c=="NameDropDown")var b='<label id="pvrLabel1" for="pvrValue1"></label>'+'<div class="InputWrapper" style="border-style:solid; margin-bottom:10px"><input id="pvrValue1" name="checkbox" type="text" onkeyup="Spaces.PopOvers.SimplePopOver.ValidateTextboxInput()" /></div>'+'<label id="pvrLabel2" for="pvrValue2"></label>'+'<div class="InputWrapper" style="border-style:solid; margin-bottom:10px""><input id="pvrValue2" name="textbox" type="text" /></div>'+'<label id="pvrLabel3" for="pvrValue3"></label>'+'<div class="InputWrapper" style="border-style:none;padding-bottom:0px"><select id="pvrValue3">'+'    <option value="links">'+Spaces.Utility.GetString(Spaces.Lists.Strings,"mainnav_Links")+"</option>"+'    <option value="booklist">'+Spaces.Utility.GetString(Spaces.Lists.Strings,"mainnav_Booklist")+"</option>"+'    <option value="friendslist">'+Spaces.Utility.GetString(Spaces.Lists.Strings,"mainnav_FriendList")+"</option>"+'    <option value="movielist">'+Spaces.Utility.GetString(Spaces.Lists.Strings,"mainnav_Movielist")+"</option>"+"</select></div>";else if(c=="SingleNameValue")var b='<label id="pvrLabel1" for="pvrValue1"></label>'+'<div class="InputWrapper" style="border-style:solid"><input id="pvrValue1" name="checkbox" type="text" onkeyup="Spaces.PopOvers.SimplePopOver.ValidateTextboxInput()" /></div>';else if(c=="TitleTaglineCustomization")var b=GetTitleTagline();else var b="";d.innerHTML=e+b}var m=function(d,c){var a=true;if(c=="ok"){var e=i(),f=n({obj:e,Popover:d});if(f==false)a=false}if(c=="cancel")if(!!g)g();if(a){b=null;g_currSimplePopover=null}return a};function j(){if(a.LabelArray!=null)for(var b=0;b<a.LabelArray.length;b++)if(document.getElementById("pvrLabel"+(b+1))!=null)if(a.LabelsHtmlSafe)document.getElementById("pvrLabel"+(b+1)).innerHTML=a.LabelArray[b];else document.getElementById("pvrLabel"+(b+1)).innerText=a.LabelArray[b];if(a.DefaultsArray!=null)for(var b=0;b<a.DefaultsArray.length;b++){var c=document.getElementById("pvrValue"+(b+1));if(c!=null)if(c.type=="checkbox"){if(a.DefaultsArray[b]=="true")c.checked=true}else c.value=a.DefaultsArray[b]}if(a.LimitsArray!=null)for(var b=0;b<a.LimitsArray.length;b++)if(document.getElementById("pvrValue"+(b+1))!=null)document.getElementById("pvrValue"+(b+1)).maxLength=a.LimitsArray[b]}function h(){if(document.getElementById("pvrValue1")!=null)Spaces.PopOvers.SimplePopOver.ValidateTextboxInput()}function i(){var a,e={};e.Action="NameValueReturn";for(a=1;true;a++)if(document.getElementById("pvrValue"+a)==null)break;a=a-1;var d=new Array(a),c;for(var b=0;b<a;b++){c=document.getElementById("pvrValue"+(b+1));if(c.type=="checkbox")if(c.checked==true)d[b]="true";else d[b]="false";else d[b]=c.value}e.ReturnValues=d;return e}l()};Spaces.PopOvers.SimplePopOver.ValidateTextboxInput=function(){if(!g_currSimplePopover)return;var c=false,a=Spaces.PopOvers.SimplePopOver.GetCheckboxes();if(!a)return;for(var b=0;b<a.length;b++)if(""==a[b].value&&a[b].getAttribute("name")=="checkbox"){g_currSimplePopover.disableButton("ok");c=true;break}if(!c)g_currSimplePopover.enableButton("ok")};Spaces.PopOvers.SimplePopOver.GetCheckboxes=function(){var a=document.getElementById("SpacesPopOversSimplePopOver");if(a)var b=a.getElementsByTagName("INPUT");return b};Spaces.PopOvers.SimplePopOver.MsgBox=function(g,h,b,e,i){var a=Spaces.PopOvers.SimplePopOver.MsgBox.Buttons,d=null,c=null;if(b==a.Ok)c=false;else if(b==a.DeleteCancel)d=Spaces.Utility.GetString(Spaces.Common.Strings,"global_delete");var f=new SimpleDialogData(null,null,null,null,h,d,c);Spaces.PopOvers.SimplePopOver(null,g,f,null,i,e)};Spaces.PopOvers.SimplePopOver.MsgBox.Buttons=$Enum("Ok","OkCancel","DeleteCancel")}if(typeof Web!="undefined"&&Web&&Web.Bindings){registerNamespace("Network.Notes");Network.Notes.Current=null;Network.Notes.Hide=function(){if(Network.Notes.Current){Network.Notes.Current.hide();Network.Notes.Current=null}};Network.Notes.Show=function(f,h,d){Network.Notes.Hide();var g=d,c=event.srcElement,e=f.getDisplayName(),b=document.createElement("div");document.body.appendChild(b);b.innerHTML='<div class="SNNotesDlgContainer">'+"<b>"+e.encodeHtml()+"</b>"+"<hr />"+g+"</div>";var a=new Web.UI.Dialog;a.autoCalc=false;a.setContents(b);a.setDock(Web.UI.Popup.VDock.Bottom,Web.UI.Popup.HDock.Left);a.setAnchor(Web.UI.Popup.VAnchor.Top,Web.UI.Popup.HAnchor.Left);a.setPadding(1,0);a.dockTo(c,0,true);a.getContents().style.zIndex=10000010;if($Browser.isIE()&&$Browser.version>=7||!$Browser.isIE())new Web.UI.ShadowPopup(a);a.recalc(true);a.show();Network.Notes.Current=a}}