/* Copyright (C) 2008 Microsoft Corporation */registerNamespace("$UI.Editor");$UI.Editor=function(B,t){var z=$UI.Editor;z.initializeBase&&z.initializeBase(this,arguments);B=B||null;t=this.getParameters?this.getParameters():t||{};var G=live.shared.strings,r=live.shared.globalsettings.rte,a=this;if(!B.currentStyle)B.currentStyle=$UI.getCurrentStyle(B);var Lb=t.basepath||"",i=t,q=$Utils.createElement,cb=$Utils.cancelEvent,j=$Browser.isMozilla()||!$Browser.isIE(),o=$Browser.isIE(),O=$Utils.css,y=$UI.isRTL(),b=B,w=true,g=document,V=false,k="",m=null,Gb="200",jb=C(i.nofollow),W=i.value||"",l,v,c,e,f,d,n,p;i.singlespacing=C(i.singlespacing);if(!this.fire){$Mini.addEventHandler(this);window.attachEvent("onunload",Z)}var ab={area:"uxp_rte_area",editor:"uxp_rte_editor",toolbar:"uxp_toolbar",nothing:""};this.initialize=function(a){a=a||null;Ob();Hb();Kb();v=q({tagName:"DIV",style:{display:"none"}});l.appendChild(v);if(!C(i.notoolbar))ub();if(z.getBaseMethod)try{var b=z.getBaseMethod(this,"initialize");if(b&&b.call)b.call(this,a)}catch(c){}};this.dispose=function(b){Z(b);if(z.getBaseMethod){var a=z.getBaseMethod(this,"dispose");if(a&&a.call)a.call(this,b)}};function Ob(){p={offsetWidth:b.offsetWidth,width:i.width||(o?b.currentStyle.width:b.style.width),height:i.height||(o?b.currentStyle.height:b.style.height)};p.width+="";p.height+="";if(p.height=="auto")p.height=b.style.height=Gb;if(b.currentStyle&&b.currentStyle.height=="auto"||b.style&&b.style.height=="")b.style.height=parseInt(p.height,10)+(o?5:0)+"px";p.height=rb(p.height);p.width=rb(p.width);O.add(b,"uxp_rteform")}function rb(a){if(!(a=="auto"||a.endsWith("px")||a.endsWith("%")))a+="px";return a}function X(){var b=a.getEditRegion();b.attachEvent("onkeydown",N);b.attachEvent("onkeyup",N);b.attachEvent("onmouseup",gb);b.attachEvent("onkeyup",mb);b.attachEvent("onclick",M);b.attachEvent("oncontextmenu",M);b.attachEvent("onblur",F);window.attachEvent("onbeforeunload",F);window.attachEvent("onresize",Q);if(j)e.attachEvent("onmouseup",a.getSelection)}function Z(){O.remove(b,"uxp_rteform");var d=V?g:c;if(d){d.detachEvent("onkeydown",N);d.detachEvent("onkeyup",N);d.detachEvent("onmouseup",gb);d.detachEvent("onkeyup",mb);d.detachEvent("onclick",M);d.detachEvent("oncontextmenu",M);d.detachEvent("onblur",F)}window.detachEvent("onbeforeunload",F);window.detachEvent("onresize",Q);window.detachEvent("onunload",Z);if(c)c.detachEvent("onmouseup",eb);if(e)e.detachEvent("onmouseup",a.getSelection);if(j&&c.detachEvent)c.detachEvent("onmousedown",I);if(n)n.element=null;v=k=B=t=null;L=e=c=null;b=l=null}function gb(){I(true)}var pb=200,qb=0;function xb(){var a=(new Date).getTime()-qb;if(a>=pb)I(true)}function mb(){qb=(new Date).getTime();window.setTimeout(xb,pb)}this.getEditRegion=function(){return V?g:c};function C(a){var b=a=="true"||a=="1"||a===true;return b}function Hb(){l=q({tagName:"DIV",className:ab.area,style:{}});if(parseInt(p.width,10))l.style.width=p.width;b.obj=a;b.parentNode.insertBefore(l,b);b.style.display="none";b.style.clear="both";b.focus=a.Redisplay}function S(){try{if(g)if(document.domain==location.host||bb){g.designMode="on";g.designMode="off";g.designMode="on";g.body.innerHTML=k;T(false);e.detachEvent("onload",S);X()}else kb()}catch(a){}}var u,L,bb=false;this._InitFireFox=function(a){yb(a);X()};function yb(a){bb=true;e.attachEvent("onload",S);doc=a.document;var d="<style>html,body{background:white;color:black;{0}}</style>".format(y?"direction:rtl;":""),b=["<HTML><HEAD>",d,'</HEAD><BODY class="">'+k+"</BODY></HTML>"].join("");doc.write(b);doc.selection={};doc.selection.clear=function(){a.getSelection().deleteFromDocument()};doc.selection.empty=function(){a.getSelection().removeAllRanges()};doc.selection.createRange=function(){return a.getSelection().getRangeAt(0)};c=doc.body;g=doc;u=a;u.attachEvent=c.attachEvent=g.attachEvent=a.attachEvent;u.detachEvent=c.detachEvent=g.detachEvent=a.detachEvent;$UI.Bar.updateDocument(g);window.attachEvent("onunload",function(){$UI.Bar.updateDocument(g,true)})}function Cb(){var a,b;k=k==""?"<br>":k;if(!e){e=fb("IFRAME");e.unselectable="on";e.style.width="100%";V=true}e.innerHTML="";e.style.margin=e.style.padding="0px";if(document.domain==location.host){e.attachEvent("onload",S);b=e.contentWindow;a=b.document;var f="<style>html,body{background:white;color:black;{0}}</style>".format(y?"direction:rtl;":""),d=["<HTML><HEAD>",f,'</HEAD><BODY class=""></BODY></HTML>'].join("");a.open("text/html");a.write(d);window.setTimeout(function(){a.close()},1);u=b;a.selection={};a.selection.clear=function(){b.getSelection().deleteFromDocument()};a.selection.empty=function(){b.getSelection().removeAllRanges()};a.selection.createRange=function(){return b.getSelection().getRangeAt(0)};c=a.body;g=a;u.attachEvent=c.attachEvent=g.attachEvent=window.attachEvent;u.detachEvent=c.detachEvent=g.detachEvent=window.detachEvent}}function fb(c){var a=q({tagName:c,className:ab.editor,style:{height:p.height}});l.appendChild(a);l.appendChild(b);if(j){L=q({tagName:"A",href:"#",innerHTML:"&nbsp;",onclick:"return false",style:{position:"absolute",width:"1px",height:"1px",textDecoration:"none"}});l.appendChild(L)}return a}function kb(){t.rootdir=t.rootdir||"";var b=z._FFCallbackCount.length;z._FFCallbackCount[b]=a;var c=t.rootdir+"/xloader.htm#domain="+escape(document.domain)+"&callback=$UI.Editor._FFCallback&design=on&args="+b;e.contentWindow.location=c}function Kb(){k=W==""?b.value:W;function d(){e=c=fb("DIV");c.contentEditable=true;c.id=c.name="uxp_rte";c.style.textAlign=y?"right":"left";if($Browser.isOpera()){c.style.zIndex=1;c.style.position="relative"}if(t.height!="auto")c.style.overflow="auto";if(b&&b.value!="")k=K(b.value);if(P()&&k.trim()=="")k="<DIV></DIV>";c.innerHTML=k}function a(){if(C(i.focus))x(true)}if(j){Cb();if(document.domain!=location.host)kb()}else{d();window.setTimeout(a,0);X()}}function P(){return !j&&(C(t.singlespacing)||t.spacing==="single")}this.Redisplay=function(){if(a.isRTEMode()){if(j)g.designMode="on";x()}};var D={map:{b:"bold",i:"italic",u:"underline"},codes:{b:66,i:73,u:85,enter:13,tab:9},getKey:function(c){var b=null;for(var a in this.codes)if(c.keyCode==this.codes[a]){b=a;break}return b},isKey:function(a,b){return this.codes[a.toLowerCase()]==b.keyCode}};function M(a){a=a||event;var b=a.srcElement||a.target;if(b.tagName=="IMG"&&!a.ctrlKey){Db(b);cb(a);return false}}function N(b){b=b||event;var c=false,e=b.srcElement||b.target;if(a.isRTEMode()){var d=e.tagName=="HTML"&&!b.ctrlKey&&!b.shiftKey&&D.isKey("tab",b)&&!C(i.notoolbar);switch(b.type){case "keydown":if(j){if(b.ctrlKey&&D.map[D.getKey(b)]){a.execCmd(D.map[D.getKey(b)]);c=true}if(d){L.focus();c=true}}if(b.ctrlKey&&D.isKey("tab",b)){if(b.shiftKey);c=true}break;case "keyup":if(j)if(d)c=true;if(o&&D.isKey("enter",b))c=true;if(b.shiftKey)a.getSelection(b)}}return c?cb(b):true}this.execCmd=lb;this.queryCommand=function(d){var c=false;if(a.isRTEMode()){var b=a.getExecElement();if(b)try{c=b.queryCommandState(d)}catch(e){}}return c};this.queryCommandValue=function(d){var c="";if(a.isRTEMode()){var b=a.getExecElement();if(b)try{c=b.queryCommandValue(d)}catch(f){var e=f.description||f.message}}return c};this.isDirty=function(){return this.getValue()!=k};this.getSelection=function(){if(a.isRTEMode()){try{m=g.selection.createRange();m.type=g.selection.type}catch(d){}a.fire("onselectionchanged")}else b.focus();return m};this.getCurrentSelection=function(){var b=m||a.getSelection();return b};this.setSelection=function(){if(a.isRTEMode()){x();a.getSelection();if(o)m.select()}return m};this.getExecElement=function(){var a=g,b=j?false:m&&(m.type&&m.type!="None"||m.type=="Text"&&m.text!="");if(w&&b)a=m;return a};this.getValue=function(){var a=w?c.innerHTML:K(b.value);return U(a)};this.setValue=function(e){var d=U(K(e));if(P())d="<DIV>"+d+"</DIV>";else if(j)d+=" <br/>";k=W=c.innerHTML=b.value=d;x(true);a.getSelection()};this.insertHTML=function(a){if(w){var b=U(K(a));c.focus();Pb(b);F()}};this.isRTEMode=function(){return w};this.getToolbar=function(){return n};this.setFocus=x;function K(b){var a;a=q("div");a.innerHTML=b;return a.innerHTML}function T(a){try{g.execCommand("styleWithCSS",false,a)}catch(b){}}function lb(d,b,e){b=b||null;var f=e||a.getExecElement(),c=j&&d.toLowerCase()=="hilitecolor";if(c)T(true);try{f.execCommand(d,false,b)}catch(h){var g=h.description||h.message}if(c)T(false)}function F(){if(w&&b)b.value=a.getValue()}function x(e){if(a.isRTEMode())if(document.body.createTextRange){try{c.focus()}catch(f){}if(e){var d=document.body.createTextRange();d.moveToElementText(c);d.collapse(true);d.select()}}else u.focus();else b.focus()}function U(b){if(i.striptags||i.stripattribs){var a=b;if(i.striptags)a=Rb(a,i.striptags);if(i.stripattribs)a=Mb(a,i.stripattribs);return a}return b}function Rb(b,a){if(a){var c=new RegExp("</?\\s*(?:"+a+")/*(?:\\s+[^>]*>|>)","gim");return b.replace(c,"")}else return b}function Mb(a,c){var d=new RegExp("(<[^>]*?)\\s(?:"+c+")=(?:(['\"])[^>]*?\\2|[^\\s>]*)([^>]*?>)","gim"),b;do{b=a.length;a=a.replace(d,"$1$3")}while(b!=a.length);return a}function H(e,b){var c=b=="getUpdate",d=c?$UI.BarItem.States.normal:$UI.BarItem.States.select;return a.isRTEMode()?d:$UI.BarItem.States.disabled}function s(b){function c(){var c=a.queryCommand(b)?"select":"normal";return a.isRTEMode()?c:"disabled"}return c}function h(d,c){function b(){a.setSelection();lb(d,c);I(true);return true}return b}function I(c){if(n&&n.col){if(c)a.getSelection();for(var b in n.col.items)n.col.items[b].update()}}function Eb(a){var b=function(){var b=h("FormatBlock",a);b();return "hide"};return b}function Jb(a){var b=function(){var b=h("FontSize",a+"");b();return "hide"};return b}function Ib(a){var b=function(){var b=h("FontName",a);b();return "hide"};return b}function Nb(a){a.hide()}function Pb(b){if(j){var c=a.getCurrentSelection();Y(q({tagName:"SPAN",innerHTML:b}),null)}else Y(null,b)}function hb(b,a){Y(b,null,a)}function Y(d,e,f){var b=f?f:a.getCurrentSelection();if(b.insertNode){if(e)d=document.createTextNode(e);b.deleteContents();b.insertNode(d);b.selectNode(d);b.collapse(false);u.focus()}else{var g=e?e:d.outerHTML;c.focus();if(b.pasteHTML)try{b.pasteHTML(g);b.select()}catch(h){}}}function nb(i,e,f,h){c.focus();var d,b=a.getCurrentSelection(),g=!(b.collapsed||b.text=="");if(jb)f=true;d=q({tagName:"A",href:i,innerHTML:e,rel:f?"nofollow":null});if(h)d.target="_blank";if(g&&(e==null||e==""))if(j)d.appendChild(b.extractContents());else{var k=new RegExp("</?\\s*(?:A)/*(?:\\s+[^>]*>|>)","gim");d.innerHTML=b.htmlText.replace(k,"");b.text=""}hb(d,b)}function Sb(a,b,e,d,h){e=e||false;a=a?a.trim():null;b=b?b:a;d=d||false;var g=["feed:","msnim:","http:","https:","mailto:","ftp:","mms:","/"],c=a!=""&&a!=null&&b!=null;if(c)for(var f=0;f<g.length;f++)c=c||a.toLowerCase().startsWith(g[f]);if(c)nb(a,b,e,d);if(h)h.hide()}function ib(b){var c=null;if(!b)b=a.getCurrentSelection();try{c=b.startContainer?b.startContainer.parentNode:b.parentElement()}catch(d){c=null}return c}function ob(a,d){var b=null;while(a&&a!=c&&!b)if(d(a))b=a;else a=o?a.parentElement:a.parentNode;return b}function wb(a){return a.tagName=="FONT"&&a.size}function vb(a){return a.tagName=="FONT"&&a.face&&a.face.length>0||a.tagName=="SPAN"&&a.style&&a.style.fontFamily}function Qb(a){return a.tagName=="A"}function Fb(b){var a=b.tagName,c=a=="ADDRESS"||a=="H1"||a=="H2"||a=="H3"||a=="P";return c}function R(c,d){var b=null,a=null,e=ib();a=ob(e,c);if(a)b=d(a);return b}function zb(b){var a=null;a=ob(b,Qb);return a}var A=[];function Bb(){var m=new $UI.Bar("vertical"),s=["smile_regular","smile_teeth","smile_wink","smile_omg","smile_tongue","smile_shades","smile_angry","smile_confused","smile_embaressed","smile_sad","smile_cry","smile_sniff","smile_angel","smile_baringteeth","smile_nerd","smile_sick","smile_party","smile_yawn","smile_thinking","smile_zipit","smile_secret","smile_sarcastic","smile_eyeroll","heart","heart_broken","messenger","cat","dog","snail","blacksheep","moon","star","sun","rainbow","hug_dude","hug_girl","kiss","rose","rose_wilted","clock","present","cake","camera","lightbulb","coffee","phone","mobile","car","airplane","computer","money","film","music_note","pizza","soccerball","envelope","guy_handsacrossamerica","girl_handsacrossamerica","island","umbrella"],t=10,f=q("span",{className:"uxp_emote_menu"}),b=q("DIV",{className:"uxp_emote_highlight",style:{position:"absolute",width:"23px",height:"23px",display:"none"}}),e=q({tagName:"img",src:J(r.emote.url+r.emote.map),width:"282",height:"181",border:0,useMap:"#emomap",onselectstart:function(){return false},ondragstart:function(){return false},onmousedown:function(){return false}}),i=document.createElement("map");i.id="emomap";i.name="emomap";var z=Math.ceil(s.length/t),n=9,h=0,g=0,x=J(r.emote.url),p="",d=19,w=r.emote.labels.split(",");for(var k=0;k<z;k++){h=6;for(var j=0;j<t;j++){if(g>=s.length)break;p=w[g]!=null?w[g]:"";var l=q({tagName:"area",shape:"rect",coords:j*d+h+","+(k*d+n)+","+(j*d+h+25)+","+(k*d+n+23),x:j*d+h,y:k*d+n,name:x+s[g]+".gif",alt:p,title:p,tabIndex:0,onmouseover:function(a){a=a||event;if(o){if(y)b.style.right=-(this.x-e.width+24)+"px";else b.style.left=this.x+1+"px";b.style.top=this.y+"px";b.style.display="block";b.style.backgroundColor="transparent"}}});l.onclick=u;l.onkeyup=u;A.push(l);i.appendChild(l);g++;h+=8}n+=9}f.appendChild(e);f.appendChild(i);f.appendChild(b);var v=new $UI.BarItem($UI.BarItem.Types.menu,"emoteMenu","",f,null,null,null,function(){return true},null,false);m.appendItem(v);function u(b){b=b||event;if(b.type=="keyup"&&b.keyCode!=13)return;var d=b.srcElement||b.target,e,f;c.focus();a.getSelection();if(document.activeElement&&document.activeElement.tagName=="AREA")e=document.activeElement.getAttribute("name");else if(d.tagName=="AREA"){e=d.getAttribute("name")||d.name;f=d.getAttribute("alt")||d.alt}if(e!="")hb(q({tagName:"IMG",alt:f,title:f,src:e,style:{verticalAlign:"middle"}}));m.hide()}function B(){var a;while(A.length>0){a=A.length-1;A[a].onclick=A[a].onmouseover=A[a].onkeyup=null;A.pop()}e.onselectstart=e.ondragstart=e.onmousedown=null;v=f=e=i=b=null}m.attachEvent("ondispose",B);return m}function Ab(){return a.isRTEMode()?$UI.BarItem.States.normal:$UI.BarItem.States.select}function db(f){f=f||false;var d=b.style,g=c.style;if(w&&!f){F();w=false;g.display="none";n.hideSubElement();if(e)e.style.display="none";d.display="block";d.visibility="visible";d.width="99.5%";window.setTimeout(function(){try{b.setActive();b.focus();b.tabIndex="0"}catch(a){}},0)}else{var h=a.getValue();w=true;if(e)e.style.display="block";c.innerHTML=h;d.display="none";g.display="block";x();a.getSelection()}I();return w}this.switchEditMode=db;function tb(){var a=function(){db();return true};return a}function sb(){f=new $UI.Bar("horizontal");var b=f.appendItem,e=$UI.BarItemButton,a=new Image;a.src=J(r.toolbar.map);var h=400-6*16,g="imagebar",i=r.imagebar.split(",");b(new e("u_imglt",i[0],a,new d(h,0,16,16),null,E("lt"),g));var j=h+=16;b(new e("u_imgrt",i[2],a,new d(h+=16,0,16,16),null,E("rt"),g));b(new e("u_imgtp",i[3],a,new d(h+=16,0,16,16),null,E("tp"),g));b(new e("u_imgmd",i[4],a,new d(h+=16,0,16,16),null,E("md"),g));b(new e("u_imgbt",i[5],a,new d(h+=16,0,16,16),null,E("bt"),g));b(new e("u_imgct",i[1],a,new d(j,0,16,16),null,E("ct"),g));f.element.style.position="absolute";f.element.style.zIndex=101;f.element.style.display="none";f.hideFloat=true;O.add(f.element,"uxp_imagebar");c.attachEvent("onmouseup",eb);document.body.appendChild(f.element)}function E(a){var b=function(){var b=f.sourceImg;if(b){b.style.verticalAlign="";b.align="";switch(a){case "lt":b.align="left";break;case "ct":b.style.verticalAlign="middle";break;case "rt":b.align="right";break;case "tp":b.style.verticalAlign="top";break;case "md":b.style.verticalAlign="middle";break;case "bt":b.style.verticalAlign="bottom"}}f.hide()};return b}function Q(){if(f&&f.sourceImg){f.setVis(false);var a=$UI.getLocation(f.sourceImg)-f.element.offsetHeight;if(j){var b=$UI.getLocation(e);a.top+=b.top;a.left+=b.left}f.setVis(true);f.element.style.left=a.left+"px";f.element.style.top=a.top+2+"px"}}function Db(a){if(!f)sb();f.sourceImg=a;Q();f.show()}function eb(){f.hide()}function ub(){d=function(a,b,d,c){var e={left:a,x:a,top:b,y:b,width:d,height:c,right:a+d,bottom:b+c};return e};var e=G.toolbar,mb=r.toolbar,kb=C(i.mini),D=i.showbtns,Z=i.hidebtns,lb="|cut|copy|paste|bold|italic|under|link",b={cut:1,copy:1,paste:1,font:1,size:1,para:1,bold:1,italic:1,under:1,justlt:1,justct:1,justrt:1,ul:1,ol:1,outdent:1,indent:1,link:1,slink:1,hr:1,bgcolor:1,color:1,emote:1,html:1};if(kb)D+=lb;if(Z)b=M(Z,false);if(D)b=M(D,true);function M(f,c){if(c)for(var e in b)b[e]=0;var a=0,d=f.split("|");while(a<d.length){b[d[a]]=c;a++}return b}var p=new Image;p.src=J(mb.map);n=new $UI.Bar("horizontal");var c=0,f=n.appendItem,g=$UI.BarItemButton,E=$UI.BarItemMenu,k=$Utils.createElement;if(u)u.attachEvent("onmouseup",n.captureMouseup);if(!o)b.cut=b.copy=b.paste=0;b.cut?f(new g("u_cut",e.cut,p,new d(c,0,16,16),null,h("cut"),"clipboard")):null;b.copy?f(new g("u_copy",e.copy,p,new d(c+=16,0,16,16),null,h("copy"),"clipboard")):(c+=16);b.paste?f(new g("u_paste",e.paste,p,new d(c+=16,0,16,16),null,h("paste"),"clipboard")):(c+=16);if(b.font){var Q=bb();v.appendChild(Q.element);f(new g("u_font",e.style,null,new d(0,0,0,16),w,q(Q),"Fonts",true,{sizeToText:true}))}if(b.size){var K=cb();v.appendChild(K.element);f(new g("u_fontSize",e.size,null,new d(0,0,0,16),w,q(K),"Fonts",true,{sizeToText:true}))}if(b.para){var T=gb();v.appendChild(T.element);f(new g("u_PSize",e.paragraph,null,new d(0,0,0,16),w,q(T),"Fonts",true,{sizeToText:true}))}var eb=live.shared.marketinfo.rteformaticonsize,db=live.shared.marketinfo.rteformaticonfont,z="<{1} style=\"display:inline;font-family:'"+db+"' !important;font-size:"+eb+';cursor:pointer">{0}</{1}>';b.bold?f(new g("u_bold",z.format(t("bold")[0],t("bold")[1]),null,new d(0,0,0,16),s("bold"),h("bold"),"textformat",false,{sizeToText:true,tip:e.bold})):0;b.italic?f(new g("u_ital",z.format(t("italic")[0],"SPAN"),null,new d(0,0,0,16),s("italic"),h("italic"),"textformat",false,{sizeToText:true,tip:e.italics})):0;b.under?f(new g("u_under",z.format(t("underline")[0],t("underline")[1]),null,new d(0,0,0,16),s("underline"),h("underline"),"textformat",false,{sizeToText:true,tip:e.underline})):0;c+=48;b.justlt?f(new g("u_justlt",e.justifyleft,p,new d(c+=16,0,16,16),s("justifyleft"),h("justifyleft"),"justify")):(c+=16);b.justct?f(new g("u_justcn",e.justifycenter,p,new d(c+=16,0,16,16),s("justifycenter"),h("justifycenter"),"justify")):(c+=16);b.justrt?f(new g("u_justrt",e.justifyright,p,new d(c+=16,0,16,16),s("justifyright"),h("justifyright"),"justify")):(c+=16);b.ol?f(new g("u_ol",e.numberedlist,p,new d(c+=16,0,16,16),s("insertorderedlist"),h("insertorderedlist"),"lists")):(c+=16);b.ul?f(new g("u_ul",e.bulletedlist,p,new d(c+=16,0,16,16),s("insertunorderedlist"),h("insertunorderedlist"),"lists")):(c+=16);var Y=function(){b.indent?f(new g("u_indent",e.increaseindent,p,new d(c+=16,0,16,16),s("indent"),h("indent"),"lists")):(c+=16)},X=function(){b.outdent?f(new g("u_outdent",e.decreaseindent,p,new d(c+=16,0,16,16),s("outdent"),h("outdent"),"lists")):(c+=16)};y?Y():X();y?X():Y();if(b.link){var S=fb();v.appendChild(S.element);f(new g("u_link",e.insertlink,p,new d(c+=16,0,16,16),H,q(S),"links",true))}else c+=16;b.slink?f(new g("u_searchLink",e.insertsearchlink,p,new d(c+=16,0,16,16),H,hb(),"links")):(c+=16);b.hr?f(new g("u_hr",e.insertline,p,new d(c+=16,0,16,16),s("InsertHorizontalRule"),h("InsertHorizontalRule"),"misc")):(c+=16);if(b.bgcolor){var F=L(j?"hilitecolor":"BackColor");v.appendChild(F.element);f(new g("u_bgColor",e.backgroundcolor,p,new d(c+=16,0,16,16),H,q(F),"color",true))}else c+=16;if(b.color){var I=L("ForeColor");v.appendChild(I.element);f(new g("u_fontColor",e.textcolor,p,new d(c+=16,0,16,16),H,q(I),"color",true))}else c+=16;if(b.emote){var N=Bb();v.appendChild(N.element);f(new g("u_emote",e.emoticons,p,new d(c+=16,0,16,16),H,q(N),"",true))}else c+=16;b.html?f(new g("u_html",e.html,null,new d(0,0,0,16),Ab,tb(),e.htmltip,false,{sizeToText:true})):null;function t(a){return r[a].split(",")}function hb(){var b=function(){x();var c="http://search.live.com/results.aspx?q=",b=a.getCurrentSelection();b=o?b.text:b.toString();if(b!=""){var d=c+encodeURI(b);nb(d,null,false,true)}};return b}function w(e,b){var c=b=="getUpdate",d=c?$UI.BarItem.States.normal:$UI.BarItem.States.select;return a.isRTEMode()?d:$UI.BarItem.States.disabled}function q(a){function b(b){n.insertSubItem(a,b,"bl");return true}return b}function L(c){var b=new $UI.Bar("vertical"),a=new $UI.ColorPicker,f=new $UI.BarItem($UI.BarItem.Types.menu,"rte_color"+c,"",a.element,null,null,null,null,null,false);b.appendItem(f);a.oncolor=function(a){h(c,a)();b.hide()};a.onclear=function(){h(c,"")();b.hide()};a.onmore=function(){h(c,d())();b.hide()};function d(d){var a=null;if(!o)throw"Dialog Helper is only supported by IE";else{var b=document.getElementById("UXP_DLGHELPER");if(!b){document.body.insertAdjacentHTML("beforeEnd",'<OBJECT id="UXP_DLGHELPER" CLASSID="clsid:3050f819-98b5-11cf-bb82-00aa00bdce0b" width="0px" height="0px"></OBJECT>');b=document.getElementById("UXP_DLGHELPER")}if(b){a=b.ChooseColorDlg(d);a=a.toString(16);if(a.length<6){var c="000000".substring(0,6-a.length);a=c.concat(a)}a="#"+a}return a}}function e(){a.dispose();a.onclear=a.oncolor=a.onmore=null;a.element=null}b.attachEvent("ondispose",e);return b}function fb(H){var b=G.linkmenu;H=H||false;var d=new $UI.Bar("vertical"),c={linkMenu:"uxp_rte_linkmenu",linkMenuContent:"uxp_rte_linkmenu_content",linkLabel:"uxp_rte_linkmenu_label",linkURL:"uxp_rte_linkmenu_url",linkText:"uxp_rte_linkmenu_text",linkButtonRow:"uxp_rte_linkmenu_buttons",linkMenuLables:"uxp_rte_linkmenu_button_label"},J=["<label class=",c.linkMenuLables,' for="{0}">{1}</label>'].join(""),w=f(c.linkMenu),g=f(c.linkMenuContent),l=f(c.linkButtonRow);l.style.textAlign=y?"left":"right";var e=f(),C=f(c.linkLabel);C.innerHTML=b.dialoglabel;var z=k("TABLE"),r=k("TBODY"),s=k("TR",{className:c.linkText}),D=k("TD"),B=k("TD"),t=k("TR",{className:c.linkURL}),I=k("TD"),F=k("TD"),E=f("");z.appendChild(r);r.appendChild(s);s.appendChild(D);s.appendChild(B);r.appendChild(t);t.appendChild(I);t.appendChild(F);E.appendChild(z);var h=k({tagName:"INPUT",type:"TEXT",id:"rte_linkURL",title:b.urlinfo}),i=k({tagName:"INPUT",type:"TEXT",id:"rte_linkText",title:b.textinfo}),q=k({tagName:"BUTTON",TYPE:"BUTTON",id:"rte_btnInsert",title:G.dialog_insert,innerHTML:G.dialog_insert}),p=k({tagName:"BUTTON",TYPE:"BUTTON",id:"rte_btnCancel",title:G.dialog_cancel,innerHTML:G.dialog_cancel}),n=k({tagName:"INPUT",type:"CHECKBOX",id:"rte_chkNewWindow",title:b.newwindowlabel}),v=k({tagName:"INPUT",type:"CHECKBOX",id:"rte_chkNoFollow",title:b.nofollow});D.innerHTML=J.format("rte_linkText",b.textlabel+b.delimeter);I.innerHTML=J.format("rte_linkURL",b.urllabel+b.delimeter);B.appendChild(i);F.appendChild(h);e.appendChild(n);e.appendChild(k({tagName:"LABEL",htmlFor:"rte_chkNewWindow",innerHTML:b.newwindowlabel}));if(!jb){e.appendChild(k("BR"));e.appendChild(v);e.appendChild(k({tagName:"LABEL",htmlFor:"rte_chkNoFollow",innerHTML:b.nofollow}))}w.appendChild(g);g.appendChild(C);g.appendChild(E);g.appendChild(e);g.appendChild(l);l.appendChild(q);l.appendChild(p);var K=new $UI.BarItem($UI.BarItem.Types.menu,"rte_linkMenu","",w,null,null,null,null,null,false);d.attachEvent("onshow",A);d.appendItem(K);i.onkeypress=h.onkeypress=function(a){a=a||event;if(a.keyCode==13){u();return false}};q.onclick=function(){u();return false};p.onclick=function(){Nb(d);return false};function f(a){return k({tagName:"DIV",className:a,style:{whiteSpace:"nowrap"}})}function u(){Sb(h.value,i.value.encodeHtml(),v.checked,n.checked,d)}function A(e){var g;if(o){g=document.activeElement;x();a.getSelection();g.focus()}var f=y?"http://www":"http://",d=false,b=a.getCurrentSelection(),c=zb(ib(b));if(c){if(b.setStartBefore)b.selectNodeContents(c);else b.moveToElementText(c);m=b;f=c.href;d=c.target=="_blank"}var k=o?b.text:b;n.checked=d;i.value=k;h.value=f;e&&j?e.element.focus():0}function L(){d.detachEvent("onshow",A);q.onclick=p.onclick=null;i.onkeypress=h.onkeypress=null}d.attachEvent("ondispose",L);return d}function A(e,d,c){var a=null;if(c){var b=d[c];if(b)a=e.getItem(b);if(a)a.select()}}function bb(){var b=r.fontmenu.fonts.split(","),c=new $UI.Bar("vertical"),g=c.appendItem,e={},d="style";for(var a=0;a<b.length;a++)if(b[a]&&b[a]!=""){g(new E(d+a,b[a],null,null,Ib(b[a]),null,false,{font:["100%",b[a]].join(" ")}));e[b[a]]=d+a}c.attachEvent("onshow",f);function f(){c.resetState(true);A(c,e,R(vb,function(a){return a.tagName=="FONT"?a.face:a.style.fontFamily}))}return c}function gb(){var b=new $UI.Bar("vertical"),i=b.appendItem,f=r.blockmenu.labels.split(","),d=r.blockmenu.values.split(","),e={},c;for(var a=0;a<d.length;a++){c=d[a];if(c=="P"&&P())c="DIV";i(new E("para"+a,f[a],h(c,f[a]),null,Eb("<"+c+">")));e[d[a]]="para"+a}function h(a,b){return ["<",a,' style="margin:0;padding:0 4px;white-space:nowrap">',b,"</",a,">"].join("")}b.attachEvent("onshow",g);function g(){b.resetState(true);A(b,e,R(Fb,function(a){return a.tagName}))}return b}function cb(){var b=new $UI.Bar("vertical");O.add(b.element,"uxp_fontsize_menu");var g=b.appendItem,d={},c=r.sizemenu.labels.split(",");for(var a=0;a<c.length;a++){g(new E("size"+a,c[a],f(a+1+"",c[a]),null,Jb(a+1+"")));d[a+1]="size"+a}function f(b,a){return ['<font size="',b,'">',a,"</font>"].join("")}b.attachEvent("onshow",e);function e(){b.resetState(true);A(b,d,R(wb,function(a){return a.size}))}return b}var B=k("TABLE",{cellSpacing:"0",className:ab.toolbar}),U=k("TBODY"),W=k("TR"),V=k("TD",{style:{padding:o?0:null}});B.appendChild(U);U.appendChild(W);W.appendChild(V);V.appendChild(n.element);if(l.insertAdjacentElement)l.insertAdjacentElement("afterBegin",B);else if(l.firstChild)l.insertBefore(B,l.firstChild)}function J(a){return a.startsWith("/")||a.startsWith("http://")?a:Lb+a}$UI.Editor.correctPath=J};$UI.Editor._FFCallbackCount=[];$UI.Editor._FFCallback=function(b,a){$UI.Editor._FFCallbackCount[a]._InitFireFox(b)};$UI.Editor.registerClass?$UI.Editor.registerClass("$UI.Editor","$Binding"):null;$UI.Editor.Events=new $Enum("onfocus","onselectionchanged","onpaste");$UI.Editor.bindTo=function(d,c){var a=null,b=document.getElementById(d);if(b){a=new $UI.Editor(b,c);a.initialize()}return a};$UI.Editor.Version="12.1.2036.0917";$UI.Bar=function(o){var b=this,h=$Utils.createElement,r=$Browser.isIE(),e=$Browser.isMozilla()||!$Browser.isIE(),f,l=null;this.hideFloat=false;this.firstItem=null;var g=$UI.isRTL(),i={menuTable:"uxp_bar_menu",menuUL:"uxp_bar_menu_list",barDiv:"uxp_bar",barUL:"uxp_bar_list"};window.attachEvent("onunload",k);document.attachEvent("onclick",d);document.body.attachEvent("onclick",d);window.attachEvent("onresize",j);if(!this.fire)$Mini.addEventHandler(this);var a={state:null,source:null,target:null},c={items:{},groups:{},count:0,add:function(a){this.items[a.id]=a;this.count++;if(a.groupid){var b=this.groups[a.groupid];b?b.push(a):(this.groups[a.groupid]=[a])}},remove:function(b){if(b.groupid&&this.groups[b.groupid]){var a=0,c=b.groupid;while(a<this.groups[c].length)if(this.groups[c][a]==b){this.groups[c][a]=null;this.groups[c].splice(a,1);a=this.groups[c].length}else a++}this.count--;this.items[b.id]=null}};this.resetState=function(d){var a=b.getItems();for(var c in a)if(a[c].setState)a[c].setState("normal",d)};this.getItems=function(){return c.items};this.getItem=function(e){var d=null,a=b.getItems();for(var c in a)if(a[c].id==e){d=a[c];break}return d};this.appendItem=function(a){if(c.count==0&&a)b.firstItem=a;c.add(a);f.appendChild(a.element);a.parentItem=b};this.subState=function(){return a};this.subStateOpen=function(){return a.state=="open"};this.isShowing=function(){return l==$UI.Bar.States.shown};this.hide=function(a){a=a||b.element;a.style.display="none";l=$UI.Bar.States.hidden;b.fire("onhide",this)};this.show=function(){b.element.style.display="block";l=$UI.Bar.States.shown;b.fire("onshow",this)};this.dispose=function(){k()};this.col=c;this.element=q();function k(){b.fire("ondispose");window.detachEvent("onunload",k);document.detachEvent("onclick",d);document.body.detachEvent("onclick",d);window.detachEvent("onresize",j);var a=c.items;for(var e in a){c.remove(a[e]);a[e]=null}f=null;b.element=null}function q(){var a;if(o=="vertical"){a=h({tagName:"DIV",className:i.menuTable,style:{position:"absolute",display:"none"}});if(r&&(document.compatMode=="BackCompat"||$Browser.version=="6"))a.style.width="1%";var c=h({tagName:"UL",className:i.menuUL,style:{margin:0,padding:0}});a.appendChild(c);f=c}else if(o=="horizontal"){a=h({tagName:"DIV",className:i.barDiv,style:{display:"block"}});var b=h({tagName:"UL",className:i.barUL});a.appendChild(b);f=b}a.style.textAlign=g?"right":"left";return a}this.insertSubItem=function(c,e,f){if(a.state=="open")if(a.source!=c||a.target!=e)this.hideSubElement(a.source,false);else return;a.state="open";a.source=c;a.target=e;a.pos=f;f=f||null;var b=e.element,d=c.element;if(b.nextSibling!=d){if(b.insertAdjacentElement)b.insertAdjacentElement("afterEnd",d);else if(b.firstChild)b.parentNode.insertBefore(d,b.nextSibling);if(c.attachEvent)c.attachEvent("onhide",n)}j();c.show()};this.setVis=function(c,a){a=a||b.element;try{var d=a.style;d.visibility=c===false?"hidden":"visible";d.display=c===false?"block":"none"}catch(e){}};function j(){if(a.source){var h=a.target.element,d=a.source.element,l=e?h.offsetParent.offsetParent:null,j=$UI.getLocation(d,l),f=e?$UI.getLocation(h.firstChild,l):$UI.getLocation(h),m=e?f.left-j.left:f.relX-j.relX,p=e?f.top-j.top:f.relY-j.relY,c=d.style;b.setVis(false,d);c.top=p+f.height+"px";c.left=m+"px";if(g){var q=$UI.LayoutRoot();if(e)c.left=f.right-d.offsetWidth+"px";else{c.left="";var o=h.firstChild.offsetWidth;c.marginRight=-o+"px"}}var i=$UI.getLocation(d),n=1,k=i.right-$UI.LayoutRoot().clientWidth;if(!g&&k>0){i.left=m-(k+n);c.left=i.left+"px"}else if(g&&i.left<0)c.left=n+"px";b.setVis(true,d)}}function n(a){b.hideSubElement(a,true);a.detachEvent("onhide",n)}this.hideSubElement=function(c,d){if(undefined===d)d=true;c=c||a.source;if(c){b.hide(c.element);if(a.target&&a.target.setState)a.target.setState("normal",true)}if(d)p()};function p(){a.state=a.source=a.target=null}function m(b,a){try{while(a&&a!==b&&a!=document)a=a.parentNode;return a===b}catch(c){}}function d(c){c=c||event;if(a.source){var d=c.srcElement||c.target,e=m(a.source.element,d)||m(a.target.element,d);if(!e)b.hideSubElement(a.source,true)}else if(b.hideFloat)b.hide()}this.captureMouseup=d;$UI.Bar.instance.push(this)};$UI.Bar.instance=[];$UI.Bar.updateDocument=function(c,d){var b=d?"detachEvent":"attachEvent";for(var a=0;a<$UI.Bar.instance.length;a++){c[b]("onmouseup",$UI.Bar.instance[a].captureMouseup);c.body[b]("onmouseup",$UI.Bar.instance[a].captureMouseup)}};$UI.Bar.States=new $Enum("hidden","shown");$UI.Bar.Events=new $Enum("onshow","onhide","ondispose");function genEnum(){var b={};for(var a=0;a<arguments.length;a++)b[arguments[a]]=arguments[a];return b}$UI.BarItemButton=function(i,h,g,d,a,c,e,b,f){return new $UI.BarItem($UI.BarItem.Types.button,i,h,null,g,d,a,c,e,b,f)};$UI.BarItemMenu=function(h,f,a,g,c,d,b,e){return new $UI.BarItem($UI.BarItem.Types.menu,h,f,a,g,null,null,c,d,b,e)};$UI.BarItem=function(N,y,q,g,l,p,k,m,O,o,c){c=c||{};l=l||null;o=o||false;k=k||function(){};m=m||function(){};g=g||null;c.tip=c.tip||q;c.imgWidth=c.imgWidth||416;var t=$UI.isRTL(),f={wrapLI:"uxp_baritem",anchorA:"uxp_baritem_text",anchorButtonA:"uxp_baritem_button",clipDiv:"uxp_baritem_button_clip",selectA:"uxp_baritem_selected",hoverA:"uxp_baritem_hover"},A=c.font,b=this,x=$Utils.createElement,M=$Browser.isIE(),e=$Utils.css,G=6,r=null,F=null,h=N==$UI.BarItem.Types.button;if(!this.fire)$Mini.addEventHandler(this);this.groupid=c.groupid;this.id=y;this.parentItem=null;this.hasSubItem=o;var d=$UI.BarItem.States,i=d.normal,L=h?{display:"inline"}:{listStyle:"none",margin:0,padding:0},u=x({tagName:"LI",className:f.wrapLI,style:L,id:"LI_"+y});this.element=u;var a,H=false,z=g&&typeof g=="object";if(!z){a=x({tagName:"A",hideFocus:"1",id:y,className:h?f.anchorButtonA:f.anchorA,href:"#",onclick:function(){return false},title:c.tip,style:{cssFloat:h?"left":"",display:h?"inline-block":"block",whiteSpace:h?"":"nowrap",position:"relative",padding:"1px",textDecoration:"none",textDecoration:"none",color:"#000"}});if(t){a.style.cssFloat=h?"right":"";a.style.zoom="1"}u.appendChild(a);this.anchor=a}var P="";if(z){this.anchor=null;u.appendChild(g);H=true}else if(h){if(!c.sizeToText){a.style.width=p.width+G+"px";if(M)a.style.overflow="hidden"}a.style.height=p.height+G+"px";J()}else K();I();var n;function J(){var h=[],d=['<span className="'+f.clipDiv+'" '],b=["white-space:nowrap;cursor:pointer;z-index:0;"],k="position:absolute;",g="margin:3px 2px 2px 3px;",i="",j="";if(!c.sizeToText&&t)i="padding-right:16px;";if(c.sizeToText){k="position:relative;";i="padding-right:0px;";g="margin:0;";b.push("display:inline-block;vertical-align:top;");b.push("text-indent:"+(o?"1px;":"3px;"))}else b.push("clip:"+["rect(0px ",p.width,"px ",p.height,"px 0px);"].join(""));if(l){h.push(['<IMG border="0" alt="',q,'" src="',l.src,'" style="cursor:pointer;z-index:0;position:absolute;left:',-p[t?"left":"left"],"px;width:",c.imgWidth,'px;"'].join(""));h.push(' onselectstart="return false" ondragstart="return false" onmousedown="return false" ');h.push('id="u_tbImg" />')}else{e.add(a," text");e.add(u," text");var v=parseInt(a.style.height,10)-2;g="margin:0 3px;";b.push("line-height:"+v+"px;");j=q}var m="";if(o&&!l){g="margin:0;";var r="padding:"+(t?"8px 6px 6px 2px;":"8px 2px 6px 5px;"),s="border:0;vertical-align:middle;"+r;m=['<IMG src="'+$UI.Editor.correctPath("images/arrow.gif")+'" alt="'+q+'" style="'+s+'" ',"/>"].join("")}b.push(k);b.push(g);b.push(i);d.push([' style="'+b.join("")+'" >'].join(""));d.push(j);d.push(h);d.push(m);d.push["</span>"];a.innerHTML=d.join("");if(l)try{n=a.getElementsByTagName("IMG")[0]}catch(w){}}function K(){var b=g;if(!b){b=x({tagName:"div",style:{lineHeight:16+"px",padding:"0 5px"}});b.innerHTML=q;if(A)b.style.font=A;a.appendChild(b)}else a.innerHTML=g}function v(){b.parentItem.hideSubElement(null,true)}function B(a){a=a||event;var c=27;if(a.type=="keyup"&&a.keyCode==c&&b.parentItem&&b.parentItem.subStateOpen()&&b.parentItem.subState().target==b){v();j();if(b.anchor)b.anchor.focus()}}function I(){window.attachEvent("onunload",D);document.attachEvent("onkeyup",B);if(a){a.attachEvent("onclick",w);a.attachEvent("onmouseover",j);a.attachEvent("onmouseout",s);a.attachEvent("onmousedown",C);a.attachEvent("onmouseup",j);a.attachEvent("onfocus",E);a.attachEvent("onblur",s)}}function D(){if(a){a.detachEvent("onclick",w);a.detachEvent("onmouseover",j);a.detachEvent("onmouseout",s);a.detachEvent("onmousedown",C);a.detachEvent("onmouseup",j);a.detachEvent("onfocus",E);a.detachEvent("onblur",s);b.anchor=a=null}k=m=null;g=b.element=F=null;l=n=null;document.detachEvent("onkeyup",B);window.detachEvent("onunload",D);b.parentItem=null}function w(c){c=c||event;var d,e;if(m&&i!="disabled"){if((c.srcElement||c.target)&&c.type=="click"&&b.parentItem&&b.parentItem.subState().target==b){v();j()}else if(h){e=m(b);if(k)d=k(b,"getState")}else{e=false;d=m(b)}if(d)b.setState(d,e)}else if(a)a.blur()}this.select=function(){if(i!=d.disabled)b.setState(d.select,true)};this.click=function(a){w(a)};this.getClip=function(){return F};this.getAnchor=function(){return a};function E(){window.setTimeout(j,50);if(b.parentItem&&b.parentItem.subStateOpen()&&b.parentItem.subState().target!=b)v()}function j(){if(i!=d.disabled)b.setState(d.hover,false)}function s(){if(i!=d.disabled)b.setState(i,false)}function C(){if(i!=d.disabled)b.setState(d.select,false)}this.update=function(){if(k)b.setState(k(b,"getUpdate"),true)};this.getState=function(){return i};this.getActiveState=function(){return r};this.setState=function(c,k){var g=d;c=c||g.normal;a.href="#";a.tabIndex="0";a.disabled=false;if(c!=g.disabled){if(n)n.style.top="0px";e.remove(a,f.hoverA);e.remove(a,"disabled");switch(c){case g.close:this.parentItem.close();break;case g.hide:this.parentItem.hide();break;case g.normal:h();break;case g.hover:e.add(a,f.hoverA);break;case g.select:e.add(a,f.selectA)}}else{h();if(n)n.style.top="-16px";a.style.cursor="default";a.tabIndex=-1;a.removeAttribute("href");a.disabled=true;e.add(a,"disabled")}if(c!=r)window.setTimeout(j,0);if(k)this.state=i=c;function h(){e.remove(a,f.selectA);e.remove(a,f.hoverA)}function j(){if(r!=c){r=c;b.fire("onstatechange")}}}};$UI.BarItem.States=new $Enum("normal","disabled","hover","close","hide","select");$UI.BarItem.Types=new $Enum("menu","button");$UI.BarItem.Events=new $Enum("onclick","onmouseover","onstatechange");$UI.ColorPicker=function(d){d=d||{};var c=this,a=$Utils.createElement,g=d.defaultBorder||"1px solid #E8E9E9",q,s,h,p=$Browser.isIE(),A=$Browser.isMozilla()||!$Browser.isIE(),v=live.shared.strings.colors,b="uxp_clrpkr",j={base:b,content:b+"_content",priRow:b+"_primary",secRow:b+"_secondary",mixedRow:b+"_mixed",optionRow:b+"_options",color:b+"_color"},o=a("DIV",{className:j.base,style:{border:g}}),e=a("DIV",{className:j.content,style:{padding:"3px"}});function m(){}this.onclear=m;this.oncolor=m;this.onmore=m;function y(a){a=a||event;var d=a.srcElement||a.target,b=d.colorValue;if(c.oncolor)c.oncolor(b);return false}function z(){if(c.onmore)c.onmore();return false}function x(){if(c.onclear)c.onclear();return false}q=d.primaryPallete||["C00000","FF0000","FFC000","FFFF00","92D050","00B050","00B0F0","0070C0","002060","7030A0"];s=d.secondaryPallete||["FFFFFF","000000","EEECE1","1F497D","4F81BD","C0504D","9BBB59","8064A2","4BACC6","F79646"];h=d.mixedPallete||[["F2F2F2","7F7F7F","DDD9C3","C6D9F0","DBE5F1","F2DCDB","EBF1DD","E5E0EC","DBEEF3","FDEADA"],["D8D8D8","595959","C4BD97","8DB3E2","B8CCE4","E5B9B7","D7E3BC","CCC1D9","B7DDE8","FBD5B5"],["BFBFBF","3F3F3F","938953","548DD4","95B3D7","D99694","C3D69B","B2A2C7","92CDDC","FAC08F"],["A5A5A5","262626","494429","17365D","366092","953734","76923C","5F497A","31859B","E36C09"],["FAFAFA","0C0C0C","1D1B10","0F243E","244061","632423","4F6128","3F3151","205867","974806"]];var r=a("DIV",{style:{height:"18px",clear:"left",padding:"0 0 4px 0",borderBottom:g}}),t=a("DIV",{style:{padding:"4px 0"}}),n=a("DIV",{style:{clear:"left"}}),l=a("DIV",{className:j.optionRow,style:{clear:"left",borderTop:g,marginTop:"4px"}}),u=a({tagName:"A",href:"#",onclick:x,innerHTML:v.clear,id:"rte_clearclr",style:{display:"block",textDecoration:"none"}}),w=a({tagName:"A",innerHTML:v.more,href:"#",onclick:z,id:"rte_moreclr",style:{display:"block",textDecoration:"none"}});e.appendChild(r);e.appendChild(t);e.appendChild(n);e.appendChild(l);o.appendChild(e);if(!A)l.appendChild(u);if(p)l.appendChild(w);k(r,q,"1111");k(t,s,"1111");var i;for(var f=0;f<h.length;f++){i="0101";if(f==0)i="1101";else if(f==h.length-1)i="0111";n.appendChild(k(a("DIV"),h[f],i))}function k(h,c,e){var i=["borderTop","borderRight","borderBottom","borderLeft"],f;h.style.clear="left";for(var b=0;b<c.length;b++){f=a({tagName:"A",href:"#",onclick:y,title:"#"+c[b],innerHTML:"&nbsp;",colorValue:"#"+c[b],className:j.color,style:{cssFloat:"left",display:p?"inline-block":"inline",backgroundColor:"#"+c[b],width:"14px",height:"14px",overflow:"hidden",textDecoration:"none",margin:"0 2px"}});h.appendChild(f);if(e)for(var d=0;d<e.length;d++)if(e.substr(d,1)=="1")f.style[i[d]]=g}return h}this.dispose=function(){w=u=null};this.element=o;return this};registerNamespace("$Utils","$UI");$Utils.cancelBubble=function(a){a=a||event;if(a.stopPropagation)a.stopPropagation();else a.cancelBubble=true;return false};$Utils.cancelEvent=function(a,b){a=a||event;if(a.stopPropagation)a.preventDefault();else a.cancelReturn=true;if(!b)$Utils.cancelBubble(a);return false};$Utils.isChildOf=function(b,a){try{while(a&&a!==b&&a!=document)a=a.parentNode;return a===b}catch(c){}};registerNamespace("$Utils");$Utils.createElement=function(a,c){var b;$Utils.createElement.applyAttributes=function(c,b){for(var a in b.style)try{c.style[a]=b.style[a]}catch(d){alert(["Error applying style",d.description,a].join("\n"))}for(var a in b)try{if(a!="style"&&a!="tagName"&&b[a]!=null)c[a]=b[a]}catch(d){alert(["Error creating element",d.description,a].join("\n"))}};if(typeof a!="string"){if(!a.tagName){alert(["Object needs a tagName",arguments.callee.caller].join("\n"));return {}}b=document.createElement(a.tagName);$Utils.createElement.applyAttributes(b,a)}else{b=a?document.createElement(a):null;if(b&&c)$Utils.createElement.applyAttributes(b,c)}return b};$Utils.css=function(){var a=$Utils.css;a.has=function(c,b){var a=false;try{a=(new RegExp("\\b"+b+"\\b","i")).test(c.className)}catch(d){}return a};a.remove=function(a,b){if(a&&a.className){a.className=a.className.replace(new RegExp("\\b"+b+"\\b","i"),"");a.className=a.className.replace(/^\s|\s(\s)|\s$/g,"$1")}};a.add=function(b,c){if(b)if(b.className){if(!a.has(b,c))b.className+=" "+c}else b.className=c};a.toggle=function(b,c){var d=false;if(b.className&&a.has(b,c))a.remove(b,c);else{a.add(b,c);d=true}return d}};$Utils.css();$UI.LayoutRoot=function(){return document.compatMode=="CSS1Compat"?document.documentElement:document.body};$UI.getCurrentStyle=function(f){var a={},e=["Top","Left","Right","Bottom"],b=document.defaultView.getComputedStyle(f,null);for(var d=0;d<e.length;d++){var c=e[d];a["border"+c+"Width"]=b.getPropertyValue("border-"+c+"-width");a["margin"+c]=b.getPropertyValue("margin-"+c);a["padding"+c]=b.getPropertyValue("padding-"+c)}a["position"]=b.getPropertyValue("position");a["height"]=b.getPropertyValue("height");a["width"]=b.getPropertyValue("width");a["zIndex"]=b.getPropertyValue("z-index");a["color"]=b.getPropertyValue("color");a["direction"]=b.getPropertyValue("direction");a["overflowY"]=b.getPropertyValue("overflow-y");a["display"]=b.getPropertyValue("display");return a};$UI.isRTL=function(){var a=false;if(document.body.currentStyle)a=document.body.currentStyle.direction=="rtl";else if(document.body.style)a=document.body.style.direction=="rtl";return a};$UI.getLocation=function(d,i){var a={x:0,y:0,top:0,right:0,bottom:0,left:0,relX:0,relY:0},f={x:0,y:0},b=d,k=false;f.x=c(d.style.left);f.y=c(d.style.top);var h=d.currentStyle||{},j=["Top","Left","Right","Bottom"];for(var g=0;g<j.length;g++){var e=j[g];a["margin"+e]=c(h["margin"+e]);a["border"+e]=c(h["border"+e+"Width"]);a["padding"+e]=c(h["padding"+e])}var l=0,m=0;if(b.offsetParent){a.x=b.offsetLeft;a.y=b.offsetTop;while(b=b.offsetParent)if(n(b)){k=b.style&&b.style.position=="relative";if(k)if($Browser.isIE()){a.x=0;a.y+=b.offsetTop}else{a.x=b.offsetLeft;a.y=b.offsetTop}else{a.x+=b.offsetLeft;a.y+=b.offsetTop}l-=c(b.scrollLeft);m-=c(b.scrollTop)}else break}function n(b){var a=true;if(i)a=$Utils.isChildOf(i,b);return a}function c(a){a=parseInt(a);return isNaN(a)?0:a}a.left=a.x+l;a.top=a.y+m;a.height=d.offsetHeight;a.width=d.offsetWidth;a.bottom=a.top+a.height-a.marginBottom;a.right=a.left+a.width-a.marginRight;a.relX=a.x-f.x;a.relY=a.y-f.y;return a};registerNamespace("$Mini");$Mini.addEventHandler=function(a){var c={myEvents:[],attachEvent:function(c,d){var b={};b[c]=d;a.myEvents.push(b)},detachEvent:function(f,e){var d=a.myEvents,b=0;for(var c in d){if(c==f&&e==d[c])d[c]=null;if(a.myEvents[b]==e){a.myEvents[b]=null;a.myEvents=a.myEvents.splice(b,1)}b++}},fire:function(e,f){var c=a.myEvents;for(var b=0;b<c.length;b++)if(c[b]&&c[b][e]){var g=c[b][e],d=function(){g(a)};if(f)window.setTimeout(d,0);else d()}}};for(var b in c)a[b]=c[b]}