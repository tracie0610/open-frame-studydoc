<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>



<meta http-equiv="Content-Type" content="text/html; charset=gbk" />
<meta equiv="X-UA-Compatible" content="IE=EmulateIE7" /> 
<title>java jacob操作word文档-哈哈-搜狐博客</title>
<meta name="Keywords" content="博客,Blog,Blogger,搜狐,Sohu,网络日志 哈哈" />
<meta name="description" content="哈哈 我要幸福" />
<meta name="robots" content="index,follow" />
<script type="text/javascript">
var JSPATH = {},
HCP='http://js2.pp.sohu.com.cn/ppp/js/common_v_081016/',
HMP='http://js4.pp.sohu.com.cn/ppp/js/module_v_081031/',
HTP='http://js5.pp.sohu.com.cn/ppp/js/tool_v_090418/';
JSPATH.util={common:HCP+'common.js',module:HMP,tool:HTP};

var BLOG_SP = 'http://js3.pp.sohu.com.cn/ppp/blog/js_ppp_v_090323/';
JSPATH.blog={_path:BLOG_SP};

var TP = 'http://js2.pp.sohu.com.cn/ppp/group/toolbar_v_09042917/';

</script>

<link href="http://js2.pp.sohu.com.cn/ppp/blog/themes_ppp_v_090702/def/style.css" rel="stylesheet" type="text/css" />

<link id="themeCss" href="http://js2.pp.sohu.com.cn/ppp/blog/themes_ppp_v_090702/p0005/style.css" themeid="p0005" rel="stylesheet" type="text/css" />

<script type="text/javascript">
document.write('<link href="'+TP+'themes/p01/style.css" rel="stylesheet" type="text/css"/>');
</script>
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://10602299.blog.sohu.com/rss" />
</head>
<body>
<a name="top"></a>
<script type="text/javascript">
var _blog_base_url = 'http://10602299.blog.sohu.com/';
var _blog_base_path = 'http://10602299.blog.sohu.com/';
var _blog_domain='10602299';
var _ebi = 'bb5ed1b792';
var _ept = 'fu_yanqiang';
var _xpt = 'ZnVfeWFucWlhbmdAc29odS5jb20=';
</script>

<script type="text/javascript">
// 2007-12-25
// Modify：springwang 2009-03-30


var _w = {
	c: ['您好', '欢迎', 'Hi～', 'Hello!', '欢迎到搜狐博客','淡定～淡定～','嘿咻嘿咻～', '海盗船长嘿咻嘿咻','粉红娘娘哎哎哎哎','乐呵乐呵得了', '相逢的人会再相逢', '努力构建和谐社会', '换个模板换个心情', '写博客传爱心', '加油，中国', '看看好友动态吧', '好想去鸟巢～', '爱护环境从我做起', '我是来打酱油的', '先做三个俯卧撑', '看奥运，上搜狐', '又被雷到了*o*', '彪悍的人生不解释'],
	m: ['早上好', '天亮了', '新的一天', '小鸟在歌唱~', '记得吃早点', '又堵车了:(', '!o!要打起精神', '一起去晨练', '*_*天气热了', '注意防晒', 'Morning~', '不想上班@@', '早饭要吃好', '开开心心上班来', '走自己的路...', '少开一天车', 'omg！衣服又瘦了'],
	a: ['上午好', '好忙', '忙么？', '喝杯咖啡', '休息一下', '抓紧时间', '提高工作效率', '伸伸胳膊扭扭腰', '眼睛累了，眺望远方'],
	n: ['中午好', '午饭时间', '×_×小睡一会', '∮听会儿音乐吧', '多吃青菜', '饭要七成饱', '午饭要吃饱', '还不去吃饭？', '休息，休息一会儿', '鱼香肉丝里没有鱼', '又晒黑了:(', '番茄原来是西红柿'],
	p: ['下午好', '屋里好热～','屋里好冷～', '工作完成了？', '提高工作效率', '#_#有些困', '打起精神来', '多喝水', '洗把脸', '忙啊忙啊~', '还不发工资'],
	d: ['傍晚好', '又堵车了:(', '还不下班？', '吃些什么？', '一会儿去买菜', '^O^今天我来做饭', '抓紧时间啦～', '晚饭要吃少', '没堵车:)', '不吃了，减肥~', '高高兴兴回家去', '走自己的路不打的', '回家家找妈妈', '难得不堵车～'],
	e: ['晚上好', '吃些什么？', ')o(要控制饮食', '饭后吃个水果', '去散散步', '有人请客么？', '还在加班？', '陪她去看电影哦～', '晚上去跑步', '鱼香肉丝里没有鱼', '各回各家找妈妈', '今晚去FB，嘿嘿～'],
	l: ['夜里好', '还没睡？', '今夜星光灿烂～', '还在工作么？', '早睡早起身体好', '今天有何收获？', '给她发晚安短信吧～',  '洗洗睡吧~'],
	w: ['凌晨好', '+_+好困啊', '通宵么？', '...zzZZ~~', '嘘～小声点', '不要睡太晚', '你在他乡还好吗', '几点了D_D', '睡吧，明天还上班', '你不是一个人在战斗', '长夜漫漫无心睡眠', '夜漫漫其修远兮~~', '醒醒～～醒醒～', '讲鬼故事喽~~'],
	k: ['周末好', '好好休息一下', '去郊游吧～', '周末睡个懒觉', '给家里打个电话吧', '该出去晒太阳了', '约朋友去打球', '一起去健身吧', '伸个懒腰~', '好兴奋！', '没有人在线:(', '秋天适宜出游']
};


</script>
<script type="text/javascript">
/**
 * 广告出现的几率，_p = 3 表示 10次平均有3次会出现广告
 */
var _p = 3;
/**
 * 不同时段的广告语
 */
var _a = {
         // 常用广告语，每个时间段都可能出现
         c: [
'<a href="http://dream2009.sohu.com/">你有梦想我有行动</a>',
'<a href="http://dream2009.sohu.com/">谁能跑出夏日精彩</a>',
'<a href="http://dream2009.sohu.com/">将梦想照进现实</a>',
'<a href="http://dream2009.sohu.com/">播种梦想收获希望</a>',
'<a href="http://dream2009.sohu.com/">有梦想，中国强</a>',
'<a href="http://dream2009.sohu.com/">抓住你的梦想</a>',
'<a href="http://dream2009.sohu.com/"> 用梦想规划人生</a>',
'<a href="http://dream2009.sohu.com/">以梦想的名义</a>',
'<a href="http://dream2009.sohu.com/">非凡梦想非凡人生</a>',
'<a href="http://dream2009.sohu.com/">潮爆中国梦</a>'
],
//
        // 6 点到 9 点时段的广告语
         m: [],
//
        // 9 点 到12 点 时段的广告语
         a: [],
//
        // 12 点 到14 点 时段的广告语
         n: [],
//
        // 14 点 到17 点 时段的广告语
         p: [],
//
        // 17 点 到19 点 时段的广告语
         d: [],
//
        // 19 点 到21 点 时段的广告语
         e: [],
//
        // 21 点 到24 点 时段的广告语
         l: [],
//
        // 0 点 到6 点 时段的广告语
         w: [],
//
        // 周末时段的广告语
         k: []
//
};
</script>

<div id="toolBar" class="toolBar clearfix" pdt="blog" sohu3="false">
	<div id="innerToolBar" class="innerToolBar clearfix">
                <div id="tb_logo" onmousedown="CA.q('toolbar_blogLogo');">
                         <a style="margin:0" href="http://blog.sohu.com" title="搜狐博客" target="_blank"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/logotb.gif" alt="搜狐博客" /></a>
 
                </div>
                <div id="tb_user" class="clearfix"><span class="txt">loading ...</span></div>
				<div id="tb_nav" style="display:none;"></div>
                <div id="tb_tool" style="display:none;"></div>
                <div id="tb_sys">
					<span id="logoutBtn" style="display:none;"><a href="javascript:ToolBar.doLogout();" onmousedown="CA.q('toolbar_logout');">离开</a>|</span>
					<a href="http://blogsearch.sogou.com/" target="_blank" onmousedown="CA.q('toolbar_search');">搜索</a>|
					<a href="http://blog.sohu.com/help.html" title="帮助" target="_blank" onmousedown="CA.q('toolbar_help');">帮助</a>
				</div>
                <div id="tb_addon">
        <script type="text/javascript">
                var toolbarSysRec = {
                        
                        "tip" : {"title": "<FONT size=2>来！背着老板偷学英语</FONT>","url":"http://sohu.ad-plus.cn/event.ng/Type=click&FlightID=200906&TargetID=sohu&Values=e65c64b9,b7001972,4816d87d,8d7a8d1f&AdID=4044"}//标题长度不能超过10个汉字

                        
                };
                document.write('<a href="'+ toolbarSysRec.tip.url +'" target="_blank" style="font-weight:bold;" onmousedown="CA.q(\'toolbar_tips\');">'+ toolbarSysRec.tip.title +'</a>');
                </script>
        </div>
        </div>
</div>
<div id="toolbarPadding"></div>

<div id="_preLoadText" style="text-align:center;">loading...</div>

<script type="text/javascript">
var SP = BLOG_SP;
var ThP = 'http://js2.pp.sohu.com.cn/ppp/blog/themes_ppp_v_090702/';
var WP = '/ppp/blog/widgets_v_090624/';
var UWAP = 'http://js3.pp.sohu.com.cn/ppp/blog/widgets_v_080920/uwa_widget/';
document.write('<scr'+'ipt type="text/javascript" src="'+ SP + 'sohublog.js"></scr'+'ipt>');
var SL = [SP+'log.js', 'http://js.sohu.com/passport/pp18030_17.js', 'http://js.sohu.com/passport/pp18030_ui_11.js', HCP+'common.js', SP+'common.v.090716.js', HTP+'effect.js', TP+'toolbar.js'];
</script>
<script type="text/javascript">
//var noToolBar = true;
lsl(SL);
</script>
<script type="text/javascript">
if (isPPLogin() && (getPPP() != getP())) {
	document.write('<scr'+'ipt src="http://blog.sohu.com/service/passport.jsp" type="text/javascript"></scr'+'ipt>');
}
</script>
<script type="text/javascript">
if (typeof ToolBar != 'undefined') {
	ToolBar.init();
	/*if (isLoginBlogUser()) {
		Starter.add(ToolBar.psptCardDefaultShow.bind(ToolBar));
	}*/
}
</script>
<div id="wrapper">
	<div id="innerWrapper">
		
<div id="topPadding"></div>
<div id="header">
  <div id="playerBox"><div id="innerPlayerBox"></div></div>
  <div id="innerHeader">
	<div id="blogLogo"><a href="http://blog.sohu.com"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/spacer.gif" id="logo" alt="搜狐博客" /></a></div>
	<h1 id="blogTitle"><a href="http://10602299.blog.sohu.com/"  id="blogAdmin" onmousedown="CA.q('blog_header_title');">哈哈</a></h1>
	<div id="blogUrl">
		<!-- a href="http://10602299.blog.sohu.com/">http://10602299.blog.sohu.com/</a --> 
        <a href="http://10602299.blog.sohu.com/profile/" target="_blank" class="navUrl" title="查看哈哈的个人档案" onmousedown="CA.q('blog_header_profile');"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_profile.gif" alt="档案" align="absmiddle" />档案</a> 
        <a href="http://10602299.blog.sohu.com/entry/" target="_blank" class="navUrl" title="查看哈哈的日志" onmousedown="CA.q('blog_header_entry');"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_entry.gif" alt="日志" align="absmiddle" />日志</a> 
        <a href="http://pp.sohu.com/people/!ZnVfeWFucWlhbmdAc29odS5jb20=" target="_blank" class="navUrl" title="查看哈哈的相册" onmousedown="CA.q('blog_header_photo');"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_picture.gif" alt="相册" align="absmiddle" />相册</a> 
        <a href="http://v.blog.sohu.com/people/ZnVfeWFucWlhbmdAc29odS5jb20=" target="_blank" class="navUrl" title="查看哈哈的视频" onmousedown="CA.q('blog_header_video');"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_video.gif" alt="视频" align="absmiddle" />视频</a> 
        <a href="http://10602299.blog.sohu.com/app/soShare/" target="_blank" class="navUrl" title="查看哈哈的分享" onmousedown="CA.q('blog_header_share');"><img src="http://js1.pp.sohu.com.cn/ppp/images/icons/ico_share2.gif" alt="分享" align="absmiddle" />分享</a> 
		<a href="http://10602299.blog.sohu.com/rss" target="_blank" onmousedown="CA.q('blog_header_rss');"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_rss.gif" alt="RSS订阅" align="absmiddle" /></a>
		<a href="javascript:void(0)" name="onlineIcon" style="display:none" rel="" param="ZnVfeWFucWlhbmdAc29odS5jb20=;哈哈"></a>
	</div>
	<div id="blogDesc">我要幸福</div>
  </div>
</div>
<div id="navBar">
  <div id="innerNavBar">
		<ul id="mainNav">
			<li><a href="http://10602299.blog.sohu.com/#tp_bb5ed1b792"><script type="text/javascript">document.write(getNavIco('', '老家'));</script><span>老家</span></a></li> 

		</ul>
	<ul id="optionNav">
	  <li id="mngOpr"></li>
	</ul>
	<div class="clear"></div>
  </div>
</div>
<div id="neckWrapper"><div id="innerNeckWrapper"></div></div>
		<div id="mainWrapper">
		<div id="innerMainWrapper">
			<div id="articleContent">
                <div id="articleInnerContent">
					
					
					


<div id="contentLabelBox">
  <div id="innerContentLabelBox" style="height:25px;">
    <a href="http://blog.sohu.com">搜狐博客</a> 
	&gt; <a href="http://10602299.blog.sohu.com/">哈哈</a>
	&gt; <a href="http://10602299.blog.sohu.com/entry/">日志</a>
    
    &gt; <a href="http://10602299.blog.sohu.com/entry/5148771/">java</a>
    
  </div>
  <div class="contentLabel-new"></div>
  <div class="clear"></div>
</div>
<div class="content-top"></div>
<div class="item">
  <div class="item-top"></div>
  <div id="entry">
    <div class="item-title">
      <h3>2007-09-27&nbsp;|&nbsp;java jacob操作word文档
        
      </h3>
      <div class="item-label"><span class="itemOpr"><a onmousedown="CA.q('blog_entryview_share_topright');" href="javascript:void(0);" entryTitle="java jacob操作word文档" data-shareType="31" data-title="#{@entryTitle}" data-url="http://10602299.blog.sohu.com/65310574.html" data-abstracts="#{#main-content@innerText<51}" data-ext="{v:'1',xpt:'#{$_xpt}'}" onclick="shareIt(this)" style="margin-right:10px;"><img src="http://js2.pp.sohu.com.cn/ppp/blog/styles_ppp/images/btn_share_s2.gif" alt="分享" title="分享" /></a></span><span id="itemId_65310574" class="itemOpr"></span>
      </div>
      <div class="clear"></div>
    </div>
    <div class="item-body">
      
      <div class="item-content">标签：<span id="tagsBox">
        
        <a href="http://tag.blog.sohu.com/java/" target="_blank">java</a>&nbsp;
        
        <a href="http://tag.blog.sohu.com/jacob/" target="_blank">jacob</a>&nbsp;
        
        <a href="http://tag.blog.sohu.com/word/" target="_blank">word</a>&nbsp;
        
        </span></div>
      
      <div class="item-content" id="main-content"> <p>最近要做关于关于操作word的东西，因此找到了jacob，但是不会用，google找到了下面的这个类，感谢这个类的作者，感谢google,感谢jacob。</p>
<p>研究了两天也只是勉强能输出个简单的word文档，其中的一些经验需要记录下</p>
<p>环境：jdk1.5.0,tomcat5.024,jacob1.7,jacob1.9</p>
<p>为什么又有1.7又有1.9呢，是因为1.7的jacob.dll不好用，1.9的jacob.dll配合1.7的jacob.jar就好用了，我也不知道为什么，呵呵，关于java的一些开源jar的版本问题一直很困扰我</p>
<p>安装：将jacob.dll放到jdk1.5的bin目录下，jacob.jar放到classpath下就可以了</p>
<p>使用：下面的类提供了一些基本的操作，但还是缺少一定的灵活性。</p>
<p>import com.jacob.activeX.ActiveXComponent;<br />import com.jacob.com.Dispatch;<br />import com.jacob.com.Variant; </p>
<p>/**<br />&nbsp;* <br />&nbsp;* @author zhuzhen_hua@yahoo.com.cn<br />&nbsp;* <br />&nbsp;*/ </p>
<p>public class WordBean {<br />&nbsp;// word文档<br />&nbsp;private Dispatch doc; </p>
<p>&nbsp;// word运行程序对象<br />&nbsp;private ActiveXComponent word; </p>
<p>&nbsp;// 所有word文档集合<br />&nbsp;private Dispatch documents; </p>
<p>&nbsp;// 选定的范围或插入点<br />&nbsp;private Dispatch selection;<br />&nbsp; </p>
<p>&nbsp;private boolean saveOnExit = true; </p>
<p>&nbsp;public WordBean() {<br />&nbsp; if (word == null) {<br />&nbsp;&nbsp; word = new ActiveXComponent(&quot;Word.Application&quot;);<br />&nbsp;&nbsp; word.setProperty(&quot;Visible&quot;, new Variant(false));<br />&nbsp; }<br />&nbsp; if (documents == null)<br />&nbsp;&nbsp; documents = word.getProperty(&quot;Documents&quot;).toDispatch();<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 设置退出时参数<br />&nbsp; * <br />&nbsp; * @param saveOnExit<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; boolean true-退出时保存文件，false-退出时不保存文件<br />&nbsp; */<br />&nbsp;public void setSaveOnExit(boolean saveOnExit) {<br />&nbsp; this.saveOnExit = saveOnExit;<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 创建一个新的word文档<br />&nbsp; * <br />&nbsp; */<br />&nbsp;public void createNewDocument() {<br />&nbsp; doc = Dispatch.call(documents, &quot;Add&quot;).toDispatch();<br />&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 打开一个已存在的文档<br />&nbsp; * <br />&nbsp; * @param docPath<br />&nbsp; */<br />&nbsp;public void openDocument(String docPath) {<br />&nbsp; closeDocument();<br />&nbsp; doc = Dispatch.call(documents, &quot;Open&quot;, docPath).toDispatch();<br />&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 把选定的内容或插入点向上移动<br />&nbsp; * <br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 移动的距离<br />&nbsp; */<br />&nbsp;public void moveUp(int pos) {<br />&nbsp; if (selection == null)<br />&nbsp;&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp; for (int i = 0; i &lt; pos; i++)<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveUp&quot;); </p>
<p>&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 把选定的内容或者插入点向下移动<br />&nbsp; * <br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 移动的距离<br />&nbsp; */<br />&nbsp;public void moveDown(int pos) {<br />&nbsp; if (selection == null)<br />&nbsp;&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp; for (int i = 0; i &lt; pos; i++)<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveDown&quot;);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 把选定的内容或者插入点向左移动<br />&nbsp; * <br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 移动的距离<br />&nbsp; */<br />&nbsp;public void moveLeft(int pos) {<br />&nbsp; if (selection == null)<br />&nbsp;&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp; for (int i = 0; i &lt; pos; i++) {<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveLeft&quot;);<br />&nbsp; }<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 把选定的内容或者插入点向右移动<br />&nbsp; * <br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 移动的距离<br />&nbsp; */<br />&nbsp;public void moveRight(int pos) {<br />&nbsp; if (selection == null)<br />&nbsp;&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp; for (int i = 0; i &lt; pos; i++)<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveRight&quot;);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 把插入点移动到文件首位置<br />&nbsp; * <br />&nbsp; */<br />&nbsp;public void moveStart() {<br />&nbsp; if (selection == null)<br />&nbsp;&nbsp; selection = Dispatch.get(word, &quot;Selection&quot;).toDispatch();<br />&nbsp; Dispatch.call(selection, &quot;HomeKey&quot;, new Variant(6));<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 从选定内容或插入点开始查找文本<br />&nbsp; * <br />&nbsp; * @param toFindText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 要查找的文本<br />&nbsp; * @return boolean true-查找到并选中该文本，false-未查找到文本<br />&nbsp; */<br />&nbsp;public boolean find(String toFindText) {<br />&nbsp; if (toFindText == null || toFindText.equals(&quot;&quot;))<br />&nbsp;&nbsp; return false;<br />&nbsp; // 从selection所在位置开始查询<br />&nbsp; Dispatch find = word.call(selection, &quot;Find&quot;).toDispatch();<br />&nbsp; // 设置要查找的内容<br />&nbsp; Dispatch.put(find, &quot;Text&quot;, toFindText);<br />&nbsp; // 向前查找<br />&nbsp; Dispatch.put(find, &quot;Forward&quot;, &quot;True&quot;);<br />&nbsp; // 设置格式<br />&nbsp; Dispatch.put(find, &quot;Format&quot;, &quot;True&quot;);<br />&nbsp; // 大小写匹配<br />&nbsp; Dispatch.put(find, &quot;MatchCase&quot;, &quot;True&quot;);<br />&nbsp; // 全字匹配<br />&nbsp; Dispatch.put(find, &quot;MatchWholeWord&quot;, &quot;True&quot;);<br />&nbsp; // 查找并选中<br />&nbsp; return Dispatch.call(find, &quot;Execute&quot;).getBoolean();<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 把选定选定内容设定为替换文本<br />&nbsp; * <br />&nbsp; * @param toFindText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查找字符串<br />&nbsp; * @param newText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 要替换的内容<br />&nbsp; * @return<br />&nbsp; */<br />&nbsp;public boolean replaceText(String toFindText, String newText) {<br />&nbsp; if (!find(toFindText))<br />&nbsp;&nbsp; return false;<br />&nbsp; Dispatch.put(selection, &quot;Text&quot;, newText);<br />&nbsp; return true;<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 全局替换文本<br />&nbsp; * <br />&nbsp; * @param toFindText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查找字符串<br />&nbsp; * @param newText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 要替换的内容<br />&nbsp; */<br />&nbsp;public void replaceAllText(String toFindText, String newText) {<br />&nbsp; while (find(toFindText)) {<br />&nbsp;&nbsp; Dispatch.put(selection, &quot;Text&quot;, newText);<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveRight&quot;);<br />&nbsp; }<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在当前插入点插入字符串<br />&nbsp; * <br />&nbsp; * @param newText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 要插入的新字符串<br />&nbsp; */<br />&nbsp;public void insertText(String newText) {<br />&nbsp; Dispatch.put(selection, &quot;Text&quot;, newText);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * <br />&nbsp; * @param toFindText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 要查找的字符串<br />&nbsp; * @param imagePath<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图片路径<br />&nbsp; * @return<br />&nbsp; */<br />&nbsp;public boolean replaceImage(String toFindText, String imagePath) {<br />&nbsp; if (!find(toFindText))<br />&nbsp;&nbsp; return false;<br />&nbsp; Dispatch.call(Dispatch.get(selection, &quot;InLineShapes&quot;).toDispatch(),<br />&nbsp;&nbsp;&nbsp; &quot;AddPicture&quot;, imagePath);<br />&nbsp; return true;<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 全局替换图片<br />&nbsp; * <br />&nbsp; * @param toFindText<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 查找字符串<br />&nbsp; * @param imagePath<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图片路径<br />&nbsp; */<br />&nbsp;public void replaceAllImage(String toFindText, String imagePath) {<br />&nbsp; while (find(toFindText)) {<br />&nbsp;&nbsp; Dispatch.call(Dispatch.get(selection, &quot;InLineShapes&quot;).toDispatch(),<br />&nbsp;&nbsp;&nbsp;&nbsp; &quot;AddPicture&quot;, imagePath);<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveRight&quot;);<br />&nbsp; }<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在当前插入点插入图片<br />&nbsp; * <br />&nbsp; * @param imagePath<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 图片路径<br />&nbsp; */<br />&nbsp;public void insertImage(String imagePath) {<br />&nbsp; Dispatch.call(Dispatch.get(selection, &quot;InLineShapes&quot;).toDispatch(),<br />&nbsp;&nbsp;&nbsp; &quot;AddPicture&quot;, imagePath);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 合并单元格<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; * @param fstCellRowIdx<br />&nbsp; * @param fstCellColIdx<br />&nbsp; * @param secCellRowIdx<br />&nbsp; * @param secCellColIdx<br />&nbsp; */<br />&nbsp;public void mergeCell(int tableIndex, int fstCellRowIdx, int fstCellColIdx,<br />&nbsp;&nbsp; int secCellRowIdx, int secCellColIdx) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; Dispatch fstCell = Dispatch.call(table, &quot;Cell&quot;,<br />&nbsp;&nbsp;&nbsp; new Variant(fstCellRowIdx), new Variant(fstCellColIdx))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; Dispatch secCell = Dispatch.call(table, &quot;Cell&quot;,<br />&nbsp;&nbsp;&nbsp; new Variant(secCellRowIdx), new Variant(secCellColIdx))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; Dispatch.call(fstCell, &quot;Merge&quot;, secCell);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在指定的单元格里填写数据<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; * @param cellRowIdx<br />&nbsp; * @param cellColIdx<br />&nbsp; * @param txt<br />&nbsp; */<br />&nbsp;public void putTxtToCell(int tableIndex, int cellRowIdx, int cellColIdx,<br />&nbsp;&nbsp; String txt) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; Dispatch cell = Dispatch.call(table, &quot;Cell&quot;, new Variant(cellRowIdx),<br />&nbsp;&nbsp;&nbsp; new Variant(cellColIdx)).toDispatch();<br />&nbsp; Dispatch.call(cell, &quot;Select&quot;);<br />&nbsp; Dispatch.put(selection, &quot;Text&quot;, txt);<br />&nbsp;}<br />&nbsp;/**<br />&nbsp; * 在当前文档拷贝剪贴板数据<br />&nbsp; * @param pos<br />&nbsp; */<br />&nbsp;&nbsp;&nbsp; public void pasteExcelSheet(String pos){<br />&nbsp;&nbsp;&nbsp;&nbsp; moveStart();<br />&nbsp;&nbsp;&nbsp;&nbsp; if (this.find(pos)) {<br />&nbsp;&nbsp; Dispatch textRange = Dispatch.get(selection, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch.call(textRange, &quot;Paste&quot;);<br />&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;/**<br />&nbsp; * 在当前文档指定的位置拷贝表格<br />&nbsp; * <br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 当前文档指定的位置<br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 被拷贝的表格在word文档中所处的位置<br />&nbsp; */<br />&nbsp;public void copyTable(String pos, int tableIndex) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; Dispatch range = Dispatch.get(table, &quot;Range&quot;).toDispatch();<br />&nbsp; Dispatch.call(range, &quot;Copy&quot;);<br />&nbsp; if (this.find(pos)) {<br />&nbsp;&nbsp; Dispatch textRange = Dispatch.get(selection, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch.call(textRange, &quot;Paste&quot;);<br />&nbsp; }<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在当前文档指定的位置拷贝来自另一个文档中的表格<br />&nbsp; * <br />&nbsp; * @param anotherDocPath<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 另一个文档的磁盘路径<br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 被拷贝的表格在另一格文档中的位置<br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 当前文档指定的位置<br />&nbsp; */<br />&nbsp;public void copyTableFromAnotherDoc(String anotherDocPath, int tableIndex,<br />&nbsp;&nbsp; String pos) {<br />&nbsp; Dispatch doc2 = null;<br />&nbsp; try {<br />&nbsp;&nbsp; doc2 = Dispatch.call(documents, &quot;Open&quot;, anotherDocPath)<br />&nbsp;&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp;&nbsp; // 所有表格<br />&nbsp;&nbsp; Dispatch tables = Dispatch.get(doc2, &quot;Tables&quot;).toDispatch();<br />&nbsp;&nbsp; // 要填充的表格<br />&nbsp;&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;,<br />&nbsp;&nbsp;&nbsp;&nbsp; new Variant(tableIndex)).toDispatch();<br />&nbsp;&nbsp; Dispatch range = Dispatch.get(table, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch.call(range, &quot;Copy&quot;);<br />&nbsp;&nbsp; if (this.find(pos)) {<br />&nbsp;&nbsp;&nbsp; Dispatch textRange = Dispatch.get(selection, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp; Dispatch.call(textRange, &quot;Paste&quot;);<br />&nbsp;&nbsp; }<br />&nbsp; } catch (Exception e) {<br />&nbsp;&nbsp; e.printStackTrace();<br />&nbsp; } finally {<br />&nbsp;&nbsp; if (doc2 != null) {<br />&nbsp;&nbsp;&nbsp; Dispatch.call(doc2, &quot;Close&quot;, new Variant(saveOnExit));<br />&nbsp;&nbsp;&nbsp; doc2 = null;<br />&nbsp;&nbsp; }<br />&nbsp; }<br />&nbsp;}<br />&nbsp;/**<br />&nbsp; * 在当前文档指定的位置拷贝来自另一个文档中的图片<br />&nbsp; * @param anotherDocPath 另一个文档的磁盘路径<br />&nbsp; * @param shapeIndex 被拷贝的图片在另一格文档中的位置<br />&nbsp; * @param pos 当前文档指定的位置<br />&nbsp; */<br />&nbsp;&nbsp;&nbsp; public void copyImageFromAnotherDoc(String anotherDocPath,int shapeIndex,String pos){<br />&nbsp;&nbsp;&nbsp;&nbsp; Dispatch doc2 = null;<br />&nbsp; try {<br />&nbsp;&nbsp; doc2 = Dispatch.call(documents, &quot;Open&quot;, anotherDocPath)<br />&nbsp;&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp;&nbsp; Dispatch shapes = Dispatch.get(doc2, &quot;InLineShapes&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch shape = Dispatch.call(shapes, &quot;Item&quot;, new Variant(shapeIndex)).toDispatch();<br />&nbsp;&nbsp; Dispatch imageRange = Dispatch.get(shape, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch.call(imageRange, &quot;Copy&quot;);<br />&nbsp;&nbsp; if (this.find(pos)) {<br />&nbsp;&nbsp;&nbsp; Dispatch textRange = Dispatch.get(selection, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp; Dispatch.call(textRange, &quot;Paste&quot;);<br />&nbsp;&nbsp; }<br />&nbsp; } catch (Exception e) {<br />&nbsp;&nbsp; e.printStackTrace();<br />&nbsp; } finally {<br />&nbsp;&nbsp; if (doc2 != null) {<br />&nbsp;&nbsp;&nbsp; Dispatch.call(doc2, &quot;Close&quot;, new Variant(saveOnExit));<br />&nbsp;&nbsp;&nbsp; doc2 = null;<br />&nbsp;&nbsp; }<br />&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;/**<br />&nbsp; * 创建表格<br />&nbsp; * <br />&nbsp; * @param pos<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 位置<br />&nbsp; * @param cols<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 列数<br />&nbsp; * @param rows<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 行数<br />&nbsp; */<br />&nbsp;public void createTable(String pos, int numCols, int numRows) {<br />&nbsp; if (find(pos)) {<br />&nbsp;&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch range = Dispatch.get(selection, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp; Dispatch newTable = Dispatch.call(tables, &quot;Add&quot;, range,<br />&nbsp;&nbsp;&nbsp;&nbsp; new Variant(numRows), new Variant(numCols)).toDispatch();<br />&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveRight&quot;);<br />&nbsp; }else{<br />&nbsp;&nbsp;&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp; Dispatch range = Dispatch.get(selection, &quot;Range&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp; Dispatch newTable = Dispatch.call(tables, &quot;Add&quot;, range,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; new Variant(numRows), new Variant(numCols)).toDispatch();<br />&nbsp;&nbsp;&nbsp; Dispatch.call(selection, &quot;MoveRight&quot;);<br />&nbsp; }<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在指定行前面增加行<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文件中的第N张表(从1开始)<br />&nbsp; * @param rowIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 指定行的序号(从1开始)<br />&nbsp; */<br />&nbsp;public void addTableRow(int tableIndex, int rowIndex) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch rows = Dispatch.get(table, &quot;Rows&quot;).toDispatch();<br />&nbsp; Dispatch row = Dispatch.call(rows, &quot;Item&quot;, new Variant(rowIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; Dispatch.call(rows, &quot;Add&quot;, new Variant(row));<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在第1行前增加一行<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; */<br />&nbsp;public void addFirstTableRow(int tableIndex) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch rows = Dispatch.get(table, &quot;Rows&quot;).toDispatch();<br />&nbsp; Dispatch row = Dispatch.get(rows, &quot;First&quot;).toDispatch();<br />&nbsp; Dispatch.call(rows, &quot;Add&quot;, new Variant(row));<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在最后1行前增加一行<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; */<br />&nbsp;public void addLastTableRow(int tableIndex) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch rows = Dispatch.get(table, &quot;Rows&quot;).toDispatch();<br />&nbsp; Dispatch row = Dispatch.get(rows, &quot;Last&quot;).toDispatch();<br />&nbsp; Dispatch.call(rows, &quot;Add&quot;, new Variant(row));<br />&nbsp;} <br />&nbsp;/**<br />&nbsp; * 增加一行<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; */<br />&nbsp;public void addRow(int tableIndex) {<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch rows = Dispatch.get(table, &quot;Rows&quot;).toDispatch();<br />&nbsp; Dispatch.call(rows, &quot;Add&quot;);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 增加一列<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; */<br />&nbsp;public void addCol(int tableIndex) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch cols = Dispatch.get(table, &quot;Columns&quot;).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;Add&quot;).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;AutoFit&quot;);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在指定列前面增加表格的列<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; * @param colIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 制定列的序号 (从1开始)<br />&nbsp; */<br />&nbsp;public void addTableCol(int tableIndex, int colIndex) {<br />&nbsp; // 所有表格<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch cols = Dispatch.get(table, &quot;Columns&quot;).toDispatch();<br />&nbsp; System.out.println(Dispatch.get(cols, &quot;Count&quot;));<br />&nbsp; Dispatch col = Dispatch.call(cols, &quot;Item&quot;, new Variant(colIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // Dispatch col = Dispatch.get(cols, &quot;First&quot;).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;Add&quot;, col).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;AutoFit&quot;);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在第1列前增加一列<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; */<br />&nbsp;public void addFirstTableCol(int tableIndex) {<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch cols = Dispatch.get(table, &quot;Columns&quot;).toDispatch();<br />&nbsp; Dispatch col = Dispatch.get(cols, &quot;First&quot;).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;Add&quot;, col).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;AutoFit&quot;);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 在最后一列前增加一列<br />&nbsp; * <br />&nbsp; * @param tableIndex<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; word文档中的第N张表(从1开始)<br />&nbsp; */<br />&nbsp;public void addLastTableCol(int tableIndex) {<br />&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp; // 要填充的表格<br />&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(tableIndex))<br />&nbsp;&nbsp;&nbsp; .toDispatch();<br />&nbsp; // 表格的所有行<br />&nbsp; Dispatch cols = Dispatch.get(table, &quot;Columns&quot;).toDispatch();<br />&nbsp; Dispatch col = Dispatch.get(cols, &quot;Last&quot;).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;Add&quot;, col).toDispatch();<br />&nbsp; Dispatch.call(cols, &quot;AutoFit&quot;);<br />&nbsp;}<br />&nbsp;/**<br />&nbsp; * 自动调整表格<br />&nbsp; *<br />&nbsp; */<br />&nbsp;&nbsp;&nbsp; public void autoFitTable(){<br />&nbsp;&nbsp;&nbsp;&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp;&nbsp; int count = Dispatch.get(tables, &quot;Count&quot;).toInt();<br />&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0;i&lt;count;i++){<br />&nbsp;&nbsp;&nbsp; &nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(i+1))<br />&nbsp;&nbsp; .toDispatch();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dispatch cols = Dispatch.get(table, &quot;Columns&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dispatch.call(cols, &quot;AutoFit&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;&nbsp;&nbsp; /**<br />&nbsp;&nbsp;&nbsp;&nbsp; * 调用word里的宏以调整表格的宽度,其中宏保存在document下<br />&nbsp;&nbsp;&nbsp;&nbsp; *<br />&nbsp;&nbsp;&nbsp;&nbsp; */<br />&nbsp;&nbsp;&nbsp; public void callWordMacro(){<br />&nbsp;&nbsp;&nbsp;&nbsp; Dispatch tables = Dispatch.get(doc, &quot;Tables&quot;).toDispatch();<br />&nbsp;&nbsp;&nbsp;&nbsp; int count = Dispatch.get(tables, &quot;Count&quot;).toInt();<br />&nbsp;&nbsp;&nbsp;&nbsp; Variant vMacroName = new Variant(&quot;Normal.NewMacros.tableFit&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp; Variant vParam = new Variant(&quot;param1&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp; Variant para[]=new Variant[]{vMacroName};<br />&nbsp;&nbsp;&nbsp;&nbsp; for(int i=0;i&lt;count;i++){&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dispatch table = Dispatch.call(tables, &quot;Item&quot;, new Variant(i+1))<br />&nbsp;&nbsp; .toDispatch();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dispatch.call(table, &quot;Select&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dispatch.call(word,&quot;Run&quot;,&quot;tableFitContent&quot;);<br />&nbsp;&nbsp;&nbsp;&nbsp; } <br />&nbsp;&nbsp;&nbsp; }<br />&nbsp;/**<br />&nbsp; * 设置当前选定内容的字体<br />&nbsp; * <br />&nbsp; * @param boldSize<br />&nbsp; * @param italicSize<br />&nbsp; * @param underLineSize<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 下划线<br />&nbsp; * @param colorSize<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 字体颜色<br />&nbsp; * @param size<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 字体大小<br />&nbsp; * @param name<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 字体名称<br />&nbsp; */<br />&nbsp;public void setFont(boolean bold, boolean italic, boolean underLine,<br />&nbsp;&nbsp; String colorSize, String size, String name) {<br />&nbsp; Dispatch font = Dispatch.get(selection, &quot;Font&quot;).toDispatch();<br />&nbsp; Dispatch.put(font, &quot;Name&quot;, new Variant(name));<br />&nbsp; Dispatch.put(font, &quot;Bold&quot;, new Variant(bold));<br />&nbsp; Dispatch.put(font, &quot;Italic&quot;, new Variant(italic));<br />&nbsp; Dispatch.put(font, &quot;Underline&quot;, new Variant(underLine));<br />&nbsp; Dispatch.put(font, &quot;Color&quot;, colorSize);<br />&nbsp; Dispatch.put(font, &quot;Size&quot;, size);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 文件保存或另存为<br />&nbsp; * <br />&nbsp; * @param savePath<br />&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 保存或另存为路径<br />&nbsp; */<br />&nbsp;public void save(String savePath) {<br />&nbsp; Dispatch.call(Dispatch.call(word, &quot;WordBasic&quot;).getDispatch(),<br />&nbsp;&nbsp;&nbsp; &quot;FileSaveAs&quot;, savePath);<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 关闭文档<br />&nbsp; *@param val 0不保存修改 -1 保存修改 -2 提示是否保存修改<br />&nbsp; */<br />&nbsp;public void closeDocument(int val) {<br />&nbsp;&nbsp;Dispatch.call(doc, &quot;Close&quot;, new Variant(val));<br />&nbsp;&nbsp;doc = null;<br />&nbsp;}<br />&nbsp;/**<br />&nbsp; * 关闭当前word文档<br />&nbsp; * <br />&nbsp; */<br />&nbsp;public void closeDocument() {<br />&nbsp; if (doc != null) {<br />&nbsp;&nbsp; Dispatch.call(doc, &quot;Save&quot;);<br />&nbsp;&nbsp; Dispatch.call(doc, &quot;Close&quot;, new Variant(saveOnExit));<br />&nbsp;&nbsp; doc = null;<br />&nbsp; }<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 关闭全部应用<br />&nbsp; * <br />&nbsp; */<br />&nbsp;public void close() {<br />&nbsp; //closeDocument();<br />&nbsp; if (word != null) {<br />&nbsp;&nbsp; Dispatch.call(word, &quot;Quit&quot;);<br />&nbsp;&nbsp; word = null;<br />&nbsp; }<br />&nbsp; selection = null;<br />&nbsp; documents = null;<br />&nbsp;} </p>
<p>&nbsp;/**<br />&nbsp; * 打印当前word文档<br />&nbsp; * <br />&nbsp; */<br />&nbsp;public void printFile() {<br />&nbsp; if (doc != null) {<br />&nbsp;&nbsp; Dispatch.call(doc, &quot;PrintOut&quot;);<br />&nbsp; }<br />&nbsp;}<br />&nbsp;public static void main(String args[]) {<br />&nbsp; WordBean msWordManager = new WordBean();<br />&nbsp; try {<br />&nbsp; /*<br />&nbsp;&nbsp; 创建<br />&nbsp;&nbsp;&nbsp; msWordManager.createNewDocument(); <br />&nbsp;&nbsp; msWordManager.createTable(&quot;&quot;, 5, 5);<br />&nbsp;&nbsp; msWordManager.mergeCell(1, 1, 1, 1, 5);<br />&nbsp;&nbsp; msWordManager.mergeCell(1, 2, 1, 2, 5);<br />&nbsp;&nbsp; msWordManager.mergeCell(1, 3, 1, 3, 5);<br />&nbsp;&nbsp; msWordManager.putTxtToCell(1,1,1,&quot;主题&quot;);<br />&nbsp;&nbsp; msWordManager.putTxtToCell(1,2,1,&quot;时间&quot;);<br />&nbsp;&nbsp; msWordManager.putTxtToCell(1,3,1,&quot;人员&quot;);<br />&nbsp;&nbsp; msWordManager.putTxtToCell(1,4,2,&quot;说话了&quot;);<br />&nbsp;&nbsp; msWordManager.save(&quot;c:\\asdf1.doc&quot;);*/<br />&nbsp;&nbsp; msWordManager.openDocument(&quot;c:\\asdf1.doc&quot;);<br />&nbsp;&nbsp; msWordManager.addRow(1);<br />&nbsp;&nbsp; msWordManager.putTxtToCell(1, 4, 1, &quot;gaga&quot;);<br />&nbsp; } catch (Exception e) {<br />&nbsp;&nbsp; e.printStackTrace();<br />&nbsp; }finally{<br />&nbsp;&nbsp; msWordManager.close();<br />&nbsp; }<br />&nbsp;} </p>
<p>}</p>
        <div class="clear"></div>
      </div>
      <div class="item-info">
      <a onmousedown="CA.q('blog_entryview_share_bottom');" href="javascript:void(0);" entryTitle="java jacob操作word文档" data-shareType="31" data-title="#{@entryTitle}" data-url="http://10602299.blog.sohu.com/65310574.html" data-abstracts="#{#main-content@innerText<51}" data-ext="{v:'1',xpt:'#{$_xpt}'}" onclick="shareIt(this)"><img align="absmiddle" src="http://js2.pp.sohu.com.cn/ppp/images/icons/ico_share2.gif" alt="分享" title="分享" /> 分享</a>&nbsp;|&nbsp;
	  	评论&nbsp;(<span>10</span>)&nbsp;|&nbsp;
		阅读&nbsp;(<span id="itemReadCount_65310574" class="itemReadCount">?</span>) &nbsp;|&nbsp;
		<a href="#" onclick="Element.toggle('folder0_f'); return false;">固定链接</a>&nbsp;|&nbsp;
        
        类别&nbsp;(<a href="http://10602299.blog.sohu.com/entry/5148771/">java</a>)&nbsp;|&nbsp;
        
        发表于 10:34 
		</div>
      
    </div>
    <div id="folder0_f" style="display:none;" class="item-infoBox"><span class="item-infoBoxTit"><strong>提示：</strong>“固定链接”为您显示此篇文章的固定不变链接，如果您有还有疑问<a href="/help.html">请点击帮助</a></span><br />
      链接地址：<a target="_blank" href="http://10602299.blog.sohu.com/65310574.html">http://10602299.blog.sohu.com/65310574.html</a> <a href="javascript:var url=window.clipboardData.setData('text','http://10602299.blog.sohu.com/65310574.html');alert('地址已保存到剪切板。');">复制此地址</a><br />
    </div>
  </div>
  <div id="tagEntryList" style="display:none;"> </div>
  
  <div id="entrycommentlist"> <a name="comment"></a>
    <div id="messageWrapper"></div>
    <div class="item-title">
      <h3>评论&nbsp;&nbsp;&nbsp;<img align="absmiddle" class="icon" src="http://js2.pp.sohu.com.cn/ppp/images/icons/ico_question.gif"/>&nbsp;&nbsp;<a href=" http://admin.blog.sohu.com/85634919.html" target=”_blank” style="font-weight: normal;"  onmousedown="CA.a('entry_commemt_first');">想第一时间抢沙发么？</a></h3>
      <div class="clear"></div>
    </div>
    <div style="border: 2px solid #ccc; margin: 5px 0; padding: 10px 10px 10px 30px;color:#666; background-color: #FFFFE1; background-image: url(http://js.pp.sohu.com/ppp/images/icons/ico_info.gif); background-position: 7px 10px; background-repeat: no-repeat;">搜狐博客温馨提示：警惕博客留言诈骗， 搜狐博客管理员的正确地址为http://admin.blog.sohu.com， 其他都是冒牌。搜狐博客官方不会要求参加活动的各位博友缴纳任何的手续费用。请勿轻信留言、评论中的中奖信息，更不要拨打陌生电话及向陌生帐户汇款，谨防受骗！识别更多网络骗术，请 <a style="color:#104D6C;" href="http://admin.blog.sohu.com/94492353.html" target="_blank">点击查看详情</a>。</div>
    
    <div id="commentlist">
      <div style="line-height:100px;">正在读取评论信息...</div>
    </div>
    <div class="item-info">
      <div id="pageText"></div>
    </div>
    
  </div>
  <div id="tipBoxDiv"></div>
  <script type="text/javascript">
var entryId = '65310574';


var pageTextContainer = $('pageText');
var curPage = 1;
var itemPerPage = 20;
var startPage = 1;
var totalCount = 10;
var chagePageAction = 'chagePage';
var jumpAnchor = false;
var noCache = (location.href.indexOf('?') > 0);
chagePage();

Entries.insertItemOpr('view');
Entries.insertItemReadCount('view');
</script>
  <a name="commenterror"></a>
  <div id="errormsgWrapper"></div>
  <div>
    
    

<a name="commentbox" id="commentbox"></a>
<div class="info-content" id="commentForm">
  <form name="commentForm" method="post" action="/page/comment.do" onsubmit="return checkCForm()">
    <input type="hidden" name="entryId" value="65310574" />
    <input type="hidden" name="parentId" id="parentId"/>
    <table width="100%" border="0" cellspacing="2" cellpadding="0">
	  <tr id="aNotice">
	  	<td colspan="2" style="padding:10px 0;">您还未登录，只能匿名发表评论。或者您可以 <a href="http://blog.sohu.com/login/logon.do">登录</a> 后发表。</td>
	  </tr>
      <tr id="aNickname">
        <td></td>
        <td><input type="hidden" name="authorName" id="authorName" class="text" value="" size="30" /> <!-- span title="此项必须填写" style="cursor:help">*</span --></td>
      </tr>
	  <!-- for olympic -->
	  <tbody style="display:none">
      <tr id="aEmail">
        <td><label for="authorEmail">邮　　箱:</label></td>
        <td><input type="text" name="authorEmail" id="authorEmail" class="text" value="" size="30" /></td>
      </tr>
      <tr id="aSite">
        <td><label for="authorSite">网站链接:</label></td>
        <td><input type="text" name="authorSite" id="authorSite" class="text" value="" size="30" /></td>
      </tr>
      <tr id="aRemember">
        <td>&nbsp;</td>
        <td><label for="rememberme">
          <input type="checkbox" name="rememberme" id="rememberme" />
          记住我，下次匿名回复时不用重新输入个人信息</label></td>
      </tr>
	  </tbody>
	  <tr>
	  	<td>&nbsp;</td>
		<td height="30" valign="bottom">
		<!--<a href="http://www.sogou.com/pinyin/redirect.php?pid=27021101" target="_blank" style="margin-left: 10px;">*搜狗拼音输入法，中文处理专家&gt;&gt;</a>-->
		<!--  a href="http://campus.chinaren.com/s2008/shurufa/index.shtml" target="_blank" style="margin-left: 10px;">*中国人爱国心，搜狗输入法爱国主题皮肤下载&gt;&gt;</a>  -->
		<a target="_blank" href="http://zt.blog.sohu.com/s2009/dream-8/" onmousedown="CA.q('ad_diary_index_underTitleLink_jianpai')">烧饼帅哥：拒绝娱乐圈 只想摆好烧饼摊儿</a>

		</td>
	  </tr>
      <tr>
        <td valign="top" width="10%" ><label for="commentContent">评论内容:</label></td>
        <td><textarea id="commentContent" name="commentContent" class="text" style="width:70%;height:140px;float:left;" onfocus="showC_code()"></textarea><div class="comment_bigbutton" style="float:left;margin:2px 0 0 10px;width:160px;height:140px;"><script src="http://www.sohu.com/sohuflash_1.js" type=text/javascript></script>
<div id="a98c81fc44d5b58c5a32ee2417709277"></div>
<script type="text/javascript">
var sohuFlash2 = new sohuFlash("http://images.sohu.com/bill/s2009/jingwang/mengniu/226-10/1601400710.swf","_a98c81fc44d5b58c5a32ee2417709277","160","140","7");
sohuFlash2.addParam("quality", "high");
sohuFlash2.addParam("wmode", "opaque");
sohuFlash2.addVariable("clickthru",escape("http://sohu.ad-plus.cn/event.ng/Type=click&FlightID=200906&TargetID=sohu&Values=a98c81fc,44d5b58c,5a32ee24,17709277&AdID=32462&ff="+document.location.href));
sohuFlash2.write("a98c81fc44d5b58c5a32ee2417709277");
if(typeof(document.pv)=='undefined') document.pv = new Array();var _a=new Image();
_a.src='http://alpha.brand.sogou.com/brand_pv?md5=a98c81fc44d5b58c5a32ee2417709277';
 document.pv.push(_a);
</script>
</div></td>
      </tr>
	  <tr>
        <td valign="top">表　　情:</td>
        <td>
<script type="text/javascript">
document.write('<scr'+'ipt type="text/javascript" src="'+ HMP + 'emote.js"></scr'+'ipt>');
</script>
<div id="emotionBox">
加载中...
</div>
<script type="text/javascript">
var commentContentEl = null;
function addEmote(ubb) {
	if (!commentContentEl) commentContentEl = $('commentContent');
	commentContentEl.value += ' ' + ubb; 
	commentContentEl.focus();
}
Emote.init({parent: 'emotionBox', callback: addEmote, stat: 'reply'});
</script>
        </td>
	  </tr>
      <tr style="display:none;">
        <td class="redfont">回复通知:</td>
        <td><input type="checkbox" id="notifyEle" name="notify" checked="checked" value="true" />同时用小纸条通知对方该回复<span id="notifyLoginTip"></span></td>
      </tr>
      <tr>
        <td class="redfont" id="c_codeTextBox"></td>
        <td id="c_codeInputBox"></td>
      </tr>
      <tr>
        <td>&nbsp;</td>
        <td>
        <input type="hidden" name="m" value="save" />
    	<input type="submit" id="commentSubmit" name="submit" value="发 表" class="button-submit" />
		 </td>
      </tr>
    </table>
  </form>
</div>

<script type="text/javascript">
var commentPermission = '0';
setCPShow();
// for olympic
$('authorSite').value = 'http://blog.sohu.com';
if($('commentContent')){
	if (haveValue(getCookie('cc'))){
		$('commentContent').value = unescape(getCookie('cc'));
		setCookie('cc', '', '', '/', 'blog.sohu.com');
	}
}

initCForm();

//if($('emotionBox')){
//        $('emotionBox').innerHTML = Emotion.getEmotionIcons();
//        setCmtEmoEvent();
//}
</script>
    
  </div>
  <div class="item-bottom"></div>
</div>
<div class="content-bottom"></div>
<script type="text/javascript">
// load correlative entry
var tags = '';

tags = 'java jacob word';

// getEntries: function(element, etags, inNum, outNum, by(system/person))
//CorEntry.getEntries($('tagEntryList'), tags, 1, 10, 'person');
// load correlative entry end
</script>

                </div>
            </div>
			<div class="clear"></div>
		</div>
		</div>
		
<div id="footer">
  <div id="innerFooter">
	<div id="powered"><a href="http://blog.sohu.com" target="_blank" title="搜狐博客提供技术支持"><img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/logo_powered.gif" alt="搜狐博客提供技术支持" /></a></div>
	<div id="contact"><a href="http://q.sohu.com/forum/21" target="_blank">客服留言板</a> | <a href="http://sohucallcenter.blog.sohu.com/" target="_blank">客服博客</a> | <a href="mailto:sohublog@sohu-inc.com">客服邮箱</a> | 24小时客服热线:010-58511234(人工8:00-24:00) | <a href="http://me.sohu.com/online_service.jsp?pid=5" target="_blank">在线客服<img src="http://js1.pp.sohu.com.cn/ppp/blog/styles_ppp/images/ico_onlineservice.gif" alt="在线客服" /></a>
<script type="text/javascript">
function writeReport() {
	if (typeof entryId == 'undefined' || !entryId) return;
	var url = 'http://act.blog.sohu.com/plus/impeach.jsp?rp='+escape(location.href)+'&p='+escape(getP());
	var str = '';
	str += ' | <a href="'+ url +'" target="_blank">举报不良信息</a>';
	document.write(str);
}
writeReport();
</script>
	</div>
	<div id="copyright">Copyright &copy; 2009 Sohu.com Inc. All rights reserved. 搜狐公司 版权所有 </div>
  </div>
</div>
<script type="text/javascript">document.write('<scr'+'ipt type="text/javascript" src="http://js.sohu.com/pv.js" type="text/javascript"></scr'+'ipt>');</script>


<!-- sohu im -->
<script type="text/javascript">
SohuIM.setCandleMenParam();
document.write('<scr'+'ipt type="text/javascript" src="http://images.sohu.com/cs/sohuim/xiaozt/version/2.0/js/loader.sohu.js"></scr'+'ipt>');
</script>
<!-- sohu im end -->
<script language="javascript">
var  _wratingId = '860010-0601020100';
if(_wratingId !=null){
document.write('<scr'+'ipt type="text/javascript" src="http://js.sohu.com/a1.js"></scr'+'ipt>');
}
</script>
<script language="javascript">
if(_wratingId !=null){
document.write('<scr'+'ipt type="text/javascript">');
document.write('var vjAcc="'+_wratingId+'";');
document.write('var wrUrl="http://sohu.wrating.com/";');
document.write('try{vjTrack();}catch(e){}');
document.write('</scr'+'ipt>');
}
</script>
<script type="text/ecmascript">
function checkLogonUserCount() {
	if (getCookie('lastdomain') && getCookie('lastdomain') != '') {
		var _lastdomain = getCookie('lastdomain').split('|')[1];
		if (_lastdomain) {
			var _url = 'http://bgt.blog.sohu.com/blogping.gif?sohupp='+ _lastdomain;
			_url += '&refer='+ escape(document.referrer);
			_url += '&c='+ timeStamp();
			if (isLogin()) {
				_url += '&logon='+ getXP();
			}
			document.write('<img src="'+ _url +'" />');
		}
	}
}
checkLogonUserCount();
</script>

	</div>
</div>
<img src="http://js.pp.sohu.com/ppp/blog/styles/images/spacer.gif" style="display:none" id="spacerImg" />
<script type="text/javascript">
Starter.start();
</script>

<script type="text/javascript">
document.write('<scr'+'ipt type="text/javascript" src="'+SP+'counter.js"></scr'+'ipt>');
</script>


<script type="text/javascript">
if($('errormsgWrapper')){
	var err = Info.readInfo(true);
	if(err){
		var str = '<div id="errormsg" style="background-color: #ffffe1; border: 2px solid #ccc; color: red; padding: 10px; padding-left: 30px; margin: 20px; background-image:url(http://js.pp.sohu.com/ppp/blog/styles/images/ico_error.gif); background-position: 7px 10px; background-repeat: no-repeat;">';
		str += err;
		str += '</div>';
		$('errormsgWrapper').innerHTML = str;
		try{flashErr('errormsg');}catch(e){}
	}
}
if($('messageWrapper')){
	var msg = Info.readInfo(false);
	if(msg){
		var str = '<div id="message" style="background-color: #ffffe1; color: 6D6D6D; border: 2px solid #ccc; padding: 10px; padding-left: 30px; margin: 20px; background-image:url(http://js.pp.sohu.com/ppp/blog/styles/images/ico_ok.gif); background-position: 7px 10px; background-repeat: no-repeat;">';
		str += msg;
		str += '</div>';
		$('messageWrapper').innerHTML = str;
		try{flashMsg('message');}catch(e){}
	}
}
</script>

</body>
</html>