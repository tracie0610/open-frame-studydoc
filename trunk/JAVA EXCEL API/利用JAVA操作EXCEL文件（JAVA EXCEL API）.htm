<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>利用JAVA操作EXCEL文件（JAVA EXCEL API）</title>
<meta name="keywords" content="利用JAVA操作EXCEL文件（JAVA EXCEL API）,无">
<meta name="generator" content="CipCMS! 1.0.0 with Templates 1.0.0">
<meta name="Author" content="利用JAVA操作EXCEL文件（JAVA EXCEL API）,无,My FAQ">
<meta name="description" content="利用JAVA操作EXCEL文件（JAVA EXCEL API）,无"><link rel="stylesheet" href="/images/style.css">
</head>
<body bgcolor="#F4F4E8" topmargin="5">
<table width="760" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td width="186">My FAQ,最新最全的IT技术FAQ</td>
    <td width="574" valign="bottom"><table width="574" border="0" cellspacing="0" cellpadding="0">
        <tr>
          <td width="29"><img src="/images/index/bar_bg_l.gif" width="29" height="24"></td>
          <td align="center" background="/images/index/bar_bg.gif">
			  <a href="/new100.html" class="bar">最新100篇</a> 
            | <a href="/commend100.html" class="bar">推荐100篇</a>
			| <a href="/subject/index.html" class="bar">专题100篇</a> 
            | <a href="/paihang.html" class="bar">排行榜</a> 
			| <a href="/Search.html" class="bar"><font color=green><b>搜索</b></font></a> 
            | <a href="http://online.myfaq.com.cn" class="bar">在线API文档</a> 
            </td>
          <td width="4"><img src="/images/index/bar_bg_r.gif" width="4" height="24"></td>
        </tr>
      </table></td>
  </tr>
</table>

<table width="760" border="0" align="center" cellpadding="0" cellspacing="0" bgcolor=#8B7E66>
  <tr>
	<td width="4" height="32" align="center"class="white"><img src="/images/bar_l.gif" width="4" height="32"></td>
    <td width="756" align="center" class="white"><a href="/" class="white1">首 页</a>&nbsp|&nbsp<a href=/Dev/index.html class=white1 >程序开发</a>&nbsp|&nbsp<a href=/System/index.html class=white1 >操作系统</a>&nbsp|&nbsp<a href=/Soft/index.html class=white1 >软件应用</a>&nbsp|&nbsp<a href=/Design/index.html class=white1 >图形图象</a>&nbsp|&nbsp<a href=/Net/index.html class=white1 >网络应用</a>&nbsp|&nbsp<a href=/Good/index.html class=white1 >精文荟萃</a>&nbsp|&nbsp<a href=/RenZ/index.html class=white1 >教育认证</a>&nbsp|&nbsp<a href=/Temps/index.html class=white1 >未整理篇</a>&nbsp|&nbsp<a href=http://bbs.myfaq.com.cn class=white1 >技术讨论</a>
	</td>
  </tr>
</table>
<table width="760" border="0" align="center" cellpadding="0" cellspacing="0">
  <tr>
    <td height="1" bgcolor=white></td>
  </tr>
  <tr>
    <td height="4" bgcolor=#8B7E66 ></td>
  </tr>
</table>
<table width="760" border="0" align="center" cellpadding="0" cellspacing="0" class="border2">
  <tr>
    <td  bgcolor="#F4F4E8"><script language="javascript" src="httP://www.myfaq.com.cn/images/top760.js" ></script></td>
  </tr>
  <tr>
    <td height="4" bgcolor=#8B7E66 ></td>
  </tr>
</table>
<TABLE width="760" border="0" align="center" cellpadding="0" cellspacing="0" class="border2">

<tr><td bgcolor="#FFFFFF" height=25>&nbsp;&nbsp;当前位置： &gt; <a class="nowplace" href="/Dev/index.html">程序开发</a> &gt; <a class="nowplace" href="/Dev/Web/index.html">Web开发</a> &gt; <a class="nowplace" href="/Dev/Web/JSP/index.html">JSP</a> &gt; <a class="nowplace" href="/Dev/Web/JSP/Other/index.html">综合文章</a></td></tr>
<tr><td height=10></td></tr><TR>
	<TD align=center><b>利用JAVA操作EXCEL文件（JAVA EXCEL API）</b>
	</TD>
</TR>
<tr><td  height=1 bgcolor=#D6D6D6></td></tr>
<tr ><td height=25 bgcolor=#F1F1F1 align=center>
	作者:<font color="0E3E92">未知</font>
	时间:<font color="0E3E92">2005-08-10 21:48</font>
	出处:<font color="0E3E92">Java频道</font>
	责编:<font color="0E3E92">My FAQ</font>
</td></tr><tr><td  height=1 bgcolor=#D6D6D6></td></tr>
<tr><td bgcolor="#FFFFFF" height=25>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;摘要：利用JAVA操作EXCEL文件（JAVA EXCEL API）</td></tr>
<tr><td  height=1 bgcolor=#D6D6D6></td></tr>

</TABLE>

<table width="760" border="0" align="center" cellpadding="0" cellspacing="0" class="border2" bgcolor="#FFFFFF">
<tr><td height=25 align=center>
	<TABLE width=95% >
	<TR>
		<TD><table border="0" align="left">
            <tr>
              <td><script language="javascript" src="httP://www.myfaq.com.cn/images/ad.js" charset="utf-8"></script></td>
            </tr>
          </table><P>参考文章：<A href="http://www-128.ibm.com/developerworks/cn/java/l-javaExcel/index.html">http://www-128.ibm.com/developerworks/cn/java/l-javaExcel/index.html</A><BR>作了一些相应的扩充(读取图片等)</P>
<P><A name=1><SPAN class=atitle2>JAVA EXCEL API简介</SPAN></A><BR></P>
<P>Java Excel是一开放源码项目，通过它Java开发人员可以读取Excel文件的内容、创建新的Excel文件、更新已经存在的Excel文件。使用该API非Windows操作系统也可以通过纯Java应用来处理Excel数据表。因为是使用Java编写的，所以我们在Web应用中可以通过JSP、Servlet来调用API实现对Excel数据表的访问。<BR><BR>提供以下功能：</P>
<UL xmlns:dw="http://www.ibm.com/developerworks/" xmlns:h="http://www.w3.org/1999/xhtml" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
<LI>从Excel 95、97、2000等格式的文件中读取数据； 
<LI>读取Excel公式（可以读取Excel 97以后的公式）； 
<LI>生成Excel数据表（格式为Excel 97）； 
<LI>支持字体、数字、日期的格式化； 
<LI>支持单元格的阴影操作，以及颜色操作； 
<LI>修改已经存在的数据表； 
<LI>能够读取图表信息</LI></UL>
<P>1.<A name=2><SPAN class=atitle2>应用示例</SPAN></A>：<BR>包括从Excel读取数据,生成新的Excel，以及修改Excel<BR><FONT face="Courier New">package common.util;</FONT></P>
<P><FONT face="Courier New">import jxl.*;<BR>import jxl.format.UnderlineStyle;<BR>import jxl.write.*;<BR>import jxl.write.Number;<BR>import jxl.write.Boolean;</FONT></P>
<P><FONT face="Courier New">import java.io.*;</FONT></P>
<P><FONT face="Courier New">/**<BR>&nbsp;* Created by IntelliJ IDEA.<BR>&nbsp;* User: xl<BR>&nbsp;* Date: 2005-7-17<BR>&nbsp;* Time: 9:33:22<BR>&nbsp;* To change this template use File | Settings | File Templates.<BR>&nbsp;*/<BR>public class ExcelHandle<BR>{<BR>&nbsp;&nbsp;&nbsp; public ExcelHandle()<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; /**<BR>&nbsp;&nbsp;&nbsp;&nbsp; * 读取Excel<BR>&nbsp;&nbsp;&nbsp;&nbsp; *<BR>&nbsp;&nbsp;&nbsp;&nbsp; * @param filePath<BR>&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp;&nbsp;&nbsp; public static void readExcel(String filePath)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; InputStream is = new FileInputStream(filePath);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workbook rwb = Workbook.getWorkbook(is);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Sheet st = rwb.getSheet("0")这里有两种方法获取sheet表,1为名字，而为下标，从0开始<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sheet st = rwb.getSheet("original");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cell c00 = st.getCell(0,0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //通用的获取cell值的方式,返回字符串<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String strc00 = c00.getContents();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //获得cell具体类型值的方式<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(c00.getType() == CellType.LABEL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LabelCell labelc00 = (LabelCell)c00;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; strc00 = labelc00.getString();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //输出<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.out.println(strc00);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //关闭<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rwb.close();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(Exception e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; /**<BR>&nbsp;&nbsp;&nbsp;&nbsp; * 输出Excel<BR>&nbsp;&nbsp;&nbsp;&nbsp; *<BR>&nbsp;&nbsp;&nbsp;&nbsp; * @param os<BR>&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp;&nbsp;&nbsp; public static void writeExcel(OutputStream os)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /**<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * 只能通过API提供的工厂方法来创建Workbook，而不能使用WritableWorkbook的构造函数，<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * 因为类WritableWorkbook的构造函数为protected类型<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * method(1)直接从目标文件中读取WritableWorkbook wwb = Workbook.createWorkbook(new File(targetfile));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * method(2)如下实例所示 将WritableWorkbook直接写入到输出流</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableWorkbook wwb = Workbook.createWorkbook(os);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //创建Excel工作表 指定名称和位置<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableSheet ws = wwb.createSheet("Test Sheet 1",0);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //**************往工作表中添加数据*****************</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //1.添加Label对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label = new Label(0,0,"this is a label test");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(label);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //添加带有字型Formatting对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableFont wf = new WritableFont(WritableFont.TIMES,18,WritableFont.BOLD,true);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableCellFormat wcf = new WritableCellFormat(wf);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label labelcf = new Label(1,0,"this is a label test",wcf);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelcf);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //添加带有字体颜色的Formatting对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableFont wfc = new WritableFont(WritableFont.ARIAL,10,WritableFont.NO_BOLD,false,<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; UnderlineStyle.NO_UNDERLINE,jxl.format.Colour.RED);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableCellFormat wcfFC = new WritableCellFormat(wfc);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label labelCF = new Label(1,0,"This is a Label Cell",wcfFC);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelCF);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //2.添加Number对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Number labelN = new Number(0,1,3.1415926);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelN);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //添加带有formatting的Number对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NumberFormat nf = new NumberFormat("#.##");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableCellFormat wcfN = new WritableCellFormat(nf);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Number labelNF = new jxl.write.Number(1,1,3.1415926,wcfN);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelNF);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //3.添加Boolean对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Boolean labelB = new jxl.write.Boolean(0,2,false);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelB);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //4.添加DateTime对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jxl.write.DateTime labelDT = new jxl.write.DateTime(0,3,new java.util.Date());<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelDT);</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //添加带有formatting的DateFormat对象<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DateFormat df = new DateFormat("dd MM yyyy hh:mm:ss");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableCellFormat wcfDF = new WritableCellFormat(df);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DateTime labelDTF = new DateTime(1,3,new java.util.Date(),wcfDF);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addCell(labelDTF);<BR></FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //添加图片对象,jxl只支持png格式图片<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File image = new File("f:\\2.png");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableImage wimage = new WritableImage(0,1,2,2,image);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ws.addImage(wimage);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //写入工作表<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.write();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.close();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(Exception e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }</FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp; /**<BR>&nbsp;&nbsp;&nbsp;&nbsp; * 拷贝后,进行修改,其中file1为被copy对象，file2为修改后创建的对象<BR>&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;尽单元格原有的格式化修饰是不能去掉的，我们还是可以将新的单元格修饰加上去，<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;以使单元格的内容以不同的形式表现<BR>&nbsp;&nbsp;&nbsp;&nbsp; * @param file1<BR>&nbsp;&nbsp;&nbsp;&nbsp; * @param file2<BR>&nbsp;&nbsp;&nbsp;&nbsp; */<BR>&nbsp;&nbsp;&nbsp; public static void modifyExcel(File file1,File file2)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workbook rwb = Workbook.getWorkbook(file1);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableWorkbook wwb = Workbook.createWorkbook(file2,rwb);//copy<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableSheet ws = wwb.getSheet(0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WritableCell wc = ws.getWritableCell(0,0);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //判断单元格的类型,做出相应的转换<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(wc.getType == CellType.LABEL)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Label label = (Label)wc;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; label.setString("The value has been modified");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.write();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wwb.close();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rwb.close();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(Exception e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR></FONT></P>
<P><FONT face="Courier New">&nbsp;&nbsp;&nbsp;&nbsp;//测试<BR>&nbsp;&nbsp;&nbsp;&nbsp;public static void main(String[] args)<BR>&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//读Excel<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExcelHandle.readExcel("f:/testRead.xls");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//输出Excel<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; File fileWrite = new File("f:/testWrite.xls");<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fileWrite.createNewFile();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; OutputStream os = new FileOutputStream(fileWrite);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExcelHandle.writeExcel(os);<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//修改Excel<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ExcelHandle.modifyExcel(new file(""),new File(""));<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; catch(Exception e)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }<BR>&nbsp;&nbsp;&nbsp; }<BR>}<BR><BR></FONT><FONT face="Times New Roman">2.在jsp中做相关测试，创建一个writeExcel.jsp<BR>&lt;%<BR><FONT face="Courier New">response.reset();//清除Buffer<BR>response.setContentType("application/vnd.ms-excel");<BR>File fileWrite = new File("f:/testWrite.xls");<BR>fileWrite.createNewFile();<BR>new FileOutputStream(fileWrite);<BR>ExcelHandle.writeExcel(new FileOutputStream(fileWrite));</FONT><BR>%&gt;<BR>在IE中浏览writeExcel.jsp就可以动态生成Excel文档了，其中</FONT><FONT face="Courier New">response.setContentType("application/vnd.ms-excel");语句必须要，才能确保不乱码，在jsp中输入&lt;%@page&nbsp;contentType="application/vnd.ms-excel;charset=GBK"%&gt;</FONT>不行。</P><img src ="http://www.blogjava.net/javainthinking/aggbug/7906.html" width = "1" height = "1" /></TD>
	</TR>
	</TABLE>
</td></tr><tr><td  height=1 bgcolor=#D6D6D6></td></tr>
<tr><td bgcolor="#FFFFFF" height=25 align=center><script language="JavaScript" src="/images/fav.js"></script></td></tr>
<tr><td  height=1 bgcolor=#D6D6D6></td></tr>

<tr>
	<Td colspan="9" class="ButtonList" height="22" >&nbsp;</font>
	</td>
	</tr>
<tr>
	<Td colspan="9" align=center ><iframe id="baiduframe" border="0" vspace="0" hspace="0" marginwidth="0" marginheight="0"
  framespacing="0" frameborder="0" scrolling="no" width="670" height="40"
  src="http://unstat.baidu.com/bdun.bsc?tn=czken&csid=103&rkcs=0&bgcr=FFFFFF&ftcr=000000&rk=1&bd=0&bdas=0">
</iframe>
	</td>
	</tr>
</table>

<SPAN id="friendlink"></SPAN>

<SPAN id="friendlink"></SPAN>

<SPAN id="friendlink"></SPAN>

<table width=760 border=0 class="border3" cellpadding=0 bgcolor=#ffffff  align=center cellspacing=0 >
<tr><td colspan=3  height=2></td></tr>
</table>
<table width=760 border=0  cellpadding=0 cellspacing=0 align=center>
<tr height=10><td></td></tr>
<tr height=20>
<td align=center><a href=/index.html class=gray2>首页</a> | <a href=/hezuo.html class=gray2>投资与合作</a> |  <a href="/fuwu.html" class=gray2>服务条款</a> | <a target=_blank href="/yinsi.html" class=gray2>隐私政策</a> | 
<A href="javascript:window.external.AddFavorite('http://www.myfaq.com.cn/',%20'“My FAQ,提供最新最全的电脑技术教程”&quot;/www.myfaq.com.cn')"  target=_self  class=gray2>收藏本站</A> | 
<A style="BEHAVIOR: url(#default#homepage)" 
onclick="this.style.behavior='url(#default#homepage)';this.setHomePage('http://www.myfaq.com.cn/');return(false);" 
href="http://www.myfaq.com.cn/#"  class=gray2>设为首页</A> | 
<a href="Http://bbs.myfaq.com.cn/" class=gray2>新用户注册</a>	| 
<a href="/shengming.html" class=gray2>免责声明</a>	|  
<a href="/help.html" class=gray2 target=_blank>使用帮助</a></td></tr>
<tr><td height=1 bgcolor=#666666></td></tr>
<tr height=20><td align=center>Copyright &copy;2005-2008 myfaq.com.cn  All rights reserved. www.myfaq.com.cn 版权所有</td></tr>
</table>
<SPAN ID="span_ad1"><script src="/images/default/index-760x90.js"></script></SPAN>
<SCRIPT>ad1.innerHTML=span_ad1.innerHTML;span_ad1.innerHTML="";</SCRIPT>
<SPAN ID="span_friendlink"><script src="/images/friendlink.js"></script></SPAN>
<SCRIPT>friendlink.innerHTML=span_friendlink.innerHTML;span_friendlink.innerHTML="";</SCRIPT>
<SCRIPT language="javascript" src="/images/footer.js"></SCRIPT>
